<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Epidemic Modeling | Statistical Learning of Infectious Disease Data Analytics</title>
  <meta name="description" content="The use of statistical models to understand infectious disease dynamics has a very rich history in epidemiology. This book introduces modern statistical models and state-of-the-art learning methods to analyze infectious disease data. Many of the key approaches, examples and case studies will be presented. The primary emphasis will be interpretation, inference and hands-on data analyses. This course also provides practical concepts and R computing skills to perform infectious disease data analysis and visualization." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Epidemic Modeling | Statistical Learning of Infectious Disease Data Analytics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="The use of statistical models to understand infectious disease dynamics has a very rich history in epidemiology. This book introduces modern statistical models and state-of-the-art learning methods to analyze infectious disease data. Many of the key approaches, examples and case studies will be presented. The primary emphasis will be interpretation, inference and hands-on data analyses. This course also provides practical concepts and R computing skills to perform infectious disease data analysis and visualization." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Epidemic Modeling | Statistical Learning of Infectious Disease Data Analytics" />
  
  <meta name="twitter:description" content="The use of statistical models to understand infectious disease dynamics has a very rich history in epidemiology. This book introduces modern statistical models and state-of-the-art learning methods to analyze infectious disease data. Many of the key approaches, examples and case studies will be presented. The primary emphasis will be interpretation, inference and hands-on data analyses. This course also provides practical concepts and R computing skills to perform infectious disease data analysis and visualization." />
  

<meta name="author" content="Lily Wang" />


<meta name="date" content="2021-02-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="map.html"/>
<link rel="next" href="regression.html"/>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.3.9000/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#data-sets-used-in-labs-and-exercises"><i class="fa fa-check"></i><b>1.1</b> Data Sets Used in Labs and Exercises</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>1.2</b> Acknowledgements</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#about-the-author"><i class="fa fa-check"></i><b>1.3</b> About the Author</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#aims-and-scope-of-this-book"><i class="fa fa-check"></i><b>2.1</b> Aims and Scope of This Book</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#the-structure-of-this-book"><i class="fa fa-check"></i><b>2.2</b> The Structure of This Book</a><ul>
<li class="chapter" data-level="2.2.1" data-path="intro.html"><a href="intro.html#infectious-disease-data"><i class="fa fa-check"></i><b>2.2.1</b> Infectious disease data</a></li>
<li class="chapter" data-level="2.2.2" data-path="intro.html"><a href="intro.html#basic-characteristics-of-the-infection-process"><i class="fa fa-check"></i><b>2.2.2</b> Basic characteristics of the infection process</a></li>
<li class="chapter" data-level="2.2.3" data-path="intro.html"><a href="intro.html#data-visualization"><i class="fa fa-check"></i><b>2.2.3</b> Data visualization</a></li>
<li class="chapter" data-level="2.2.4" data-path="intro.html"><a href="intro.html#modeling-and-forecasting"><i class="fa fa-check"></i><b>2.2.4</b> Modeling and Forecasting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="dplyr.html"><a href="dplyr.html"><i class="fa fa-check"></i><b>3</b> Data Wrangling with <code>dplyr</code> and <code>tidyr</code></a><ul>
<li class="chapter" data-level="3.1" data-path="dplyr.html"><a href="dplyr.html#learning-dplyr"><i class="fa fa-check"></i><b>3.1</b> Learning <code>dplyr</code></a><ul>
<li class="chapter" data-level="3.1.1" data-path="dplyr.html"><a href="dplyr.html#tibbles"><i class="fa fa-check"></i><b>3.1.1</b> Tibbles</a></li>
<li class="chapter" data-level="3.1.2" data-path="dplyr.html"><a href="dplyr.html#import-data"><i class="fa fa-check"></i><b>3.1.2</b> Import data</a></li>
<li class="chapter" data-level="3.1.3" data-path="dplyr.html"><a href="dplyr.html#common-dplyr-functions"><i class="fa fa-check"></i><b>3.1.3</b> Common <code>dplyr</code> functions</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="dplyr.html"><a href="dplyr.html#selecting-columns-and-filtering-rows"><i class="fa fa-check"></i><b>3.2</b> Selecting Columns and Filtering Rows</a><ul>
<li class="chapter" data-level="3.2.1" data-path="dplyr.html"><a href="dplyr.html#subset-variables-columns"><i class="fa fa-check"></i><b>3.2.1</b> Subset Variables (Columns)</a></li>
<li class="chapter" data-level="3.2.2" data-path="dplyr.html"><a href="dplyr.html#subset-observations-rows"><i class="fa fa-check"></i><b>3.2.2</b> Subset Observations (Rows)</a></li>
<li class="chapter" data-level="3.2.3" data-path="dplyr.html"><a href="dplyr.html#pipes"><i class="fa fa-check"></i><b>3.2.3</b> Pipes</a></li>
<li class="chapter" data-level="3.2.4" data-path="dplyr.html"><a href="dplyr.html#select-and-order-top-n-entries-by-group-if-grouped-data."><i class="fa fa-check"></i><b>3.2.4</b> Select and order top n entries (by group if grouped data).</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="dplyr.html"><a href="dplyr.html#make-new-variables-mutate"><i class="fa fa-check"></i><b>3.3</b> Make New Variables: Mutate</a></li>
<li class="chapter" data-level="3.4" data-path="dplyr.html"><a href="dplyr.html#summarize-data"><i class="fa fa-check"></i><b>3.4</b> Summarize Data</a></li>
<li class="chapter" data-level="3.5" data-path="dplyr.html"><a href="dplyr.html#combine-data-sets"><i class="fa fa-check"></i><b>3.5</b> Combine Data Sets</a><ul>
<li class="chapter" data-level="3.5.1" data-path="dplyr.html"><a href="dplyr.html#the-join-family"><i class="fa fa-check"></i><b>3.5.1</b> The join family</a></li>
<li class="chapter" data-level="3.5.2" data-path="dplyr.html"><a href="dplyr.html#toy-examples-with-joins"><i class="fa fa-check"></i><b>3.5.2</b> Toy examples with joins</a></li>
<li class="chapter" data-level="3.5.3" data-path="dplyr.html"><a href="dplyr.html#practice-with-joins-for-real-data"><i class="fa fa-check"></i><b>3.5.3</b> Practice with joins for real data</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="dplyr.html"><a href="dplyr.html#reshaping-data"><i class="fa fa-check"></i><b>3.6</b> Reshaping Data</a><ul>
<li class="chapter" data-level="3.6.1" data-path="dplyr.html"><a href="dplyr.html#from-wide-to-long"><i class="fa fa-check"></i><b>3.6.1</b> From wide to long</a></li>
<li class="chapter" data-level="3.6.2" data-path="dplyr.html"><a href="dplyr.html#from-long-to-wide"><i class="fa fa-check"></i><b>3.6.2</b> From long to wide</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="dplyr.html"><a href="dplyr.html#exercises"><i class="fa fa-check"></i><b>3.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>4</b> Data Visualization with ggplot2</a><ul>
<li class="chapter" data-level="4.1" data-path="ggplot2.html"><a href="ggplot2.html#introduction"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="ggplot2.html"><a href="ggplot2.html#types-of-variables-and-preparation"><i class="fa fa-check"></i><b>4.2</b> Types of Variables and Preparation</a><ul>
<li class="chapter" data-level="4.2.1" data-path="ggplot2.html"><a href="ggplot2.html#types-of-variables"><i class="fa fa-check"></i><b>4.2.1</b> Types of Variables</a></li>
<li class="chapter" data-level="4.2.2" data-path="ggplot2.html"><a href="ggplot2.html#rules-for-graph-designing"><i class="fa fa-check"></i><b>4.2.2</b> Rules for Graph Designing</a></li>
<li class="chapter" data-level="4.2.3" data-path="ggplot2.html"><a href="ggplot2.html#installing-packages-and-loading-data"><i class="fa fa-check"></i><b>4.2.3</b> Installing packages and loading data</a></li>
<li class="chapter" data-level="4.2.4" data-path="ggplot2.html"><a href="ggplot2.html#your-first-scatterplot"><i class="fa fa-check"></i><b>4.2.4</b> Your first scatterplot</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="ggplot2.html"><a href="ggplot2.html#position-scales-and-axes"><i class="fa fa-check"></i><b>4.3</b> Position Scales and Axes</a><ul>
<li class="chapter" data-level="4.3.1" data-path="ggplot2.html"><a href="ggplot2.html#change-the-labels-of-the-axis-using-xlab-and-ylab"><i class="fa fa-check"></i><b>4.3.1</b> Change the labels of the axis using <code>xlab()</code> and <code>ylab()</code></a></li>
<li class="chapter" data-level="4.3.2" data-path="ggplot2.html"><a href="ggplot2.html#change-the-range-of-the-axis-using-xlim-and-ylim"><i class="fa fa-check"></i><b>4.3.2</b> Change the range of the axis using <code>xlim()</code> and <code>ylim()</code></a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="ggplot2.html"><a href="ggplot2.html#color-scales-and-size-of-geom_points"><i class="fa fa-check"></i><b>4.4</b> Color Scales and Size of <code>geom_points()</code></a><ul>
<li class="chapter" data-level="4.4.1" data-path="ggplot2.html"><a href="ggplot2.html#change-the-color-of-all-points"><i class="fa fa-check"></i><b>4.4.1</b> Change the color of all points</a></li>
<li class="chapter" data-level="4.4.2" data-path="ggplot2.html"><a href="ggplot2.html#color-the-observations-by-the-value-of-a-feature"><i class="fa fa-check"></i><b>4.4.2</b> Color the observations by the value of a feature</a></li>
<li class="chapter" data-level="4.4.3" data-path="ggplot2.html"><a href="ggplot2.html#change-the-color-palette"><i class="fa fa-check"></i><b>4.4.3</b> Change the color palette</a></li>
<li class="chapter" data-level="4.4.4" data-path="ggplot2.html"><a href="ggplot2.html#change-the-size-by-the-value-of-a-feature"><i class="fa fa-check"></i><b>4.4.4</b> Change the size by the value of a feature</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="ggplot2.html"><a href="ggplot2.html#individual-geoms"><i class="fa fa-check"></i><b>4.5</b> Individual geoms</a><ul>
<li class="chapter" data-level="4.5.1" data-path="ggplot2.html"><a href="ggplot2.html#histogram"><i class="fa fa-check"></i><b>4.5.1</b> Histogram</a></li>
<li class="chapter" data-level="4.5.2" data-path="ggplot2.html"><a href="ggplot2.html#bar-chart"><i class="fa fa-check"></i><b>4.5.2</b> Bar chart</a></li>
<li class="chapter" data-level="4.5.3" data-path="ggplot2.html"><a href="ggplot2.html#default-bar-chart"><i class="fa fa-check"></i><b>4.5.3</b> Default bar chart</a></li>
<li class="chapter" data-level="4.5.4" data-path="ggplot2.html"><a href="ggplot2.html#bar-chart-with-assigned-value"><i class="fa fa-check"></i><b>4.5.4</b> Bar chart with assigned value</a></li>
<li class="chapter" data-level="4.5.5" data-path="ggplot2.html"><a href="ggplot2.html#legend"><i class="fa fa-check"></i><b>4.5.5</b> Legend</a></li>
<li class="chapter" data-level="4.5.6" data-path="ggplot2.html"><a href="ggplot2.html#boxplots-jittering-and-violin-plots"><i class="fa fa-check"></i><b>4.5.6</b> Boxplots, jittering and violin plots</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="ggplot2.html"><a href="ggplot2.html#collective-geoms"><i class="fa fa-check"></i><b>4.6</b> Collective geoms</a><ul>
<li class="chapter" data-level="4.6.1" data-path="ggplot2.html"><a href="ggplot2.html#smoother"><i class="fa fa-check"></i><b>4.6.1</b> Smoother</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="ggplot2.html"><a href="ggplot2.html#time-series"><i class="fa fa-check"></i><b>4.7</b> Time Series</a><ul>
<li class="chapter" data-level="4.7.1" data-path="ggplot2.html"><a href="ggplot2.html#basic-line-plots"><i class="fa fa-check"></i><b>4.7.1</b> Basic line plots</a></li>
<li class="chapter" data-level="4.7.2" data-path="ggplot2.html"><a href="ggplot2.html#add-a-second-line"><i class="fa fa-check"></i><b>4.7.2</b> Add a second line</a></li>
<li class="chapter" data-level="4.7.3" data-path="ggplot2.html"><a href="ggplot2.html#add-ribbons"><i class="fa fa-check"></i><b>4.7.3</b> Add ribbons</a></li>
<li class="chapter" data-level="4.7.4" data-path="ggplot2.html"><a href="ggplot2.html#adjust-the-scale-of-time-axis"><i class="fa fa-check"></i><b>4.7.4</b> Adjust the scale of time axis</a></li>
<li class="chapter" data-level="4.7.5" data-path="ggplot2.html"><a href="ggplot2.html#add-annotations"><i class="fa fa-check"></i><b>4.7.5</b> Add annotations</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="ggplot2.html"><a href="ggplot2.html#maps"><i class="fa fa-check"></i><b>4.8</b> Maps</a><ul>
<li class="chapter" data-level="4.8.1" data-path="ggplot2.html"><a href="ggplot2.html#making-a-base-map"><i class="fa fa-check"></i><b>4.8.1</b> Making a base map</a></li>
<li class="chapter" data-level="4.8.2" data-path="ggplot2.html"><a href="ggplot2.html#customizing-choropleth-map"><i class="fa fa-check"></i><b>4.8.2</b> Customizing <code>choropleth</code> map</a></li>
<li class="chapter" data-level="4.8.3" data-path="ggplot2.html"><a href="ggplot2.html#overlay-polygon-maps"><i class="fa fa-check"></i><b>4.8.3</b> Overlay polygon maps</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="ggplot2.html"><a href="ggplot2.html#arranging-plots"><i class="fa fa-check"></i><b>4.9</b> Arranging Plots</a><ul>
<li class="chapter" data-level="4.9.1" data-path="ggplot2.html"><a href="ggplot2.html#facet"><i class="fa fa-check"></i><b>4.9.1</b> Facet</a></li>
<li class="chapter" data-level="4.9.2" data-path="ggplot2.html"><a href="ggplot2.html#combining-plots-using-patchwork-package"><i class="fa fa-check"></i><b>4.9.2</b> Combining plots using <code>patchwork</code> package</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="ggplot2.html"><a href="ggplot2.html#output"><i class="fa fa-check"></i><b>4.10</b> Output</a><ul>
<li class="chapter" data-level="4.10.1" data-path="ggplot2.html"><a href="ggplot2.html#save-in-figure-format"><i class="fa fa-check"></i><b>4.10.1</b> Save in figure format</a></li>
<li class="chapter" data-level="4.10.2" data-path="ggplot2.html"><a href="ggplot2.html#save-in-rds-format"><i class="fa fa-check"></i><b>4.10.2</b> Save in RDS format</a></li>
</ul></li>
<li class="chapter" data-level="4.11" data-path="ggplot2.html"><a href="ggplot2.html#exercises-1"><i class="fa fa-check"></i><b>4.11</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="plotly.html"><a href="plotly.html"><i class="fa fa-check"></i><b>5</b> Interactive Visualization</a><ul>
<li class="chapter" data-level="5.1" data-path="plotly.html"><a href="plotly.html#an-introduction"><i class="fa fa-check"></i><b>5.1</b> An Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="plotly.html"><a href="plotly.html#creating-plotly-objects"><i class="fa fa-check"></i><b>5.2</b> Creating Plotly Objects</a><ul>
<li class="chapter" data-level="5.2.1" data-path="plotly.html"><a href="plotly.html#using-plot_ly-to-create-a-plotly-object"><i class="fa fa-check"></i><b>5.2.1</b> Using <code>plot_ly()</code> to create a plotly object</a></li>
<li class="chapter" data-level="5.2.2" data-path="plotly.html"><a href="plotly.html#use-dplyr-verbs-to-modify-data"><i class="fa fa-check"></i><b>5.2.2</b> Use <code>dplyr</code> verbs to modify data</a></li>
<li class="chapter" data-level="5.2.3" data-path="plotly.html"><a href="plotly.html#using-ggplotly-to-create-a-plotly-object"><i class="fa fa-check"></i><b>5.2.3</b> Using <code>ggplotly()</code> to create a <code>plotly</code> object</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="plotly.html"><a href="plotly.html#scatterplots-and-line-plots"><i class="fa fa-check"></i><b>5.3</b> Scatterplots and Line Plots</a><ul>
<li class="chapter" data-level="5.3.1" data-path="plotly.html"><a href="plotly.html#make-a-scatterplot"><i class="fa fa-check"></i><b>5.3.1</b> Make a scatterplot</a></li>
<li class="chapter" data-level="5.3.2" data-path="plotly.html"><a href="plotly.html#markers"><i class="fa fa-check"></i><b>5.3.2</b> Markers</a></li>
<li class="chapter" data-level="5.3.3" data-path="plotly.html"><a href="plotly.html#a-single-time-series-plot"><i class="fa fa-check"></i><b>5.3.3</b> A single time series plot</a></li>
<li class="chapter" data-level="5.3.4" data-path="plotly.html"><a href="plotly.html#hover-text-and-template"><i class="fa fa-check"></i><b>5.3.4</b> Hover text and template</a></li>
<li class="chapter" data-level="5.3.5" data-path="plotly.html"><a href="plotly.html#multiple-time-series-plots"><i class="fa fa-check"></i><b>5.3.5</b> Multiple time series plots</a></li>
<li class="chapter" data-level="5.3.6" data-path="plotly.html"><a href="plotly.html#more-features-about-the-lines"><i class="fa fa-check"></i><b>5.3.6</b> More features about the lines</a></li>
<li class="chapter" data-level="5.3.7" data-path="plotly.html"><a href="plotly.html#add-ribbons-1"><i class="fa fa-check"></i><b>5.3.7</b> Add ribbons</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="plotly.html"><a href="plotly.html#pie-charts"><i class="fa fa-check"></i><b>5.4</b> Pie Charts</a></li>
<li class="chapter" data-level="5.5" data-path="plotly.html"><a href="plotly.html#animation"><i class="fa fa-check"></i><b>5.5</b> Animation</a><ul>
<li class="chapter" data-level="5.5.1" data-path="plotly.html"><a href="plotly.html#an-animation-of-the-evolution-of-infected-vs.-death-count"><i class="fa fa-check"></i><b>5.5.1</b> An animation of the evolution of infected vs. death count</a></li>
<li class="chapter" data-level="5.5.2" data-path="plotly.html"><a href="plotly.html#an-animation-of-the-state-level-time-series-plot-of-infected-count"><i class="fa fa-check"></i><b>5.5.2</b> An animation of the state-level time series plot of infected count</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="plotly.html"><a href="plotly.html#saving-html"><i class="fa fa-check"></i><b>5.6</b> Saving HTML</a><ul>
<li class="chapter" data-level="5.6.1" data-path="plotly.html"><a href="plotly.html#save-as-a-standalone-html-file"><i class="fa fa-check"></i><b>5.6.1</b> Save as a standalone HTML file</a></li>
<li class="chapter" data-level="5.6.2" data-path="plotly.html"><a href="plotly.html#save-as-non-selfcontained-html-file"><i class="fa fa-check"></i><b>5.6.2</b> Save as non-selfcontained HTML file</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="plotly.html"><a href="plotly.html#exercises-2"><i class="fa fa-check"></i><b>5.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="shiny.html"><a href="shiny.html"><i class="fa fa-check"></i><b>6</b> R Shiny</a><ul>
<li class="chapter" data-level="6.1" data-path="shiny.html"><a href="shiny.html#embedding-plotly-in-shiny"><i class="fa fa-check"></i><b>6.1</b> Embedding plotly in Shiny</a><ul>
<li class="chapter" data-level="6.1.1" data-path="shiny.html"><a href="shiny.html#your-first-shiny-app"><i class="fa fa-check"></i><b>6.1.1</b> Your first shiny app</a></li>
<li class="chapter" data-level="6.1.2" data-path="shiny.html"><a href="shiny.html#useful-input-widgets"><i class="fa fa-check"></i><b>6.1.2</b> Useful input widgets</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="shiny.html"><a href="shiny.html#rendering-plotly-inside-shiny"><i class="fa fa-check"></i><b>6.2</b> Rendering plotly Inside Shiny</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="map.html"><a href="map.html"><i class="fa fa-check"></i><b>7</b> Interactive Geospatial Visualization</a><ul>
<li class="chapter" data-level="7.1" data-path="map.html"><a href="map.html#an-introduction-to-leaflet"><i class="fa fa-check"></i><b>7.1</b> An Introduction to Leaflet</a><ul>
<li class="chapter" data-level="7.1.1" data-path="map.html"><a href="map.html#features-and-installation"><i class="fa fa-check"></i><b>7.1.1</b> Features and installation</a></li>
<li class="chapter" data-level="7.1.2" data-path="map.html"><a href="map.html#basic-usage"><i class="fa fa-check"></i><b>7.1.2</b> Basic Usage</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="map.html"><a href="map.html#the-data-object"><i class="fa fa-check"></i><b>7.2</b> The Data Object</a></li>
<li class="chapter" data-level="7.3" data-path="map.html"><a href="map.html#choropleth-map"><i class="fa fa-check"></i><b>7.3</b> Choropleth map</a><ul>
<li class="chapter" data-level="7.3.1" data-path="map.html"><a href="map.html#create-a-base-map"><i class="fa fa-check"></i><b>7.3.1</b> Create a base map</a></li>
<li class="chapter" data-level="7.3.2" data-path="map.html"><a href="map.html#color-the-map"><i class="fa fa-check"></i><b>7.3.2</b> Color the map</a></li>
<li class="chapter" data-level="7.3.3" data-path="map.html"><a href="map.html#interactive-map"><i class="fa fa-check"></i><b>7.3.3</b> Interactive map</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="map.html"><a href="map.html#legend-1"><i class="fa fa-check"></i><b>7.4</b> Legend</a><ul>
<li class="chapter" data-level="7.4.1" data-path="map.html"><a href="map.html#classification-schemes"><i class="fa fa-check"></i><b>7.4.1</b> Classification schemes</a></li>
<li class="chapter" data-level="7.4.2" data-path="map.html"><a href="map.html#mapping-variables-to-colors"><i class="fa fa-check"></i><b>7.4.2</b> Mapping variables to colors</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="map.html"><a href="map.html#an-example-of-county-level-map"><i class="fa fa-check"></i><b>7.5</b> An Example of County-level Map</a></li>
<li class="chapter" data-level="7.6" data-path="map.html"><a href="map.html#spot-maps"><i class="fa fa-check"></i><b>7.6</b> Spot Maps</a></li>
<li class="chapter" data-level="7.7" data-path="map.html"><a href="map.html#integrating-leaflet-with-r-shiny"><i class="fa fa-check"></i><b>7.7</b> Integrating Leaflet with R Shiny</a></li>
<li class="chapter" data-level="7.8" data-path="map.html"><a href="map.html#exercises-3"><i class="fa fa-check"></i><b>7.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="modeling.html"><a href="modeling.html"><i class="fa fa-check"></i><b>8</b> Epidemic Modeling</a><ul>
<li class="chapter" data-level="8.1" data-path="modeling.html"><a href="modeling.html#an-introduction-to-epidemic-modeling"><i class="fa fa-check"></i><b>8.1</b> An Introduction to Epidemic Modeling</a></li>
<li class="chapter" data-level="8.2" data-path="modeling.html"><a href="modeling.html#compartment-models"><i class="fa fa-check"></i><b>8.2</b> Compartment Models</a><ul>
<li class="chapter" data-level="8.2.1" data-path="modeling.html"><a href="modeling.html#a-simple-sis-model-a-model-for-diseases-with-no-immunity"><i class="fa fa-check"></i><b>8.2.1</b> A Simple SIS Model (A Model for Diseases with No Immunity)</a></li>
<li class="chapter" data-level="8.2.2" data-path="modeling.html"><a href="modeling.html#an-sir-model"><i class="fa fa-check"></i><b>8.2.2</b> An SIR Model</a></li>
<li class="chapter" data-level="8.2.3" data-path="modeling.html"><a href="modeling.html#an-sir-model-with-births-and-deaths"><i class="fa fa-check"></i><b>8.2.3</b> An SIR model with births and deaths</a></li>
<li class="chapter" data-level="8.2.4" data-path="modeling.html"><a href="modeling.html#sir-parameter-estimation"><i class="fa fa-check"></i><b>8.2.4</b> SIR parameter estimation</a></li>
<li class="chapter" data-level="8.2.5" data-path="modeling.html"><a href="modeling.html#implementation-of-parameter-estimation-in-r"><i class="fa fa-check"></i><b>8.2.5</b> Implementation of parameter estimation in R</a></li>
<li class="chapter" data-level="8.2.6" data-path="modeling.html"><a href="modeling.html#basic-reproduction-number"><i class="fa fa-check"></i><b>8.2.6</b> Basic Reproduction Number</a></li>
<li class="chapter" data-level="8.2.7" data-path="modeling.html"><a href="modeling.html#seir-model"><i class="fa fa-check"></i><b>8.2.7</b> SEIR Model</a></li>
<li class="chapter" data-level="8.2.8" data-path="modeling.html"><a href="modeling.html#herd-immunity"><i class="fa fa-check"></i><b>8.2.8</b> Herd Immunity</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>9</b> Regression Modeling</a><ul>
<li class="chapter" data-level="9.1" data-path="regression.html"><a href="regression.html#principles-of-regression-modeling"><i class="fa fa-check"></i><b>9.1</b> Principles of Regression Modeling</a><ul>
<li class="chapter" data-level="9.1.1" data-path="regression.html"><a href="regression.html#linear-regression"><i class="fa fa-check"></i><b>9.1.1</b> Linear regression</a></li>
<li class="chapter" data-level="9.1.2" data-path="regression.html"><a href="regression.html#poisson-regression"><i class="fa fa-check"></i><b>9.1.2</b> Poisson regression</a></li>
<li class="chapter" data-level="9.1.3" data-path="regression.html"><a href="regression.html#logistic-regression"><i class="fa fa-check"></i><b>9.1.3</b> Logistic regression</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="regression.html"><a href="regression.html#area-level-data"><i class="fa fa-check"></i><b>9.2</b> Area-level Data</a></li>
<li class="chapter" data-level="9.3" data-path="regression.html"><a href="regression.html#variable-selection"><i class="fa fa-check"></i><b>9.3</b> Variable Selection</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="timeseries.html"><a href="timeseries.html"><i class="fa fa-check"></i><b>10</b> Time Series Analysis of Infectious Disease Data</a><ul>
<li class="chapter" data-level="10.1" data-path="timeseries.html"><a href="timeseries.html#datasets-and-r-packages"><i class="fa fa-check"></i><b>10.1</b> Datasets and R Packages</a></li>
<li class="chapter" data-level="10.2" data-path="timeseries.html"><a href="timeseries.html#time-series-plots"><i class="fa fa-check"></i><b>10.2</b> Time series plots</a><ul>
<li class="chapter" data-level="10.2.1" data-path="timeseries.html"><a href="timeseries.html#tsibble-objects"><i class="fa fa-check"></i><b>10.2.1</b> “tsibble” objects</a></li>
<li class="chapter" data-level="10.2.2" data-path="timeseries.html"><a href="timeseries.html#working-with-tsibble-objects"><i class="fa fa-check"></i><b>10.2.2</b> Working with “tsibble” objects</a></li>
<li class="chapter" data-level="10.2.3" data-path="timeseries.html"><a href="timeseries.html#drawing-time-series-plots"><i class="fa fa-check"></i><b>10.2.3</b> Drawing time series plots</a></li>
<li class="chapter" data-level="10.2.4" data-path="timeseries.html"><a href="timeseries.html#objectives-of-time-series-analysis"><i class="fa fa-check"></i><b>10.2.4</b> Objectives of Time Series Analysis</a></li>
<li class="chapter" data-level="10.2.5" data-path="timeseries.html"><a href="timeseries.html#autocorrelation"><i class="fa fa-check"></i><b>10.2.5</b> Autocorrelation</a></li>
<li class="chapter" data-level="10.2.6" data-path="timeseries.html"><a href="timeseries.html#autocorrelation-1"><i class="fa fa-check"></i><b>10.2.6</b> Autocorrelation</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="timeseries.html"><a href="timeseries.html#time-series-decomposition"><i class="fa fa-check"></i><b>10.3</b> Time Series Decomposition</a></li>
<li class="chapter" data-level="10.4" data-path="timeseries.html"><a href="timeseries.html#simple-time-series-forecasting-approaches"><i class="fa fa-check"></i><b>10.4</b> Simple Time Series Forecasting Approaches</a><ul>
<li class="chapter" data-level="10.4.1" data-path="timeseries.html"><a href="timeseries.html#average-method"><i class="fa fa-check"></i><b>10.4.1</b> Average method</a></li>
<li class="chapter" data-level="10.4.2" data-path="timeseries.html"><a href="timeseries.html#random-walk-forecasts"><i class="fa fa-check"></i><b>10.4.2</b> Random walk forecasts</a></li>
<li class="chapter" data-level="10.4.3" data-path="timeseries.html"><a href="timeseries.html#seasonal-random-walk-forecasts"><i class="fa fa-check"></i><b>10.4.3</b> Seasonal random walk forecasts</a></li>
<li class="chapter" data-level="10.4.4" data-path="timeseries.html"><a href="timeseries.html#random-walk-with-drift-method"><i class="fa fa-check"></i><b>10.4.4</b> Random walk with drift method</a></li>
<li class="chapter" data-level="10.4.5" data-path="timeseries.html"><a href="timeseries.html#combining-the-forecasting-results"><i class="fa fa-check"></i><b>10.4.5</b> Combining the forecasting results</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="timeseries.html"><a href="timeseries.html#methods-for-estimating-the-trend"><i class="fa fa-check"></i><b>10.5</b> Methods for Estimating the Trend</a></li>
<li class="chapter" data-level="10.6" data-path="timeseries.html"><a href="timeseries.html#arma-models"><i class="fa fa-check"></i><b>10.6</b> ARMA Models</a><ul>
<li class="chapter" data-level="10.6.1" data-path="timeseries.html"><a href="timeseries.html#simple-examples-of-arma-models"><i class="fa fa-check"></i><b>10.6.1</b> Simple Examples of ARMA Models</a></li>
<li class="chapter" data-level="10.6.2" data-path="timeseries.html"><a href="timeseries.html#arima"><i class="fa fa-check"></i><b>10.6.2</b> ARIMA</a></li>
<li class="chapter" data-level="10.6.3" data-path="timeseries.html"><a href="timeseries.html#seasonal-arima-model"><i class="fa fa-check"></i><b>10.6.3</b> Seasonal ARIMA model</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="timeseries.html"><a href="timeseries.html#model-comparison"><i class="fa fa-check"></i><b>10.7</b> Model Comparison</a></li>
<li class="chapter" data-level="10.8" data-path="timeseries.html"><a href="timeseries.html#ensuring-forecasts-stay-within-limits"><i class="fa fa-check"></i><b>10.8</b> Ensuring forecasts stay within limits</a><ul>
<li class="chapter" data-level="10.8.1" data-path="timeseries.html"><a href="timeseries.html#positive-forecasts"><i class="fa fa-check"></i><b>10.8.1</b> Positive forecasts</a></li>
<li class="chapter" data-level="10.8.2" data-path="timeseries.html"><a href="timeseries.html#forecasts-constrained-to-an-interval"><i class="fa fa-check"></i><b>10.8.2</b> Forecasts constrained to an interval</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="timeseries.html"><a href="timeseries.html#prediction-intervals-for-aggregates"><i class="fa fa-check"></i><b>10.9</b> Prediction intervals for aggregates</a></li>
<li class="chapter" data-level="10.10" data-path="timeseries.html"><a href="timeseries.html#exercises-4"><i class="fa fa-check"></i><b>10.10</b> Exercises</a></li>
<li class="chapter" data-level="10.11" data-path="timeseries.html"><a href="timeseries.html#references"><i class="fa fa-check"></i><b>10.11</b> References</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="NN.html"><a href="NN.html"><i class="fa fa-check"></i><b>11</b> Neural Networks</a><ul>
<li class="chapter" data-level="11.1" data-path="NN.html"><a href="NN.html#a-single-neuron"><i class="fa fa-check"></i><b>11.1</b> A Single Neuron</a></li>
<li class="chapter" data-level="11.2" data-path="NN.html"><a href="NN.html#neural-network-structure"><i class="fa fa-check"></i><b>11.2</b> Neural Network Structure</a><ul>
<li class="chapter" data-level="11.2.1" data-path="NN.html"><a href="NN.html#forward-propagation"><i class="fa fa-check"></i><b>11.2.1</b> Forward propagation</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="NN.html"><a href="NN.html#overfitting"><i class="fa fa-check"></i><b>11.3</b> Overfitting</a></li>
<li class="chapter" data-level="11.4" data-path="NN.html"><a href="NN.html#neural-network-auto-regressive-nnar-models"><i class="fa fa-check"></i><b>11.4</b> Neural Network Auto-Regressive (NNAR) models</a></li>
<li class="chapter" data-level="11.5" data-path="NN.html"><a href="NN.html#covid-19-forecasting"><i class="fa fa-check"></i><b>11.5</b> COVID-19 Forecasting</a></li>
<li class="chapter" data-level="11.6" data-path="NN.html"><a href="NN.html#box-cox-transformations"><i class="fa fa-check"></i><b>11.6</b> Box-Cox transformations</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="ensemble.html"><a href="ensemble.html"><i class="fa fa-check"></i><b>12</b> Hybrid Mdels</a><ul>
<li class="chapter" data-level="12.1" data-path="ensemble.html"><a href="ensemble.html#ensembling-time-series-models"><i class="fa fa-check"></i><b>12.1</b> Ensembling Time Series Models</a></li>
<li class="chapter" data-level="12.2" data-path="ensemble.html"><a href="ensemble.html#model-diagnostics"><i class="fa fa-check"></i><b>12.2</b> Model Diagnostics</a></li>
<li class="chapter" data-level="12.3" data-path="ensemble.html"><a href="ensemble.html#forecasting"><i class="fa fa-check"></i><b>12.3</b> Forecasting</a><ul>
<li class="chapter" data-level="12.3.1" data-path="ensemble.html"><a href="ensemble.html#perform-cross-validation-on-a-time-series"><i class="fa fa-check"></i><b>12.3.1</b> Perform cross validation on a time series</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="ensemble.html"><a href="ensemble.html#weights-selection-using-cross-validation"><i class="fa fa-check"></i><b>12.4</b> Weights Selection Using Cross Validation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-1.html"><a href="references-1.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i>Appendix</a></li>
<li class="chapter" data-level="13" data-path="appendix-a.html"><a href="appendix-a.html"><i class="fa fa-check"></i><b>13</b> Appendix A</a><ul>
<li class="chapter" data-level="13.1" data-path="appendix-a.html"><a href="appendix-a.html#r-introduction-and-preliminaries"><i class="fa fa-check"></i><b>13.1</b> R Introduction and Preliminaries</a><ul>
<li class="chapter" data-level="13.1.1" data-path="appendix-a.html"><a href="appendix-a.html#the-r-environment-and-language"><i class="fa fa-check"></i><b>13.1.1</b> The R Environment and Language</a></li>
<li class="chapter" data-level="13.1.2" data-path="appendix-a.html"><a href="appendix-a.html#r-and-statistics"><i class="fa fa-check"></i><b>13.1.2</b> R and Statistics</a></li>
<li class="chapter" data-level="13.1.3" data-path="appendix-a.html"><a href="appendix-a.html#obtaining-r-and-installation"><i class="fa fa-check"></i><b>13.1.3</b> Obtaining R and installation</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="appendix-a.html"><a href="appendix-a.html#starting-r"><i class="fa fa-check"></i><b>13.2</b> Starting R</a><ul>
<li class="chapter" data-level="13.2.1" data-path="appendix-a.html"><a href="appendix-a.html#description-of-three-panels-in-user-interface"><i class="fa fa-check"></i><b>13.2.1</b> Description of three panels in user interface</a></li>
<li class="chapter" data-level="13.2.2" data-path="appendix-a.html"><a href="appendix-a.html#r-help"><i class="fa fa-check"></i><b>13.2.2</b> R help</a></li>
<li class="chapter" data-level="13.2.3" data-path="appendix-a.html"><a href="appendix-a.html#some-mathematical-expressions"><i class="fa fa-check"></i><b>13.2.3</b> Some mathematical expressions</a></li>
<li class="chapter" data-level="13.2.4" data-path="appendix-a.html"><a href="appendix-a.html#r-packages"><i class="fa fa-check"></i><b>13.2.4</b> R Packages</a></li>
<li class="chapter" data-level="13.2.5" data-path="appendix-a.html"><a href="appendix-a.html#creating-a-project-and-setting-working-directory"><i class="fa fa-check"></i><b>13.2.5</b> Creating a project and setting working directory</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="appendix-a.html"><a href="appendix-a.html#exportimport-data"><i class="fa fa-check"></i><b>13.3</b> Export/Import Data</a><ul>
<li class="chapter" data-level="13.3.1" data-path="appendix-a.html"><a href="appendix-a.html#data-export"><i class="fa fa-check"></i><b>13.3.1</b> Data Export</a></li>
<li class="chapter" data-level="13.3.2" data-path="appendix-a.html"><a href="appendix-a.html#data-import"><i class="fa fa-check"></i><b>13.3.2</b> Data Import</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="appendix-b.html"><a href="appendix-b.html"><i class="fa fa-check"></i><b>14</b> Appendix B</a><ul>
<li class="chapter" data-level="14.1" data-path="appendix-b.html"><a href="appendix-b.html#epidemic-data"><i class="fa fa-check"></i><b>14.1</b> Epidemic Data</a><ul>
<li class="chapter" data-level="14.1.1" data-path="appendix-b.html"><a href="appendix-b.html#state-level"><i class="fa fa-check"></i><b>14.1.1</b> State level</a></li>
<li class="chapter" data-level="14.1.2" data-path="appendix-b.html"><a href="appendix-b.html#county-level"><i class="fa fa-check"></i><b>14.1.2</b> County level</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="appendix-b.html"><a href="appendix-b.html#other-factors"><i class="fa fa-check"></i><b>14.2</b> Other Factors</a><ul>
<li class="chapter" data-level="14.2.1" data-path="appendix-b.html"><a href="appendix-b.html#policy-data"><i class="fa fa-check"></i><b>14.2.1</b> Policy Data</a></li>
<li class="chapter" data-level="14.2.2" data-path="appendix-b.html"><a href="appendix-b.html#demographic-characteristics"><i class="fa fa-check"></i><b>14.2.2</b> Demographic Characteristics</a></li>
<li class="chapter" data-level="14.2.3" data-path="appendix-b.html"><a href="appendix-b.html#healthcare-infrastructure"><i class="fa fa-check"></i><b>14.2.3</b> Healthcare Infrastructure</a></li>
<li class="chapter" data-level="14.2.4" data-path="appendix-b.html"><a href="appendix-b.html#socioeconomic-status"><i class="fa fa-check"></i><b>14.2.4</b> Socioeconomic Status</a></li>
<li class="chapter" data-level="14.2.5" data-path="appendix-b.html"><a href="appendix-b.html#environmental-factor"><i class="fa fa-check"></i><b>14.2.5</b> Environmental Factor</a></li>
<li class="chapter" data-level="14.2.6" data-path="appendix-b.html"><a href="appendix-b.html#mobility"><i class="fa fa-check"></i><b>14.2.6</b> Mobility</a></li>
<li class="chapter" data-level="14.2.7" data-path="appendix-b.html"><a href="appendix-b.html#geographic-information"><i class="fa fa-check"></i><b>14.2.7</b> Geographic Information</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="appendix-b.html"><a href="appendix-b.html#data-sets"><i class="fa fa-check"></i><b>14.3</b> Data Sets</a><ul>
<li class="chapter" data-level="14.3.1" data-path="appendix-b.html"><a href="appendix-b.html#chapter-2"><i class="fa fa-check"></i><b>14.3.1</b> Chapter 2</a></li>
<li class="chapter" data-level="14.3.2" data-path="appendix-b.html"><a href="appendix-b.html#chapter-3"><i class="fa fa-check"></i><b>14.3.2</b> Chapter 3</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Learning of Infectious Disease Data Analytics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modeling" class="section level1">
<h1><span class="header-section-number">Chapter 8</span> Epidemic Modeling</h1>
<div id="an-introduction-to-epidemic-modeling" class="section level2">
<h2><span class="header-section-number">8.1</span> An Introduction to Epidemic Modeling</h2>
<p>Epidemic modeling has three main aims <span class="citation">(Daley and Gani <a href="#ref-Daley:Gani:01">2001</a>)</span>: (1) to understand better the mechanisms by which diseases spread; (2) to identify which factors contribute to the spread of the epidemic, and therefore how we may control it; (3) to predict the future course of the epidemic. Although there are many epidemic modeling methods, mathematical and statistical models have played important roles in COVID-19studies. As illustrated in Figure <a href="modeling.html#fig:mathstat">8.1</a>, mathematical and statistical approaches are complementary, but their starting points are different, and the corresponding models tend to incorporate different details.</p>
<div class="figure" style="text-align: center"><span id="fig:mathstat"></span>
<img src="figures/model.png" alt="Mathematical and statistical perspectives on epidemic modeling." width="65%" />
<p class="caption">
Figure 8.1: Mathematical and statistical perspectives on epidemic modeling.
</p>
</div>
<p>As mentioned above, the fundamental concept of infectious disease epidemiology is investigating how the diseases spread. Mathematical models are undeniably useful in understanding the dynamics of infectious disease spread (e.g., when the peak will occur and whether resurgence will happen) and the effects of control measures <span class="citation">(Keeling and Rohani <a href="#ref-Keeling:Rohani:08">2008</a>)</span>. An essential type of mathematical model is the class of mechanistic models such as the Susceptible - Infectious - Removed (SIR) compartmental model or the Susceptible - Exposed - Infectious - Recovered model (SEIR) as illustrated in Figure <a href="modeling.html#fig:SEIR">8.2</a>; see details in <span class="citation">Brauer, Driessche, and Wu (<a href="#ref-Brauer:etal:08">2008</a>)</span> and <span class="citation">Lawson et al. (<a href="#ref-Lawson:etal:16">2016</a>)</span>. Mechanistic models make explicit hypotheses about the biological mechanisms that drive the dynamics of infection, and they function well if the aim is to evaluate the effectiveness of hypothetical NPIs in controlling disease spread <span class="citation">(Lessler and Cummings <a href="#ref-lessler2016mechanistic">2016</a>)</span>.</p>
<div class="figure" style="text-align: center"><span id="fig:SEIR"></span>
<img src="figures/SEIR1.pdf" alt="An illustration of SIR and SEIR models." width="75%" />
<p class="caption">
Figure 8.2: An illustration of SIR and SEIR models.
</p>
</div>
<p>In the literature, statistical modeling has given the scientific field many successes in analyzing data and getting information about the mechanisms producing the data. Statistical modeling is a powerful tool for extracting information about the disease spread in epidemic studies <span class="citation">(Held et al. <a href="#ref-Held:etal:20">2020</a>)</span>. Statistics starts with data, and statistical modeling allows data to speak for themselves. There are two cultures in statistical modeling <span class="citation">(Breiman <a href="#ref-Breiman:01">2001</a>)</span>: the data modeling culture and the algorithmic modeling culture. The first one assumes that the data are generated by a given stochastic data model, and it is usually designed for inference about the relationships between variables whilst also catering to prediction. Algorithmic models treat the data mechanism as unknown and are usually designed to make the most accurate predictions possible.</p>
<p>When analyzing the spread of infectious diseases, other factors, such as demographic characteristics, socioeconomic status, and control policies, may also be responsible for temporal or spatial patterns. For example, the spread of the disease varies considerably across different geographical regions. Local area - features, like socioeconomic factors and demographic conditions, can dramatically influence the course of the epidemic. These data are usually supplemented with the population information at the county level. Moreover, the capacity of the health care system, and control measures, such as government - mandated social distancing, also have a significant impact on the spread of the epidemic. Regression is a widely used statistical modeling method in epidemic studies because it produces a combination of the variables with weights indicating the impact of the variable <span class="citation">(Jewell <a href="#ref-jewell2003statistics">2003</a>)</span>. It can help determine which factors matter most, which can be ignored, and how those factors interact with each other. The benefit of regression analysis is that it can be used to understand different patterns in data. These insights may often be very valuable in understanding which factors contribute to the spread of COVID - 19.</p>
<p>Predicting the spread speed and severity of COVID-19is crucial to resource management, developing strategies to deal with the epidemic, and ultimately assisting in prevention efforts. Mathematical models are able to mimic the way disease spreads and can be used to project or simulate future transmission scenarios under various assumptions. Statistical models are more oriented towards predictions <span class="citation">(Held et al. <a href="#ref-Held:etal:20">2020</a>)</span>. In fact, predictions are at the heart of statistical modeling. For example, time series analysis, one commonly used statistical forecasting approach, works by taking a series of historical observations and extrapolating the patterns into the future. Machine learning makes predictions based on known properties learned from the training data. However, purely statistical models only describe the observed data and give little information about the mechanism since they do not account for how transmission occurs. Therefore, they are generally not well - suited for long - term predictions, and a few weeks is usually close to being the ultimate prediction limit. Another advantage of statistical modeling is its ability to quantify uncertainty in the prediction, especially at an early phase of an epidemic with limited data. For example, statistical models can provide a prediction interval to understand the uncertainty surrounding the forecast <span class="citation">(Brockwell and Davis <a href="#ref-brockwell2002introduction">2016</a>)</span>. See more discussions in the following section.</p>
<p>In summary, mathematical models are usually constructed in a more principle - driven manner, while statistical models are more data - driven. Although both mathematical and statistical models can be used to study the effect of NPIs and make predictions, the implementation details are different, and an understanding of the corresponding limitations is crucial. For maximal effectiveness, researchers working to advance epidemic modeling will need to appreciate and exploit the complementary strengths of mathematical and statistical models.</p>
</div>
<div id="compartment-models" class="section level2">
<h2><span class="header-section-number">8.2</span> Compartment Models</h2>
<p>Mathematical models of infectious disease dynamics have a rich history that dates back more than 100 years. Mathematically simple formulations that describe the transition of individuals in a population between ‘compartments’ that capture the infection status of individuals leads to surprisingly significant insight. Their elegance and simplicity allow the ease of expansion to more complexities through, for example, the addition of compartments. Expanding these models is often straight forward but the apparent simplicity can mask subtle, but important, model structure and parameterization choices. Furthermore, while there are many wonderful texts focused on infectious disease modeling, there exist several complexities that are rarely discussed in sufficient detail for a novice disease modeler.</p>
<p>We formulate our descriptions of disease transmission as compartmental models, with the population under study being divided into compartments.</p>
<p>At time <span class="math inline">\(t\)</span>, denote</p>
<ul>
<li><span class="math inline">\(S(t)\)</span>: the number of susceptible people;</li>
<li><span class="math inline">\(E(t)\)</span>: the number of infected but not yet infectious people;</li>
<li><span class="math inline">\(I(t)\)</span>: the number of infectious people;</li>
<li><span class="math inline">\(R(t)\)</span>: the number of recovered people.</li>
</ul>
<div id="a-simple-sis-model-a-model-for-diseases-with-no-immunity" class="section level3">
<h3><span class="header-section-number">8.2.1</span> A Simple SIS Model (A Model for Diseases with No Immunity)</h3>
<p>In many diseases, infectives return to the susceptible class on recovery because the disease confers no immunity. Such models are appropriate for most diseases transmitted by bacterial or helminth agents, and most sexually transmitted diseases (including gonorrhea, but not such diseases as AIDS, from which there is no recovery).</p>
<div class="figure" style="text-align: center"><span id="fig:SIS"></span>
<img src="figures/SIS.png" alt="A simple SIS model." width="50%" />
<p class="caption">
Figure 8.3: A simple SIS model.
</p>
</div>
<p>In an SIS model, the total population size <span class="math inline">\(N = S(t) + I(t)\)</span>. The simplest SIS model, due to Kermack and McKendrick, is</p>
<span class="math display">\[\begin{eqnarray*}
\frac{dS(t)}{dt}&amp; = &amp; - \beta I(t)\frac{S(t)}{N} + \gamma I(t), \\
\frac{dI(t)}{dt}&amp; = &amp;\beta I(t)\frac{S(t)}{N} - \gamma I(t)
\end{eqnarray*}\]</span>
<p>where <span class="math inline">\(\beta\)</span> is the effective contact rate, and <span class="math display">\[
\beta \propto \left(\frac{\mathrm{infection}}{\mathrm{contact}} \right) \times \left(\frac{\mathrm{contact}}{\mathrm{time}}\right). 
\]</span></p>
<p><strong>Assumptions of SIS models</strong></p>
<ol style="list-style-type: lower-roman">
<li>The rate of new infections is given by mass action incidence.</li>
<li>Infectives leave the infective class at rate <span class="math inline">\(\gamma I\)</span> per unit time and return to the susceptible class.</li>
<li>There is no entry into or departure from the population.</li>
<li>There are no disease deaths, and the total population size is a constant <span class="math inline">\(N\)</span>.</li>
</ol>
</div>
<div id="an-sir-model" class="section level3">
<h3><span class="header-section-number">8.2.2</span> An SIR Model</h3>
<div class="figure" style="text-align: center"><span id="fig:SIR"></span>
<img src="figures/SIR.png" alt="An SIR model." width="75%" />
<p class="caption">
Figure 8.4: An SIR model.
</p>
</div>
<p>Consider the SIR model in a population of size <span class="math inline">\(N\)</span>, and note <span class="math inline">\(N = S(t) + I(t) + R(t)\)</span>:</p>
<span class="math display">\[\begin{eqnarray*}
\frac{dS(t)}{dt}&amp; = &amp; - \beta I(t)\frac{S(t)}{N}, \\
\frac{dI(t)}{dt}&amp; = &amp;\beta I(t)\frac{S(t)}{N} - \gamma I(t), \\
\frac{dR(t)}{dt}&amp; = &amp;\gamma I(t), 
\end{eqnarray*}\]</span>
<p>where <span class="math inline">\(\beta\)</span> is the effective contact rate, and <span class="math display">\[
  \beta \propto \left(\frac{\mathrm{infection}}{\mathrm{contact}} \right) \times \left(\frac{\mathrm{contact}}{\mathrm{time}}\right),  
\]</span> i.e., (probability of transmission given a contact between a susceptible and an infectious individual) <span class="math inline">\(\times\)</span> (average rate of contact between susceptible and infected individuals); <span class="math inline">\(\gamma\)</span> is the removal rate, and <span class="math inline">\(\gamma^{-1}\)</span> is the average infectious period. The logic of the transmission term is that <span class="math inline">\(\beta\)</span> is the contact rate among hosts times the probability of infection given a contact.</p>
<p>Let <span class="math inline">\(s = S / N\)</span>, <span class="math inline">\(i = I / N\)</span> and <span class="math inline">\(r = R / N\)</span>. Dividing the equations for <span class="math inline">\(S\)</span>, <span class="math inline">\(I\)</span> and <span class="math inline">\(R\)</span> by <span class="math inline">\(N\)</span> we get the deterministic SIR epidemic model for this process in the form:</p>
<span class="math display">\[\begin{eqnarray*}
\frac{ds(t)}{dt}&amp; = &amp; - \beta i(t)s(t), \\
\frac{di(t)}{dt}&amp; = &amp;\beta i(t)s(t) - \gamma i(t), \\
\frac{dr(t)}{dt}&amp; = &amp;\gamma i(t). 
\end{eqnarray*}\]</span>
<p><strong>Assumptions of SIR models</strong></p>
<p>SIR models for diseases assume that infectives recover with immunity against reinfection.</p>
<ul>
<li>Constant (closed) population size: <span class="math inline">\(N\)</span>;</li>
<li>Constant rates (e.g., transmission, removal rates);</li>
<li>No demography (i.e., births and deaths);</li>
<li>Well - mixed population: any infected individual has a probability of contacting any susceptible individual that is reasonably well approximated by the average.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Load deSolve package
<span class="kw">library</span>(deSolve)
## Create an SIR function
sir &lt;-<span class="st"> </span><span class="cf">function</span>(time, state, parameters) {
  
  <span class="kw">with</span>(<span class="kw">as.list</span>(<span class="kw">c</span>(state, parameters)), {
    
    dS &lt;-<span class="st"> </span><span class="op">-</span>beta <span class="op">*</span><span class="st"> </span>S <span class="op">*</span><span class="st"> </span>I
    dI &lt;-<span class="st">  </span>beta <span class="op">*</span><span class="st"> </span>S <span class="op">*</span><span class="st"> </span>I <span class="op">-</span><span class="st"> </span>gamma <span class="op">*</span><span class="st"> </span>I
    dR &lt;-<span class="st">                 </span>gamma <span class="op">*</span><span class="st"> </span>I
    
    <span class="kw">return</span>(<span class="kw">list</span>(<span class="kw">c</span>(dS, dI, dR)))
  })
}</code></pre></div>
<p>Below, we consider a simulation example with <span class="math inline">\(s(0)=0.999\)</span>, <span class="math inline">\(i(0)=0.001\)</span>, <span class="math inline">\(r(0)=0.0\)</span>, <span class="math inline">\(\beta=0.3\)</span> and <span class="math inline">\(\gamma=0.1\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Set parameters</span>
<span class="co"># Proportion in each compartment: Susceptible 0.999, Infected 0.001, Recovered 0</span>
init &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">S =</span> <span class="fl">0.999</span>, <span class="dt">I =</span> <span class="fl">0.001</span>, <span class="dt">R =</span> <span class="fl">0.0</span>)
<span class="co"># beta: infection parameter; gamma: recovery parameter</span>
parameters &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">beta =</span> <span class="fl">0.3</span>, <span class="dt">gamma =</span> <span class="fl">0.1</span>)
<span class="co"># Time frame</span>
times &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">300</span>, <span class="dt">by =</span> <span class="dv">1</span>)

<span class="co"># Solve using ode (General Solver for Ordinary Differential Equations)</span>
out &lt;-<span class="st"> </span><span class="kw">ode</span>(<span class="dt">y =</span> init, <span class="dt">times =</span> times, <span class="dt">func =</span> sir, <span class="dt">parms =</span> parameters)
<span class="co"># change to data frame</span>
out &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(out)
<span class="co"># Show data</span>
<span class="kw">head</span>(out, <span class="dv">5</span>)</code></pre></div>
<pre><code>##   time         S           I            R
## 1    0 0.9990000 0.001000000 0.0000000000
## 2    1 0.9986676 0.001221467 0.0001109293
## 3    2 0.9982619 0.001491698 0.0002463585
## 4    3 0.9977671 0.001821286 0.0004116470
## 5    4 0.9971641 0.002222741 0.0006131418</code></pre>
<p>Figure <a href="modeling.html#fig:sim1">8.5</a> shows the evolution of the prevalence rate.</p>
<div class="figure" style="text-align: center"><span id="fig:sim1"></span>
<img src="bookdown-demo_files/figure-html/sim1-1.png" alt="Simulation example 1." width="100%" />
<p class="caption">
Figure 8.5: Simulation example 1.
</p>
</div>
<p>Next, we consider another simulation example with <span class="math inline">\(s(0)=0.999\)</span>, <span class="math inline">\(i(0)=0.001\)</span>, <span class="math inline">\(r(0)=0.0\)</span>, <span class="math inline">\(\beta=0.075\)</span> and <span class="math inline">\(\gamma=0.1\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Set parameters</span>
<span class="co"># Proportion in each compartment: Susceptible 0.999, Infected 0.001, Recovered 0</span>
init &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">S =</span> <span class="fl">0.999</span>, <span class="dt">I =</span> <span class="fl">0.001</span>, <span class="dt">R =</span> <span class="fl">0.0</span>)
<span class="co"># beta: infection parameter; gamma: recovery parameter</span>
parameters &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">beta =</span> <span class="fl">0.075</span>, <span class="dt">gamma =</span> <span class="fl">0.1</span>)
<span class="co"># Time frame</span>
times &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">300</span>, <span class="dt">by =</span> <span class="dv">1</span>)

<span class="co"># Solve using ode (General Solver for Ordinary Differential Equations)</span>
out &lt;-<span class="st"> </span><span class="kw">ode</span>(<span class="dt">y =</span> init, <span class="dt">times =</span> times, <span class="dt">func =</span> sir, <span class="dt">parms =</span> parameters)
<span class="co"># change to data frame</span>
out &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(out)</code></pre></div>
<p>Figure <a href="modeling.html#fig:sim2">8.6</a> shows the evolution of the prevalence rate.</p>
<div class="figure" style="text-align: center"><span id="fig:sim2"></span>
<img src="bookdown-demo_files/figure-html/sim2-1.png" alt="Simulation example 1." width="100%" />
<p class="caption">
Figure 8.6: Simulation example 1.
</p>
</div>
</div>
<div id="an-sir-model-with-births-and-deaths" class="section level3">
<h3><span class="header-section-number">8.2.3</span> An SIR model with births and deaths</h3>
<p>We have omitted births and deaths in our description of epidemic models because the time scale of an epidemic is generally much shorter than the demographic time scale. In effect, we have used a time scale on which the number of births and deaths in unit time is negligible. However, there are diseases that are endemic in many parts of the world and that cause millions of deaths each year. To model a disease that may be endemic, we need to think on a longer time scale and include births and deaths.</p>
<div class="figure" style="text-align: center"><span id="fig:SIRbd"></span>
<img src="figures/SIRBD.png" alt="An SIR model with birth and death." width="75%" />
<p class="caption">
Figure 8.7: An SIR model with birth and death.
</p>
</div>
<p>We consider the following SIR model with births and deaths:</p>
<span class="math display">\[\begin{eqnarray*}
\frac{dS(t)}{dt}&amp; = &amp;\mu\{N - S(t)\} - \beta I(t)\frac{S(t)}{N}, \\
\frac{dI(t)}{dt}&amp; = &amp;\beta I(t)\frac{S(t)}{N} - (\mu + \gamma)I(t), \\
\frac{dR(t)}{dt}&amp; = &amp;\gamma I(t) - \mu R(t), 
\end{eqnarray*}\]</span>
<p>where <span class="math inline">\(\beta\)</span> is the effective contact rate, and <span class="math display">\[
  \beta \propto \left(\frac{\mathrm{infection}}{\mathrm{contact}} \right) \times \left(\frac{\mathrm{contact}}{\mathrm{time}}\right),  
\]</span> i.e., (probability of transmission given a contact between a susceptible and an infectious individual) <span class="math inline">\(\times\)</span> (average rate of contact between susceptible and infected individuals).</p>
<ul>
<li><p><span class="math inline">\(\mu\)</span> is the birth/death rate;</p></li>
<li><p><span class="math inline">\(\gamma\)</span> is the removal rate, and <span class="math inline">\(\gamma^{-1}\)</span> is the average infectious period.</p></li>
</ul>
<p>At the early stage of an SIR outbreak, when <span class="math inline">\(S(t) \approx N\)</span>, the number of infected individuals <span class="math inline">\(I(t)\)</span> is approximated by <span class="math display">\[
I(t) \approx I_0 \exp \{(\beta - \gamma - \mu) t\} = I_0 \exp \{(R_0 - 1)(\gamma + \mu)t\}, 
\]</span> where <span class="math inline">\(R_0 = \beta/(\gamma + \mu)\)</span>, <span class="math inline">\(I_0\)</span> is the number of infectious people at time <span class="math inline">\(0\)</span>, <span class="math inline">\(\gamma^{-1}\)</span> is the infectious period and <span class="math inline">\(\mu^{-1}\)</span> is the host lifespan.</p>
<p>An epidemic occurs if the number of infected individuals increases, <span class="math display">\[
\beta I \frac{S}{N} - (\mu + \gamma)I&gt;0 \Rightarrow \beta - (\mu + \gamma)&gt;0 \Rightarrow  R_0&gt;1.
\]</span></p>
</div>
<div id="sir-parameter-estimation" class="section level3">
<h3><span class="header-section-number">8.2.4</span> SIR parameter estimation</h3>
<ol style="list-style-type: decimal">
<li>Feature match</li>
</ol>
<p>At the early stage of an SIR outbreak, when <span class="math inline">\(S(t) \approx N\)</span>, the number of infected individuals <span class="math inline">\(I(t)\)</span> is approximated by <span class="math display">\[
I(t) \approx I_0 \exp \{(\beta - \gamma - \mu) t\} = I_0 \exp \{(R_0 - 1)(\gamma + \mu)t\},
\]</span> where <span class="math inline">\(R_0\)</span>, <span class="math inline">\(I_0\)</span> is the number of infectious people at time <span class="math inline">\(0\)</span>, <span class="math inline">\(\gamma^{-1}\)</span> is the infectious period and <span class="math inline">\(\mu^{-1}\)</span> is the host lifespan. It implies we can obtain a cheap and cheerful estimate of <span class="math inline">\(R_0\)</span> by a simple linear regression.</p>
<ol start="2" style="list-style-type: decimal">
<li>Least squares</li>
</ol>
<p>The method of least squares gives us a way to quantify the discrepancy between the data and a model's predictions. We can then search over all possible values of a model's parameters to find the parameters that minimize this discrepancy.</p>
<p>Let <span class="math inline">\(\mu = 0\)</span>, for a given <span class="math inline">\((\beta, \gamma)\)</span>, we denote <span class="math inline">\(I(t;\beta, \gamma) = I(t)\)</span> and <span class="math display">\[
  (\widehat{\beta}, \widehat{\gamma}) = \arg\min_{(\beta, \gamma)}\sum_{j = 1}^{n} \{I(t_j;\beta, \gamma) - Y_j\}^2, 
\]</span> where <span class="math inline">\(Y_j\)</span> is the number of observed infected people at time <span class="math inline">\(t_j\)</span>.</p>
<ol start="3" style="list-style-type: decimal">
<li>Maximum likelihood</li>
</ol>
<p>Let <span class="math inline">\(Y_j\)</span> be the observed number of infected case. We can assume <span class="math display">\[
  Y_j \sim \textrm{Poisson}\{pI(t_j;\beta, \gamma, \mu)\}, 
\]</span> where the parameter <span class="math inline">\(p\)</span> reflects a combination of sampling efficiency and the detectability of infections.</p>
</div>
<div id="implementation-of-parameter-estimation-in-r" class="section level3">
<h3><span class="header-section-number">8.2.5</span> Implementation of parameter estimation in R</h3>
<p>Example code for implementing SIR to model the outbreak of measles in Niamey can be found in <a href="https://kingaa.github.io/clim-dis/parest/parest.html#fitting-sir-to-an-epidemic-curve-using-likelihood" class="uri">https://kingaa.github.io/clim-dis/parest/parest.html#fitting-sir-to-an-epidemic-curve-using-likelihood</a>. We mainly show how to use R to find the parameters in SIR model by minimizing the sum of squared errors.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
<span class="kw">library</span>(pomp)
<span class="kw">library</span>(plotly)
<span class="kw">library</span>(slid)</code></pre></div>
<div id="example-1.-outbreak-of-measles-in-niamey" class="section level4">
<h4><span class="header-section-number">8.2.5.1</span> Example 1. Outbreak of measles in Niamey</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">niamey &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;http://kingaa.github.io/clim-dis/parest/niamey.csv&quot;</span>)
<span class="kw">plot_ly</span>(<span class="dt">data =</span> niamey) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">add_trace</span>(<span class="dt">x =</span> <span class="op">~</span>biweek, <span class="dt">y =</span> <span class="op">~</span>measles, <span class="dt">color =</span> <span class="op">~</span>community, 
            <span class="dt">type =</span> <span class="st">&#39;scatter&#39;</span>, <span class="dt">mode =</span> <span class="st">&#39;lines+markers&#39;</span>)</code></pre></div>
<div id="htmlwidget-7fa3c838f1a380a791e6" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-7fa3c838f1a380a791e6">{"x":{"visdat":{"379053315ef":["function () ","plotlyVisDat"]},"cur_data":"379053315ef","attrs":{"379053315ef":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"color":{},"type":"scatter","mode":"lines+markers","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"biweek"},"yaxis":{"domain":[0,1],"automargin":true,"title":"measles"},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],"y":[22,27,64,84,116,172,173,651,786,1041,842,903,745,211,83,11],"type":"scatter","mode":"lines+markers","name":"A","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"line":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],"y":[1,2,7,4,20,38,125,290,519,874,810,702,636,213,71,34],"type":"scatter","mode":"lines+markers","name":"B","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"line":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,null,6,7,8,9,10,11,12,13,14,15,16],"y":[0,0,0,2,null,4,3,20,49,81,116,164,159,33,16,5],"type":"scatter","mode":"lines+markers","name":"C","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"line":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">niameyA &lt;-<span class="st"> </span><span class="kw">pomp</span>(
  <span class="dt">data =</span> <span class="kw">subset</span>(niamey, community <span class="op">==</span><span class="st"> &quot;A&quot;</span>, <span class="dt">select =</span> <span class="op">-</span><span class="st"> </span>community), 
  <span class="dt">times =</span> <span class="st">&quot;biweek&quot;</span>, <span class="dt">t0 =</span> <span class="dv">0</span>, 
  <span class="dt">skeleton =</span> <span class="kw">vectorfield</span>(
    <span class="kw">Csnippet</span>(<span class="st">&quot;</span>
<span class="st">      DS = - Beta*S*I/N;</span>
<span class="st">      DI = Beta*S*I/N - gamma*I;</span>
<span class="st">      DR = gamma*I;&quot;</span>)), 
  <span class="dt">rinit =</span> <span class="kw">Csnippet</span>(<span class="st">&quot;</span>
<span class="st">      S = S_0;</span>
<span class="st">      I = I_0;</span>
<span class="st">      R = N - S_0 - I_0;&quot;</span>), 
  <span class="dt">statenames =</span> <span class="kw">c</span>(<span class="st">&quot;S&quot;</span>, <span class="st">&quot;I&quot;</span>, <span class="st">&quot;R&quot;</span>), 
  <span class="dt">paramnames =</span> <span class="kw">c</span>(<span class="st">&quot;Beta&quot;</span>, <span class="st">&quot;gamma&quot;</span>, <span class="st">&quot;N&quot;</span>, <span class="st">&quot;S_0&quot;</span>, <span class="st">&quot;I_0&quot;</span>))</code></pre></div>
<p>If we assume all the other parameters are known, one simple option to find optimal <span class="math inline">\(beta\)</span> would be grid searching a value that minimizes the sum of squared error (SSE), which is the difference between the fitted infection curve with given <span class="math inline">\(beta\)</span> compared to the true observations.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sse &lt;-<span class="st"> </span><span class="cf">function</span> (params) {
  x &lt;-<span class="st"> </span><span class="kw">trajectory</span>(niameyA, <span class="dt">params =</span> params)
  discrep &lt;-<span class="st"> </span>x[<span class="st">&quot;I&quot;</span>, , ] <span class="op">-</span><span class="st"> </span><span class="kw">obs</span>(niameyA)
  <span class="kw">sum</span>(discrep<span class="op">^</span><span class="dv">2</span>)
}
<span class="co"># assume gamma = 1 is known</span>
<span class="co"># grid search for beta</span>
f1 &lt;-<span class="st"> </span><span class="cf">function</span> (beta) {
  params &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">Beta =</span> beta, <span class="dt">gamma =</span> <span class="dv">1</span>, <span class="dt">N =</span> <span class="dv">50000</span>, <span class="dt">S_0 =</span> <span class="dv">10000</span>, <span class="dt">I_0 =</span> <span class="dv">10</span>)
  <span class="kw">sse</span>(params)
}
beta &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">40</span>, <span class="dt">by =</span> <span class="fl">0.5</span>)
SSE &lt;-<span class="st"> </span><span class="kw">sapply</span>(beta, f1)

<span class="kw">plot</span>(beta, SSE, <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>)
beta.hat1 &lt;-<span class="st"> </span>beta[<span class="kw">which.min</span>(SSE)]
<span class="kw">abline</span>(<span class="dt">v =</span> beta.hat1, <span class="dt">lty =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-138-1.png" width="672" /></p>
<p>Next, we plugin the estimated <span class="math inline">\(\hat{\beta}\)</span> to the process and visualize the fitted curve for <span class="math inline">\(I(t)\)</span> compared to the observed path.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">coef</span>(niameyA) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">Beta =</span> beta.hat1, <span class="dt">gamma =</span> <span class="dv">1</span>, <span class="dt">N =</span> <span class="dv">50000</span>, <span class="dt">S_0 =</span> <span class="dv">10000</span>, <span class="dt">I_0 =</span> <span class="dv">10</span>)
x1 &lt;-<span class="st"> </span><span class="kw">trajectory</span>(niameyA, <span class="dt">format =</span> <span class="st">&quot;data.frame&quot;</span>)
sir.fit.df &lt;-<span class="st"> </span><span class="kw">left_join</span>(<span class="kw">as.data.frame</span>(niameyA), x1, <span class="dt">by =</span> <span class="st">&#39;biweek&#39;</span>)

<span class="kw">plot_ly</span>(<span class="dt">data =</span> sir.fit.df) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">add_trace</span>(<span class="dt">x =</span> <span class="op">~</span>biweek, <span class="dt">y =</span> <span class="op">~</span>measles, <span class="dt">type =</span> <span class="st">&#39;scatter&#39;</span>, 
            <span class="dt">mode =</span> <span class="st">&#39;lines+markers&#39;</span>, <span class="dt">name =</span> <span class="st">&#39;data&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">add_trace</span>(<span class="dt">x =</span> <span class="op">~</span>biweek, <span class="dt">y =</span> <span class="op">~</span>I, <span class="dt">type =</span> <span class="st">&#39;scatter&#39;</span>, 
            <span class="dt">mode =</span> <span class="st">&#39;lines+markers&#39;</span>, <span class="dt">name =</span> <span class="st">&#39;fitted&#39;</span>)</code></pre></div>
<div id="htmlwidget-a1f8908703d9dcb7b9d6" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-a1f8908703d9dcb7b9d6">{"x":{"visdat":{"379069c64de1":["function () ","plotlyVisDat"]},"cur_data":"379069c64de1","attrs":{"379069c64de1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines+markers","name":"data","inherit":true},"379069c64de1.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines+markers","name":"fitted","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"biweek"},"yaxis":{"domain":[0,1],"automargin":true,"title":"measles"},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],"y":[22,27,64,84,116,172,173,651,786,1041,842,903,745,211,83,11],"type":"scatter","mode":"lines+markers","name":"data","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],"y":[18.1924706862004,32.9386799065054,59.126185831892,104.520495185121,179.911627331567,296.187948097761,454.622086419532,631.179916138036,771.988848115918,822.412895561083,769.493419720646,646.607070630367,501.014885187571,366.476661585129,257.70125215327,176.484390248392],"type":"scatter","mode":"lines+markers","name":"fitted","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>However, this grid-search approach won't perform well when we have more than one parameter. In that case, we can use the <code>optim</code> function instead.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f2 &lt;-<span class="st"> </span><span class="cf">function</span> (par) {
  params &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">Beta=</span>par[<span class="dv">1</span>],<span class="dt">gamma=</span>par[<span class="dv">2</span>],<span class="dt">N=</span><span class="dv">50000</span>,<span class="dt">S_0=</span><span class="dv">10000</span>,<span class="dt">I_0=</span>par[<span class="dv">3</span>])
  <span class="kw">sse</span>(params)
}
fit2 &lt;-<span class="st"> </span><span class="kw">optim</span>(<span class="dt">fn=</span>f2,<span class="dt">par=</span><span class="kw">c</span>(<span class="dv">8</span>,<span class="dv">1</span>,<span class="dv">10</span>))
fit2</code></pre></div>
<pre><code>## $par
## [1] 9.892048 1.150991 1.042747
## 
## $value
## [1] 164836.4
## 
## $counts
## function gradient 
##      253       NA 
## 
## $convergence
## [1] 0
## 
## $message
## NULL</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">beta.hat2 &lt;-<span class="st"> </span>fit2<span class="op">$</span>par[<span class="dv">1</span>]
gamma.hat2 &lt;-<span class="st"> </span>fit2<span class="op">$</span>par[<span class="dv">2</span>]
I_<span class="fl">0.</span>hat2 &lt;-<span class="st"> </span>fit2<span class="op">$</span>par[<span class="dv">3</span>]
<span class="kw">coef</span>(niameyA) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">Beta =</span> beta.hat2, <span class="dt">gamma =</span> gamma.hat2, <span class="dt">N =</span> <span class="dv">50000</span>, <span class="dt">S_0 =</span> <span class="dv">10000</span>, <span class="dt">I_0 =</span> I_<span class="fl">0.</span>hat2)
x2 &lt;-<span class="st"> </span><span class="kw">trajectory</span>(niameyA, <span class="dt">format =</span> <span class="st">&quot;data.frame&quot;</span>)
sir.fit.df &lt;-<span class="st"> </span><span class="kw">left_join</span>(<span class="kw">as.data.frame</span>(niameyA), x2, <span class="dt">by =</span> <span class="st">&#39;biweek&#39;</span>)

<span class="kw">plot_ly</span>(<span class="dt">data =</span> sir.fit.df) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">add_trace</span>(<span class="dt">x =</span> <span class="op">~</span>biweek, <span class="dt">y =</span> <span class="op">~</span>measles, <span class="dt">type =</span> <span class="st">&#39;scatter&#39;</span>, 
            <span class="dt">mode =</span> <span class="st">&#39;lines+markers&#39;</span>, <span class="dt">name =</span> <span class="st">&#39;data&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">add_trace</span>(<span class="dt">x =</span> <span class="op">~</span>biweek, <span class="dt">y =</span> <span class="op">~</span>I, <span class="dt">type =</span> <span class="st">&#39;scatter&#39;</span>, 
            <span class="dt">mode =</span> <span class="st">&#39;lines+markers&#39;</span>, <span class="dt">name =</span> <span class="st">&#39;fitted&#39;</span>)</code></pre></div>
<div id="htmlwidget-74ea716d51b84e4af9b3" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-74ea716d51b84e4af9b3">{"x":{"visdat":{"379039541ccc":["function () ","plotlyVisDat"]},"cur_data":"379039541ccc","attrs":{"379039541ccc":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines+markers","name":"data","inherit":true},"379039541ccc.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines+markers","name":"fitted","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"biweek"},"yaxis":{"domain":[0,1],"automargin":true,"title":"measles"},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],"y":[22,27,64,84,116,172,173,651,786,1041,842,903,745,211,83,11],"type":"scatter","mode":"lines+markers","name":"data","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],"y":[2.38453623343713,5.4475298081341,12.4170094779248,28.1585490082853,63.1233954443215,137.937937405317,285.525377847117,531.680315914184,828.832798168307,1018.56396027569,981.66089209138,778.892931882737,541.912753728272,347.715427417774,212.694889900041,126.545242960492],"type":"scatter","mode":"lines+markers","name":"fitted","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>Another way to fit the model is using likelihood. Note that the model can be simplified a little bit by defining <span class="math inline">\(b = \beta/N\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">niameyA2 &lt;-<span class="st"> </span><span class="kw">pomp</span>(
  <span class="dt">data=</span><span class="kw">subset</span>(niamey,community<span class="op">==</span><span class="st">&quot;A&quot;</span>,<span class="dt">select=</span><span class="op">-</span>community),
  <span class="dt">times=</span><span class="st">&quot;biweek&quot;</span>,<span class="dt">t0=</span><span class="dv">0</span>,
  <span class="dt">skeleton=</span><span class="kw">vectorfield</span>(
    <span class="kw">Csnippet</span>(<span class="st">&quot;</span>
<span class="st">      double incidence;</span>
<span class="st">      incidence = b*S*I;</span>
<span class="st">      DS = -incidence;</span>
<span class="st">      DI = incidence-gamma*I;&quot;</span>)),
  <span class="dt">rinit=</span><span class="kw">Csnippet</span>(<span class="st">&quot;</span>
<span class="st">      S = S_0;</span>
<span class="st">      I = I_0;&quot;</span>),
  <span class="dt">paramnames=</span><span class="kw">c</span>(<span class="st">&quot;b&quot;</span>,<span class="st">&quot;gamma&quot;</span>,<span class="st">&quot;S_0&quot;</span>,<span class="st">&quot;I_0&quot;</span>),
  <span class="dt">statenames=</span><span class="kw">c</span>(<span class="st">&quot;S&quot;</span>,<span class="st">&quot;I&quot;</span>))

loglik.normal &lt;-<span class="st"> </span><span class="cf">function</span> (params) {
  x &lt;-<span class="st"> </span><span class="kw">trajectory</span>(niameyA2,<span class="dt">params=</span>params)
  <span class="kw">sum</span>(<span class="kw">dnorm</span>(<span class="dt">x=</span><span class="kw">obs</span>(niameyA2),<span class="dt">mean=</span>x[<span class="st">&quot;I&quot;</span>,,],
            <span class="dt">sd=</span>params[<span class="st">&quot;sigma&quot;</span>],<span class="dt">log=</span><span class="ot">TRUE</span>))
}

f3 &lt;-<span class="st"> </span><span class="cf">function</span> (b) {
  params &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">S_0=</span><span class="dv">10000</span>,<span class="dt">I_0=</span><span class="dv">10</span>,<span class="dt">gamma=</span><span class="dv">1</span>,<span class="dt">b=</span>b,<span class="dt">sigma=</span><span class="dv">1</span>)
  <span class="kw">loglik.normal</span>(params)
}

b &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">0</span>,<span class="dt">to=</span><span class="fl">0.001</span>,<span class="dt">by=</span><span class="fl">0.00002</span>)
ll &lt;-<span class="st"> </span><span class="kw">sapply</span>(b,f3)

<span class="kw">plot</span>(b,ll,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">ylab=</span><span class="kw">expression</span>(<span class="kw">log</span>(L)))
b.hat &lt;-<span class="st"> </span>b[<span class="kw">which.max</span>(ll)]
<span class="kw">abline</span>(<span class="dt">v=</span>b.hat,<span class="dt">lty=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-141-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">coef</span>(niameyA2) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">S_0=</span><span class="dv">10000</span>,<span class="dt">I_0=</span><span class="dv">10</span>,<span class="dt">gamma=</span><span class="dv">1</span>,<span class="dt">b=</span>b.hat,<span class="dt">sigma=</span><span class="dv">1</span>)
x &lt;-<span class="st"> </span><span class="kw">trajectory</span>(niameyA2, <span class="dt">format =</span> <span class="st">&quot;data.frame&quot;</span>)
sir.fit.df &lt;-<span class="st"> </span><span class="kw">left_join</span>(<span class="kw">as.data.frame</span>(niameyA2), x, <span class="dt">by =</span> <span class="st">&#39;biweek&#39;</span>)

<span class="kw">plot_ly</span>(<span class="dt">data =</span> sir.fit.df) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">add_trace</span>(<span class="dt">x =</span> <span class="op">~</span>biweek, <span class="dt">y =</span> <span class="op">~</span>measles, <span class="dt">type =</span> <span class="st">&#39;scatter&#39;</span>, 
            <span class="dt">mode =</span> <span class="st">&#39;lines+markers&#39;</span>, <span class="dt">name =</span> <span class="st">&#39;data&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">add_trace</span>(<span class="dt">x =</span> <span class="op">~</span>biweek, <span class="dt">y =</span> <span class="op">~</span>I, <span class="dt">type =</span> <span class="st">&#39;scatter&#39;</span>, 
            <span class="dt">mode =</span> <span class="st">&#39;lines+markers&#39;</span>, <span class="dt">name =</span> <span class="st">&#39;fitted&#39;</span>)</code></pre></div>
<div id="htmlwidget-ffa959e546912c754c21" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-ffa959e546912c754c21">{"x":{"visdat":{"379060c7caab":["function () ","plotlyVisDat"]},"cur_data":"379060c7caab","attrs":{"379060c7caab":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines+markers","name":"data","inherit":true},"379060c7caab.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines+markers","name":"fitted","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"biweek"},"yaxis":{"domain":[0,1],"automargin":true,"title":"measles"},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],"y":[22,27,64,84,116,172,173,651,786,1041,842,903,745,211,83,11],"type":"scatter","mode":"lines+markers","name":"data","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],"y":[18.1924706862004,32.9386799065053,59.126185831892,104.520495185121,179.911627331567,296.187948097761,454.62208641953,631.179916138031,771.98884811592,822.412895561085,769.493419720649,646.607070630371,501.014885187571,366.476661585124,257.701252153275,176.48439024841],"type":"scatter","mode":"lines+markers","name":"fitted","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>Besides a Normal distribution, it is also possible to choose other random compenent, for example, a Poisson distribution.</p>
</div>
<div id="example-2.-covid-19" class="section level4">
<h4><span class="header-section-number">8.2.5.2</span> Example 2. COVID-19</h4>
<p>In the COVID-19 case, the situation becomes slightly more complicated due to the unsatisfying data quality in terms of active cases and recovered cases. Therefore, we modify the algorithm to find the parameters that minimize the distance between the curve of fitted active cases (<span class="math inline">\(I\)</span>) plus removed compartment <span class="math inline">\(R\)</span> and the cumulative positive COVID-19 cases time series. If we use the data observed since the beginning of the pandemic, it is reasonable to set the initial value <span class="math inline">\(I_{0}\)</span> to be 1 and focusing on the estimation of other parameters. However, if we choose a different training period, for example, the most recent 60 days, it is possible the initial value of active cases <span class="math inline">\(I_{0}\)</span> may be unobserved or calculated inaccurately. Therefore, the initial value can also be treated as a parameter and estimated based on collected data. In this case, an optimizing function such as <code>optim()</code> might be preferred than grid search. Here is an example of implementing SIR model to fit the spread of COVID-19 in Los Angeles, California.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">&quot;I.county&quot;</span>)
<span class="kw">data</span>(<span class="st">&quot;pop.county&quot;</span>)
<span class="co"># the row storing the data for Los Angeles</span>
i &lt;-<span class="st"> </span><span class="kw">which</span>(I.county<span class="op">$</span>County <span class="op">==</span><span class="st"> &#39;Orange&#39;</span> <span class="op">&amp;</span><span class="st"> </span>I.county<span class="op">$</span>State <span class="op">==</span><span class="st"> &#39;California&#39;</span>) 
N0 &lt;-<span class="st"> </span>pop.county <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(County <span class="op">==</span><span class="st"> &#39;Orange County&#39;</span> <span class="op">&amp;</span><span class="st"> </span>State <span class="op">==</span><span class="st"> &#39;California&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">pull</span>(population)
est.h &lt;-<span class="st"> </span><span class="dv">60</span>
pred.h &lt;-<span class="st"> </span><span class="dv">12</span>
date.start &lt;-<span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&#39;2020-10-01&#39;</span>)
dates.train &lt;-<span class="st"> </span>date.start <span class="op">+</span><span class="st"> </span><span class="dv">0</span><span class="op">:</span>(est.h <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="co"># training period</span>
dates.test &lt;-<span class="st"> </span>date.start <span class="op">+</span><span class="st"> </span>est.h <span class="op">+</span><span class="st"> </span><span class="dv">0</span><span class="op">:</span>(pred.h <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="co"># testing period</span>
dates.all &lt;-<span class="st"> </span>date.start <span class="op">+</span><span class="st"> </span><span class="dv">0</span><span class="op">:</span>(est.h <span class="op">+</span><span class="st"> </span>pred.h <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)
P.train &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Date =</span> <span class="dv">0</span><span class="op">:</span>(est.h <span class="op">-</span><span class="st"> </span><span class="dv">1</span>), 
                      <span class="dt">P_cases =</span> <span class="kw">as.numeric</span>(I.county[i, 
                      <span class="kw">paste0</span>(<span class="st">&#39;X&#39;</span>, <span class="kw">as.character</span>(dates.train, 
                                               <span class="dt">format =</span> <span class="st">&#39;%Y.%m.%d&#39;</span>))]))
P.all &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Date =</span> <span class="dv">0</span><span class="op">:</span>(est.h <span class="op">+</span><span class="st"> </span>pred.h <span class="op">-</span><span class="st"> </span><span class="dv">1</span>), 
                    <span class="dt">P_cases =</span> <span class="kw">as.numeric</span>(I.county[i, 
                    <span class="kw">paste0</span>(<span class="st">&#39;X&#39;</span>, <span class="kw">as.character</span>(dates.all, 
                                             <span class="dt">format =</span> <span class="st">&#39;%Y.%m.%d&#39;</span>))]))</code></pre></div>
<p>Now we define a <code>pomp</code> object encoding the model and the data and a loss function <code>SSE</code> that evaluate the loss function value based on the simulated trajectories with given parameters.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">process.tmp &lt;-<span class="st"> </span><span class="kw">pomp</span>(
  <span class="dt">data =</span> P.train, 
  <span class="dt">times =</span> <span class="st">&quot;Date&quot;</span>, <span class="dt">t0 =</span> <span class="dv">0</span>, 
  <span class="dt">skeleton =</span> <span class="kw">vectorfield</span>(
    <span class="kw">Csnippet</span>(<span class="st">&quot;</span>
<span class="st">               DS = - Beta*S*I/N;</span>
<span class="st">               DI = Beta*S*I/N - gamma*I;</span>
<span class="st">               DR = gamma*I;&quot;</span>)), 
  <span class="dt">rinit =</span> <span class="kw">Csnippet</span>(<span class="st">&quot;</span>
<span class="st">                   S = S_0;</span>
<span class="st">                   I = I_0;</span>
<span class="st">                   R = N - S_0 - I_0;&quot;</span>), 
  <span class="dt">statenames =</span> <span class="kw">c</span>(<span class="st">&quot;S&quot;</span>, <span class="st">&quot;I&quot;</span>, <span class="st">&quot;R&quot;</span>), 
  <span class="dt">paramnames =</span> <span class="kw">c</span>(<span class="st">&quot;Beta&quot;</span>, <span class="st">&quot;gamma&quot;</span>, <span class="st">&quot;N&quot;</span>, <span class="st">&quot;S_0&quot;</span>, <span class="st">&quot;I_0&quot;</span>))


sse &lt;-<span class="st"> </span><span class="cf">function</span> (params) {
  x &lt;-<span class="st"> </span><span class="kw">trajectory</span>(process.tmp, <span class="dt">params =</span> params)
  discrep &lt;-<span class="st"> </span>x[<span class="st">&quot;I&quot;</span>, , ] <span class="op">+</span><span class="st"> </span>x[<span class="st">&quot;R&quot;</span>, , ] <span class="op">-</span><span class="st"> </span><span class="kw">obs</span>(process.tmp)
  <span class="kw">sum</span>(discrep<span class="op">^</span><span class="dv">2</span>)
}</code></pre></div>
<p>Next, we can find the parameters that minimize the SSE using <code>optim</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># set initial value of the process</span>
S0 &lt;-<span class="st"> </span>N0 <span class="op">-</span><span class="st"> </span>P.train<span class="op">$</span>P_cases[<span class="dv">1</span>]
<span class="co"># assume that the removal rate is known  </span>
R.rate &lt;-<span class="st"> </span><span class="fl">0.05</span>
f1 &lt;-<span class="st"> </span><span class="cf">function</span> (par) {
  params &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">Beta =</span> par[<span class="dv">2</span>], <span class="dt">gamma =</span> R.rate, <span class="dt">N =</span> N0, 
              <span class="dt">S_0 =</span> S0, <span class="dt">I_0 =</span> par[<span class="dv">1</span>])
  <span class="kw">sse</span>(params)
}
<span class="co"># initial value for parameters</span>
beta0 &lt;-<span class="st"> </span><span class="fl">0.07</span>
I0 &lt;-<span class="st"> </span><span class="dv">1000</span>

fit1 &lt;-<span class="st"> </span><span class="kw">optim</span>(<span class="dt">fn =</span> f1, <span class="dt">par =</span> <span class="kw">c</span>(I0, beta0))

I0.hat1 &lt;-<span class="st"> </span>fit1<span class="op">$</span>par[<span class="dv">1</span>]
beta.hat1 &lt;-<span class="st"> </span>fit1<span class="op">$</span>par[<span class="dv">2</span>]
process.tmp1 &lt;-<span class="st"> </span>process.tmp
pomp<span class="op">::</span><span class="kw">coef</span>(process.tmp1) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">Beta =</span> beta.hat1, <span class="dt">gamma =</span> R.rate, 
                              <span class="dt">N =</span> N0, <span class="dt">S_0 =</span> S0, <span class="dt">I_0 =</span> I0.hat1)
x1 &lt;-<span class="st"> </span><span class="kw">trajectory</span>(process.tmp1, <span class="dt">times =</span> <span class="dv">0</span><span class="op">:</span>(est.h <span class="op">+</span><span class="st"> </span>pred.h <span class="op">-</span><span class="st"> </span><span class="dv">1</span>), 
                 <span class="dt">format =</span> <span class="st">&quot;data.frame&quot;</span>)

valid.df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Date =</span> dates.all, 
                       <span class="dt">P_cases =</span> P.all<span class="op">$</span>P_cases, 
                       <span class="dt">SIR_P =</span> x1<span class="op">$</span>I <span class="op">+</span><span class="st"> </span>x1<span class="op">$</span>R, 
                       <span class="dt">type =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&#39;fitted&#39;</span>, est.h), 
                                <span class="kw">rep</span>(<span class="st">&#39;predicted&#39;</span>, pred.h)))
<span class="co"># Visualization of fitting</span>
<span class="kw">plot_ly</span>(<span class="dt">data =</span> valid.df) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">add_trace</span>(<span class="dt">x =</span> <span class="op">~</span>Date, <span class="dt">y =</span> <span class="op">~</span>P_cases, <span class="dt">type =</span> <span class="st">&#39;scatter&#39;</span>, 
            <span class="dt">mode =</span> <span class="st">&#39;lines+markers&#39;</span>, <span class="dt">name =</span> <span class="st">&#39;infected cases&#39;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">add_trace</span>(<span class="dt">x =</span> <span class="op">~</span>Date, <span class="dt">y =</span> <span class="op">~</span>SIR_P, <span class="dt">symbol =</span> <span class="op">~</span>type, 
            <span class="dt">mode =</span> <span class="st">&#39;lines+markers&#39;</span>)</code></pre></div>
<pre><code>## No trace type specified:
##   Based on info supplied, a &#39;scatter&#39; trace seems appropriate.
##   Read more about this trace type -&gt; https://plotly.com/r/reference/#scatter</code></pre>
<div id="htmlwidget-3b05f752f490ca7c31a6" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-3b05f752f490ca7c31a6">{"x":{"visdat":{"37907391af9a":["function () ","plotlyVisDat"]},"cur_data":"37907391af9a","attrs":{"37907391af9a":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines+markers","name":"infected cases","inherit":true},"37907391af9a.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"symbol":{},"mode":"lines+markers","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"Date"},"yaxis":{"domain":[0,1],"automargin":true,"title":"P_cases"},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"x":["2020-10-01","2020-10-02","2020-10-03","2020-10-04","2020-10-05","2020-10-06","2020-10-07","2020-10-08","2020-10-09","2020-10-10","2020-10-11","2020-10-12","2020-10-13","2020-10-14","2020-10-15","2020-10-16","2020-10-17","2020-10-18","2020-10-19","2020-10-20","2020-10-21","2020-10-22","2020-10-23","2020-10-24","2020-10-25","2020-10-26","2020-10-27","2020-10-28","2020-10-29","2020-10-30","2020-10-31","2020-11-01","2020-11-02","2020-11-03","2020-11-04","2020-11-05","2020-11-06","2020-11-07","2020-11-08","2020-11-09","2020-11-10","2020-11-11","2020-11-12","2020-11-13","2020-11-14","2020-11-15","2020-11-16","2020-11-17","2020-11-18","2020-11-19","2020-11-20","2020-11-21","2020-11-22","2020-11-23","2020-11-24","2020-11-25","2020-11-26","2020-11-27","2020-11-28","2020-11-29","2020-11-30","2020-12-01","2020-12-02","2020-12-03","2020-12-04","2020-12-05","2020-12-06","2020-12-07","2020-12-08","2020-12-09","2020-12-10","2020-12-11"],"y":[53909,54118,54357,54640,54760,54898,55042,55183,55345,55531,55775,55892,56070,56283,56436,56587,56672,56868,57071,57373,57635,57848,58010,58326,58573,58725,58980,59213,59442,59718,59882,60115,60298,60604,60841,61112,61421,61743,62255,62563,62830,63165,63460,64058,64586,65225,65605,65957,66585,67167,68336,69142,69694,71116,71953,73152,73152,75095,76761,77819,78553,79343,80551,81653,82887,84853,86878,88842,90513,93126,94647,97302],"type":"scatter","mode":"lines+markers","name":"infected cases","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020-10-01","2020-10-02","2020-10-03","2020-10-04","2020-10-05","2020-10-06","2020-10-07","2020-10-08","2020-10-09","2020-10-10","2020-10-11","2020-10-12","2020-10-13","2020-10-14","2020-10-15","2020-10-16","2020-10-17","2020-10-18","2020-10-19","2020-10-20","2020-10-21","2020-10-22","2020-10-23","2020-10-24","2020-10-25","2020-10-26","2020-10-27","2020-10-28","2020-10-29","2020-10-30","2020-10-31","2020-11-01","2020-11-02","2020-11-03","2020-11-04","2020-11-05","2020-11-06","2020-11-07","2020-11-08","2020-11-09","2020-11-10","2020-11-11","2020-11-12","2020-11-13","2020-11-14","2020-11-15","2020-11-16","2020-11-17","2020-11-18","2020-11-19","2020-11-20","2020-11-21","2020-11-22","2020-11-23","2020-11-24","2020-11-25","2020-11-26","2020-11-27","2020-11-28","2020-11-29"],"y":[53909,54009.2552750134,54113.4744244432,54221.816962004,54334.4454304548,54451.5283109777,54573.2408641612,54699.7658370901,54831.2929194766,54968.0190793871,55110.149026347,55257.8954693519,55411.4794319153,55571.130563171,55737.0874588343,55909.598010549,56088.9197618366,56275.3202752049,56469.0775140908,56670.4802381592,56879.8284127951,57097.4336336661,57323.6195665706,57558.7224028964,57803.0913312861,58057.0890260199,58321.0921526058,58595.4918910899,58880.6944776069,59177.1217646944,59485.2118009038,59805.4194302428,60138.2169119883,60484.0945614129,60843.5614119656,61217.1458994517,61605.3965687496,62008.8828036037,62428.1955800214,62863.9482438,63316.7773126925,63787.3433037144,64276.3315860726,64784.4532601812,65312.4460632049,65861.0753015453,66431.1348106531,67023.4479425161,67638.868581131,68278.2821862225,68942.6068654227,69632.7944750656,70349.8317496881,71094.7414602583,71868.5836010717,72672.4566051707,73507.4985880464,74374.8886192743,75275.8480216233,76211.6416970478],"mode":"lines+markers","type":"scatter","name":"fitted","marker":{"color":"rgba(255,127,14,1)","symbol":"circle","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020-11-30","2020-12-01","2020-12-02","2020-12-03","2020-12-04","2020-12-05","2020-12-06","2020-12-07","2020-12-08","2020-12-09","2020-12-10","2020-12-11"],"y":[77183.5794788361,78193.0175090379,79241.3596401301,80330.0588597007,81460.6187367423,82634.5948879341,83853.5964620613,85119.2876406556,86433.3891518857,87797.6797959629,89213.9979787582,90684.2432501455],"mode":"lines+markers","type":"scatter","name":"predicted","marker":{"color":"rgba(44,160,44,1)","symbol":"triangle-up","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"line":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="basic-reproduction-number" class="section level3">
<h3><span class="header-section-number">8.2.6</span> Basic Reproduction Number</h3>
<p>A key concept is the <em>basic reproduction number</em> (<span class="math inline">\(R_0\)</span>), which is defined as the expected number of secondary cases produced by a single (typical) infection in a completely susceptible population.</p>
<p>It is important to note that <span class="math inline">\(R_0\)</span> is a dimensionless number and not a rate, and <span class="math display">\[
  R_0 \propto \left(\frac{\mathrm{infection}}{\mathrm{contact}} \right) \times \left(\frac{\mathrm{contact}}{\mathrm{time}}\right) \times \left(\frac{\mathrm{time}}{\mathrm{infection}}\right).
\]</span></p>
<ul>
<li><p>If <span class="math inline">\(R_0 &lt; 1\)</span> the disease dies out, while if <span class="math inline">\(R_0 &gt; 1\)</span> the disease becomes endemic.</p></li>
<li><p>For the SIR model, when <span class="math inline">\(S(t) \approx N\)</span>, <span class="math inline">\(R_0 = \frac{\beta}{\gamma + \mu}\)</span>.</p></li>
<li><p>For the SEIR model, when <span class="math inline">\(S(t) \approx N\)</span>, <span class="math inline">\(R_0 = \frac{\sigma}{\sigma + \mu} \times \frac{\beta}{\gamma + \mu}\)</span>.</p></li>
<li><p>If <span class="math inline">\(R_0 &lt; 1\)</span>, each existing infection causes less than one new infection. In this case, the disease will decline and eventually die out.</p></li>
<li><p>If <span class="math inline">\(R_0 = 1\)</span>, each existing infection causes one new infection. The disease will stay alive and stable, but there won’t be an outbreak or an epidemic.</p></li>
<li><p>If <span class="math inline">\(R_0 &gt; 1\)</span>, each existing infection causes more than one new infection. The disease will be transmitted between people, and there may be an outbreak or epidemic.</p></li>
</ul>
<p><strong>COVID-19 <span class="math inline">\(R_0\)</span></strong></p>
<ul>
<li><p>The <span class="math inline">\(R_0\)</span> for SAS-Cov-2 is a median of 5.7, according to a study published online in Emerging Infectious Diseases. That’s about double an earlier R0 estimate of 2.2 to 2.7</p></li>
<li><p>Here, 5.7 means that one person with COVID-19can potentially transmit the coronavirus to 5 to 6 people, rather than the 2 to 3 researchers originally thought.</p></li>
<li><p>With an <span class="math inline">\(R_0\)</span> of 5.7, at least 82% of the population needs to be immune to COVID-19to stop its transmission through vaccination and herd immunity.</p></li>
</ul>
</div>
<div id="seir-model" class="section level3">
<h3><span class="header-section-number">8.2.7</span> SEIR Model</h3>
<ul>
<li>Consider the SIR model in a population of size <span class="math inline">\(N\)</span>, and note that <span class="math inline">\(N = S(t) + I(t) + R(t)\)</span>.</li>
</ul>
<span class="math display">\[\begin{eqnarray*}
\frac{dS(t)}{dt}&amp; = &amp;\mu\{N - S(t)\} - \beta I(t)\frac{S(t)}{N} + \omega R, \\
\frac{dE(t)}{dt}&amp; = &amp;\beta I(t)\frac{S(t)}{N} - (\mu + \sigma)I(t), \\
\frac{dI(t)}{dt}&amp; = &amp;\sigma E(t) - (\mu + \gamma)I(t), \\
\frac{dR(t)}{dt}&amp; = &amp;\gamma I(t) - (\mu + \omega) R(t), 
\end{eqnarray*}\]</span>
<ul>
<li><span class="math inline">\(\omega^{-1}\)</span> is the average duration of immunity;</li>
<li><span class="math inline">\(\sigma^{-1}\)</span> is the average latent period.</li>
</ul>
</div>
<div id="herd-immunity" class="section level3">
<h3><span class="header-section-number">8.2.8</span> Herd Immunity</h3>
<p>In order to prevent a disease from becoming endemic it is necessary to reduce the basic reproduction number <span class="math inline">\(R_0\)</span> below one. This may sometimes be achieved by immunization.</p>
<ul>
<li><p>If a fraction <span class="math inline">\(p\)</span> of the newborn members per unit time of the population is successfully immunized, the effect is to replace <span class="math inline">\(N\)</span> by <span class="math inline">\(N(1 - p)\)</span>, and thus to reduce the basic reproduction number to <span class="math inline">\(R_0(1 - p)\)</span>. The requirement <span class="math inline">\(R_0(1 - p) &lt; 1\)</span> gives <span class="math inline">\(1 - p &lt; 1/R_0\)</span>, or <span class="math display">\[
  p &gt; 1 - \frac{1}{R_0}.
\]</span></p></li>
<li><p>A population is said to have <strong>herd immunity</strong> if a large enough fraction has been immunized to assure that the disease cannot become endemic.</p></li>
<li><p>The only disease for which this has actually been achieved worldwide is smallpox for which <span class="math inline">\(R_0\)</span> is approximately 5, so that 80% immunization does provide herd immunity, and rinderpest, a cattle disease.</p></li>
<li><p>For measles, epidemiological data in the United States indicate that <span class="math inline">\(R_0\)</span> for rural populations ranges from 5.4 to 6.3, requiring vaccination of 81.5% to 84.1% of the population. In urban areas <span class="math inline">\(R_0\)</span> ranges from 8.3 to 13.0, requiring vaccination of 88.0% to 92.3% percent of the population.</p></li>
</ul>
<p>Exercise 1: consider loss functions other than SSE. Exercise 2: implement model-fitting procedure using SEIR model. Exercise 3: try to use other optimizers, such as <tt><code>nlminb</code>&lt;&gt;. Exercise 4: Poisson random component?</p>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-Brauer:etal:08">
<p>Brauer, Fred, Pauline van den Driessche, and Jianhong Wu. 2008. <em>Mathematical Epidemiology</em>. Vol. 1945. Springer.</p>
</div>
<div id="ref-Breiman:01">
<p>Breiman, Leo. 2001. “Statistical Modeling: The Two Cultures.” <em>Statist. Sci.</em> 16 (3): 199–231. doi:<a href="https://doi.org/10.1214/ss/1009213726">10.1214/ss/1009213726</a>.</p>
</div>
<div id="ref-brockwell2002introduction">
<p>Brockwell, Peter J., and Richard A. Davis. 2016. <em>Introduction to Time Series and Forecasting</em>. Third. Springer Texts in Statistics. Springer, [Cham]. doi:<a href="https://doi.org/10.1007/978-3-319-29854-2">10.1007/978-3-319-29854-2</a>.</p>
</div>
<div id="ref-Daley:Gani:01">
<p>Daley, Daryl J, and Joe Gani. 2001. <em>Epidemic Modelling: An Introduction</em>. Cambridge Studies in Mathematical Biology. Cambridge University Press. doi:<a href="https://doi.org/10.1017/CBO9780511608834">10.1017/CBO9780511608834</a>.</p>
</div>
<div id="ref-Held:etal:20">
<p>Held, Leonhard, Niel Hens, Philip D O’Neill, and Jacco Wallinga. 2020. <em>Handbook of Infectious Disease Data Analysis</em>. New York: Chapman; Hall/CRC. doi:<a href="https://doi.org/s10.1201/9781315222912">s10.1201/9781315222912</a>.</p>
</div>
<div id="ref-jewell2003statistics">
<p>Jewell, Nicholas P. 2003. <em>Statistics for Epidemiology</em>. CRC Press. doi:<a href="https://doi.org/10.1093/ije/dyh293">10.1093/ije/dyh293</a>.</p>
</div>
<div id="ref-Keeling:Rohani:08">
<p>Keeling, Matt J., and Pejman Rohani. 2008. <em>Modeling Infectious Diseases in Humans and Animals</em>. Princeton University Press. doi:<a href="https://doi.org/10.2307/j.ctvcm4gk0">10.2307/j.ctvcm4gk0</a>.</p>
</div>
<div id="ref-Lawson:etal:16">
<p>Lawson, Andrew B, Sudipto Banerjee, Robert P Haining, and María Dolores Ugarte. 2016. <em>Handbook of Spatial Epidemiology</em>. CRC Press. doi:<a href="https://doi.org/10.1201/b19470">10.1201/b19470</a>.</p>
</div>
<div id="ref-lessler2016mechanistic">
<p>Lessler, Justin, and Derek AT Cummings. 2016. “Mechanistic Models of Infectious Disease and Their Impact on Public Health.” <em>American Journal of Epidemiology</em> 183 (5). Oxford University Press: 415–22. doi:<a href="https://doi.org/10.1093/aje/kww021">10.1093/aje/kww021</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="map.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/07-modeling.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
