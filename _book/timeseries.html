<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 Time Series Analysis of Infectious Disease Data | Statistical Learning of Infectious Disease Data Analytics</title>
  <meta name="description" content="The use of statistical models to understand infectious disease dynamics has a very rich history in epidemiology. This book introduces modern statistical models and state-of-the-art learning methods to analyze infectious disease data. Many of the key approaches, examples and case studies will be presented. The primary emphasis will be interpretation, inference and hands-on data analyses. This course also provides practical concepts and R computing skills to perform infectious disease data analysis and visualization." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 Time Series Analysis of Infectious Disease Data | Statistical Learning of Infectious Disease Data Analytics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="The use of statistical models to understand infectious disease dynamics has a very rich history in epidemiology. This book introduces modern statistical models and state-of-the-art learning methods to analyze infectious disease data. Many of the key approaches, examples and case studies will be presented. The primary emphasis will be interpretation, inference and hands-on data analyses. This course also provides practical concepts and R computing skills to perform infectious disease data analysis and visualization." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 Time Series Analysis of Infectious Disease Data | Statistical Learning of Infectious Disease Data Analytics" />
  
  <meta name="twitter:description" content="The use of statistical models to understand infectious disease dynamics has a very rich history in epidemiology. This book introduces modern statistical models and state-of-the-art learning methods to analyze infectious disease data. Many of the key approaches, examples and case studies will be presented. The primary emphasis will be interpretation, inference and hands-on data analyses. This course also provides practical concepts and R computing skills to perform infectious disease data analysis and visualization." />
  

<meta name="author" content="Lily Wang" />


<meta name="date" content="2021-02-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="regression.html"/>
<link rel="next" href="NN.html"/>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.3.9000/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#data-sets-used-in-labs-and-exercises"><i class="fa fa-check"></i><b>1.1</b> Data Sets Used in Labs and Exercises</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>1.2</b> Acknowledgements</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#about-the-author"><i class="fa fa-check"></i><b>1.3</b> About the Author</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#aims-and-scope-of-this-book"><i class="fa fa-check"></i><b>2.1</b> Aims and Scope of This Book</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#the-structure-of-this-book"><i class="fa fa-check"></i><b>2.2</b> The Structure of This Book</a><ul>
<li class="chapter" data-level="2.2.1" data-path="intro.html"><a href="intro.html#infectious-disease-data"><i class="fa fa-check"></i><b>2.2.1</b> Infectious disease data</a></li>
<li class="chapter" data-level="2.2.2" data-path="intro.html"><a href="intro.html#basic-characteristics-of-the-infection-process"><i class="fa fa-check"></i><b>2.2.2</b> Basic characteristics of the infection process</a></li>
<li class="chapter" data-level="2.2.3" data-path="intro.html"><a href="intro.html#data-visualization"><i class="fa fa-check"></i><b>2.2.3</b> Data visualization</a></li>
<li class="chapter" data-level="2.2.4" data-path="intro.html"><a href="intro.html#modeling-and-forecasting"><i class="fa fa-check"></i><b>2.2.4</b> Modeling and Forecasting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="dplyr.html"><a href="dplyr.html"><i class="fa fa-check"></i><b>3</b> Data Wrangling with <code>dplyr</code> and <code>tidyr</code></a><ul>
<li class="chapter" data-level="3.1" data-path="dplyr.html"><a href="dplyr.html#learning-dplyr"><i class="fa fa-check"></i><b>3.1</b> Learning <code>dplyr</code></a><ul>
<li class="chapter" data-level="3.1.1" data-path="dplyr.html"><a href="dplyr.html#tibbles"><i class="fa fa-check"></i><b>3.1.1</b> Tibbles</a></li>
<li class="chapter" data-level="3.1.2" data-path="dplyr.html"><a href="dplyr.html#import-data"><i class="fa fa-check"></i><b>3.1.2</b> Import data</a></li>
<li class="chapter" data-level="3.1.3" data-path="dplyr.html"><a href="dplyr.html#common-dplyr-functions"><i class="fa fa-check"></i><b>3.1.3</b> Common <code>dplyr</code> functions</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="dplyr.html"><a href="dplyr.html#selecting-columns-and-filtering-rows"><i class="fa fa-check"></i><b>3.2</b> Selecting Columns and Filtering Rows</a><ul>
<li class="chapter" data-level="3.2.1" data-path="dplyr.html"><a href="dplyr.html#subset-variables-columns"><i class="fa fa-check"></i><b>3.2.1</b> Subset Variables (Columns)</a></li>
<li class="chapter" data-level="3.2.2" data-path="dplyr.html"><a href="dplyr.html#subset-observations-rows"><i class="fa fa-check"></i><b>3.2.2</b> Subset Observations (Rows)</a></li>
<li class="chapter" data-level="3.2.3" data-path="dplyr.html"><a href="dplyr.html#pipes"><i class="fa fa-check"></i><b>3.2.3</b> Pipes</a></li>
<li class="chapter" data-level="3.2.4" data-path="dplyr.html"><a href="dplyr.html#select-and-order-top-n-entries-by-group-if-grouped-data."><i class="fa fa-check"></i><b>3.2.4</b> Select and order top n entries (by group if grouped data).</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="dplyr.html"><a href="dplyr.html#make-new-variables-mutate"><i class="fa fa-check"></i><b>3.3</b> Make New Variables: Mutate</a></li>
<li class="chapter" data-level="3.4" data-path="dplyr.html"><a href="dplyr.html#summarize-data"><i class="fa fa-check"></i><b>3.4</b> Summarize Data</a></li>
<li class="chapter" data-level="3.5" data-path="dplyr.html"><a href="dplyr.html#combine-data-sets"><i class="fa fa-check"></i><b>3.5</b> Combine Data Sets</a><ul>
<li class="chapter" data-level="3.5.1" data-path="dplyr.html"><a href="dplyr.html#the-join-family"><i class="fa fa-check"></i><b>3.5.1</b> The join family</a></li>
<li class="chapter" data-level="3.5.2" data-path="dplyr.html"><a href="dplyr.html#toy-examples-with-joins"><i class="fa fa-check"></i><b>3.5.2</b> Toy examples with joins</a></li>
<li class="chapter" data-level="3.5.3" data-path="dplyr.html"><a href="dplyr.html#practice-with-joins-for-real-data"><i class="fa fa-check"></i><b>3.5.3</b> Practice with joins for real data</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="dplyr.html"><a href="dplyr.html#reshaping-data"><i class="fa fa-check"></i><b>3.6</b> Reshaping Data</a><ul>
<li class="chapter" data-level="3.6.1" data-path="dplyr.html"><a href="dplyr.html#from-wide-to-long"><i class="fa fa-check"></i><b>3.6.1</b> From wide to long</a></li>
<li class="chapter" data-level="3.6.2" data-path="dplyr.html"><a href="dplyr.html#from-long-to-wide"><i class="fa fa-check"></i><b>3.6.2</b> From long to wide</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="dplyr.html"><a href="dplyr.html#exercises"><i class="fa fa-check"></i><b>3.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>4</b> Data Visualization with ggplot2</a><ul>
<li class="chapter" data-level="4.1" data-path="ggplot2.html"><a href="ggplot2.html#introduction"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="ggplot2.html"><a href="ggplot2.html#types-of-variables-and-preparation"><i class="fa fa-check"></i><b>4.2</b> Types of Variables and Preparation</a><ul>
<li class="chapter" data-level="4.2.1" data-path="ggplot2.html"><a href="ggplot2.html#types-of-variables"><i class="fa fa-check"></i><b>4.2.1</b> Types of Variables</a></li>
<li class="chapter" data-level="4.2.2" data-path="ggplot2.html"><a href="ggplot2.html#rules-for-graph-designing"><i class="fa fa-check"></i><b>4.2.2</b> Rules for Graph Designing</a></li>
<li class="chapter" data-level="4.2.3" data-path="ggplot2.html"><a href="ggplot2.html#installing-packages-and-loading-data"><i class="fa fa-check"></i><b>4.2.3</b> Installing packages and loading data</a></li>
<li class="chapter" data-level="4.2.4" data-path="ggplot2.html"><a href="ggplot2.html#your-first-scatterplot"><i class="fa fa-check"></i><b>4.2.4</b> Your first scatterplot</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="ggplot2.html"><a href="ggplot2.html#position-scales-and-axes"><i class="fa fa-check"></i><b>4.3</b> Position Scales and Axes</a><ul>
<li class="chapter" data-level="4.3.1" data-path="ggplot2.html"><a href="ggplot2.html#change-the-labels-of-the-axis-using-xlab-and-ylab"><i class="fa fa-check"></i><b>4.3.1</b> Change the labels of the axis using <code>xlab()</code> and <code>ylab()</code></a></li>
<li class="chapter" data-level="4.3.2" data-path="ggplot2.html"><a href="ggplot2.html#change-the-range-of-the-axis-using-xlim-and-ylim"><i class="fa fa-check"></i><b>4.3.2</b> Change the range of the axis using <code>xlim()</code> and <code>ylim()</code></a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="ggplot2.html"><a href="ggplot2.html#color-scales-and-size-of-geom_points"><i class="fa fa-check"></i><b>4.4</b> Color Scales and Size of <code>geom_points()</code></a><ul>
<li class="chapter" data-level="4.4.1" data-path="ggplot2.html"><a href="ggplot2.html#change-the-color-of-all-points"><i class="fa fa-check"></i><b>4.4.1</b> Change the color of all points</a></li>
<li class="chapter" data-level="4.4.2" data-path="ggplot2.html"><a href="ggplot2.html#color-the-observations-by-the-value-of-a-feature"><i class="fa fa-check"></i><b>4.4.2</b> Color the observations by the value of a feature</a></li>
<li class="chapter" data-level="4.4.3" data-path="ggplot2.html"><a href="ggplot2.html#change-the-color-palette"><i class="fa fa-check"></i><b>4.4.3</b> Change the color palette</a></li>
<li class="chapter" data-level="4.4.4" data-path="ggplot2.html"><a href="ggplot2.html#change-the-size-by-the-value-of-a-feature"><i class="fa fa-check"></i><b>4.4.4</b> Change the size by the value of a feature</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="ggplot2.html"><a href="ggplot2.html#individual-geoms"><i class="fa fa-check"></i><b>4.5</b> Individual geoms</a><ul>
<li class="chapter" data-level="4.5.1" data-path="ggplot2.html"><a href="ggplot2.html#histogram"><i class="fa fa-check"></i><b>4.5.1</b> Histogram</a></li>
<li class="chapter" data-level="4.5.2" data-path="ggplot2.html"><a href="ggplot2.html#bar-chart"><i class="fa fa-check"></i><b>4.5.2</b> Bar chart</a></li>
<li class="chapter" data-level="4.5.3" data-path="ggplot2.html"><a href="ggplot2.html#default-bar-chart"><i class="fa fa-check"></i><b>4.5.3</b> Default bar chart</a></li>
<li class="chapter" data-level="4.5.4" data-path="ggplot2.html"><a href="ggplot2.html#bar-chart-with-assigned-value"><i class="fa fa-check"></i><b>4.5.4</b> Bar chart with assigned value</a></li>
<li class="chapter" data-level="4.5.5" data-path="ggplot2.html"><a href="ggplot2.html#legend"><i class="fa fa-check"></i><b>4.5.5</b> Legend</a></li>
<li class="chapter" data-level="4.5.6" data-path="ggplot2.html"><a href="ggplot2.html#boxplots-jittering-and-violin-plots"><i class="fa fa-check"></i><b>4.5.6</b> Boxplots, jittering and violin plots</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="ggplot2.html"><a href="ggplot2.html#collective-geoms"><i class="fa fa-check"></i><b>4.6</b> Collective geoms</a><ul>
<li class="chapter" data-level="4.6.1" data-path="ggplot2.html"><a href="ggplot2.html#smoother"><i class="fa fa-check"></i><b>4.6.1</b> Smoother</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="ggplot2.html"><a href="ggplot2.html#time-series"><i class="fa fa-check"></i><b>4.7</b> Time Series</a><ul>
<li class="chapter" data-level="4.7.1" data-path="ggplot2.html"><a href="ggplot2.html#basic-line-plots"><i class="fa fa-check"></i><b>4.7.1</b> Basic line plots</a></li>
<li class="chapter" data-level="4.7.2" data-path="ggplot2.html"><a href="ggplot2.html#add-a-second-line"><i class="fa fa-check"></i><b>4.7.2</b> Add a second line</a></li>
<li class="chapter" data-level="4.7.3" data-path="ggplot2.html"><a href="ggplot2.html#add-ribbons"><i class="fa fa-check"></i><b>4.7.3</b> Add ribbons</a></li>
<li class="chapter" data-level="4.7.4" data-path="ggplot2.html"><a href="ggplot2.html#adjust-the-scale-of-time-axis"><i class="fa fa-check"></i><b>4.7.4</b> Adjust the scale of time axis</a></li>
<li class="chapter" data-level="4.7.5" data-path="ggplot2.html"><a href="ggplot2.html#add-annotations"><i class="fa fa-check"></i><b>4.7.5</b> Add annotations</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="ggplot2.html"><a href="ggplot2.html#maps"><i class="fa fa-check"></i><b>4.8</b> Maps</a><ul>
<li class="chapter" data-level="4.8.1" data-path="ggplot2.html"><a href="ggplot2.html#making-a-base-map"><i class="fa fa-check"></i><b>4.8.1</b> Making a base map</a></li>
<li class="chapter" data-level="4.8.2" data-path="ggplot2.html"><a href="ggplot2.html#customizing-choropleth-map"><i class="fa fa-check"></i><b>4.8.2</b> Customizing <code>choropleth</code> map</a></li>
<li class="chapter" data-level="4.8.3" data-path="ggplot2.html"><a href="ggplot2.html#overlay-polygon-maps"><i class="fa fa-check"></i><b>4.8.3</b> Overlay polygon maps</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="ggplot2.html"><a href="ggplot2.html#arranging-plots"><i class="fa fa-check"></i><b>4.9</b> Arranging Plots</a><ul>
<li class="chapter" data-level="4.9.1" data-path="ggplot2.html"><a href="ggplot2.html#facet"><i class="fa fa-check"></i><b>4.9.1</b> Facet</a></li>
<li class="chapter" data-level="4.9.2" data-path="ggplot2.html"><a href="ggplot2.html#combining-plots-using-patchwork-package"><i class="fa fa-check"></i><b>4.9.2</b> Combining plots using <code>patchwork</code> package</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="ggplot2.html"><a href="ggplot2.html#output"><i class="fa fa-check"></i><b>4.10</b> Output</a><ul>
<li class="chapter" data-level="4.10.1" data-path="ggplot2.html"><a href="ggplot2.html#save-in-figure-format"><i class="fa fa-check"></i><b>4.10.1</b> Save in figure format</a></li>
<li class="chapter" data-level="4.10.2" data-path="ggplot2.html"><a href="ggplot2.html#save-in-rds-format"><i class="fa fa-check"></i><b>4.10.2</b> Save in RDS format</a></li>
</ul></li>
<li class="chapter" data-level="4.11" data-path="ggplot2.html"><a href="ggplot2.html#exercises-1"><i class="fa fa-check"></i><b>4.11</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="plotly.html"><a href="plotly.html"><i class="fa fa-check"></i><b>5</b> Interactive Visualization</a><ul>
<li class="chapter" data-level="5.1" data-path="plotly.html"><a href="plotly.html#an-introduction"><i class="fa fa-check"></i><b>5.1</b> An Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="plotly.html"><a href="plotly.html#creating-plotly-objects"><i class="fa fa-check"></i><b>5.2</b> Creating Plotly Objects</a><ul>
<li class="chapter" data-level="5.2.1" data-path="plotly.html"><a href="plotly.html#using-plot_ly-to-create-a-plotly-object"><i class="fa fa-check"></i><b>5.2.1</b> Using <code>plot_ly()</code> to create a plotly object</a></li>
<li class="chapter" data-level="5.2.2" data-path="plotly.html"><a href="plotly.html#use-dplyr-verbs-to-modify-data"><i class="fa fa-check"></i><b>5.2.2</b> Use <code>dplyr</code> verbs to modify data</a></li>
<li class="chapter" data-level="5.2.3" data-path="plotly.html"><a href="plotly.html#using-ggplotly-to-create-a-plotly-object"><i class="fa fa-check"></i><b>5.2.3</b> Using <code>ggplotly()</code> to create a <code>plotly</code> object</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="plotly.html"><a href="plotly.html#scatterplots-and-line-plots"><i class="fa fa-check"></i><b>5.3</b> Scatterplots and Line Plots</a><ul>
<li class="chapter" data-level="5.3.1" data-path="plotly.html"><a href="plotly.html#make-a-scatterplot"><i class="fa fa-check"></i><b>5.3.1</b> Make a scatterplot</a></li>
<li class="chapter" data-level="5.3.2" data-path="plotly.html"><a href="plotly.html#markers"><i class="fa fa-check"></i><b>5.3.2</b> Markers</a></li>
<li class="chapter" data-level="5.3.3" data-path="plotly.html"><a href="plotly.html#a-single-time-series-plot"><i class="fa fa-check"></i><b>5.3.3</b> A single time series plot</a></li>
<li class="chapter" data-level="5.3.4" data-path="plotly.html"><a href="plotly.html#hover-text-and-template"><i class="fa fa-check"></i><b>5.3.4</b> Hover text and template</a></li>
<li class="chapter" data-level="5.3.5" data-path="plotly.html"><a href="plotly.html#multiple-time-series-plots"><i class="fa fa-check"></i><b>5.3.5</b> Multiple time series plots</a></li>
<li class="chapter" data-level="5.3.6" data-path="plotly.html"><a href="plotly.html#more-features-about-the-lines"><i class="fa fa-check"></i><b>5.3.6</b> More features about the lines</a></li>
<li class="chapter" data-level="5.3.7" data-path="plotly.html"><a href="plotly.html#add-ribbons-1"><i class="fa fa-check"></i><b>5.3.7</b> Add ribbons</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="plotly.html"><a href="plotly.html#pie-charts"><i class="fa fa-check"></i><b>5.4</b> Pie Charts</a></li>
<li class="chapter" data-level="5.5" data-path="plotly.html"><a href="plotly.html#animation"><i class="fa fa-check"></i><b>5.5</b> Animation</a><ul>
<li class="chapter" data-level="5.5.1" data-path="plotly.html"><a href="plotly.html#an-animation-of-the-evolution-of-infected-vs.-death-count"><i class="fa fa-check"></i><b>5.5.1</b> An animation of the evolution of infected vs. death count</a></li>
<li class="chapter" data-level="5.5.2" data-path="plotly.html"><a href="plotly.html#an-animation-of-the-state-level-time-series-plot-of-infected-count"><i class="fa fa-check"></i><b>5.5.2</b> An animation of the state-level time series plot of infected count</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="plotly.html"><a href="plotly.html#saving-html"><i class="fa fa-check"></i><b>5.6</b> Saving HTML</a><ul>
<li class="chapter" data-level="5.6.1" data-path="plotly.html"><a href="plotly.html#save-as-a-standalone-html-file"><i class="fa fa-check"></i><b>5.6.1</b> Save as a standalone HTML file</a></li>
<li class="chapter" data-level="5.6.2" data-path="plotly.html"><a href="plotly.html#save-as-non-selfcontained-html-file"><i class="fa fa-check"></i><b>5.6.2</b> Save as non-selfcontained HTML file</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="plotly.html"><a href="plotly.html#exercises-2"><i class="fa fa-check"></i><b>5.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="shiny.html"><a href="shiny.html"><i class="fa fa-check"></i><b>6</b> R Shiny</a><ul>
<li class="chapter" data-level="6.1" data-path="shiny.html"><a href="shiny.html#embedding-plotly-in-shiny"><i class="fa fa-check"></i><b>6.1</b> Embedding plotly in Shiny</a><ul>
<li class="chapter" data-level="6.1.1" data-path="shiny.html"><a href="shiny.html#your-first-shiny-app"><i class="fa fa-check"></i><b>6.1.1</b> Your first shiny app</a></li>
<li class="chapter" data-level="6.1.2" data-path="shiny.html"><a href="shiny.html#useful-input-widgets"><i class="fa fa-check"></i><b>6.1.2</b> Useful input widgets</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="shiny.html"><a href="shiny.html#rendering-plotly-inside-shiny"><i class="fa fa-check"></i><b>6.2</b> Rendering plotly Inside Shiny</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="map.html"><a href="map.html"><i class="fa fa-check"></i><b>7</b> Interactive Geospatial Visualization</a><ul>
<li class="chapter" data-level="7.1" data-path="map.html"><a href="map.html#an-introduction-to-leaflet"><i class="fa fa-check"></i><b>7.1</b> An Introduction to Leaflet</a><ul>
<li class="chapter" data-level="7.1.1" data-path="map.html"><a href="map.html#features-and-installation"><i class="fa fa-check"></i><b>7.1.1</b> Features and installation</a></li>
<li class="chapter" data-level="7.1.2" data-path="map.html"><a href="map.html#basic-usage"><i class="fa fa-check"></i><b>7.1.2</b> Basic Usage</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="map.html"><a href="map.html#the-data-object"><i class="fa fa-check"></i><b>7.2</b> The Data Object</a></li>
<li class="chapter" data-level="7.3" data-path="map.html"><a href="map.html#choropleth-map"><i class="fa fa-check"></i><b>7.3</b> Choropleth map</a><ul>
<li class="chapter" data-level="7.3.1" data-path="map.html"><a href="map.html#create-a-base-map"><i class="fa fa-check"></i><b>7.3.1</b> Create a base map</a></li>
<li class="chapter" data-level="7.3.2" data-path="map.html"><a href="map.html#color-the-map"><i class="fa fa-check"></i><b>7.3.2</b> Color the map</a></li>
<li class="chapter" data-level="7.3.3" data-path="map.html"><a href="map.html#interactive-map"><i class="fa fa-check"></i><b>7.3.3</b> Interactive map</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="map.html"><a href="map.html#legend-1"><i class="fa fa-check"></i><b>7.4</b> Legend</a><ul>
<li class="chapter" data-level="7.4.1" data-path="map.html"><a href="map.html#classification-schemes"><i class="fa fa-check"></i><b>7.4.1</b> Classification schemes</a></li>
<li class="chapter" data-level="7.4.2" data-path="map.html"><a href="map.html#mapping-variables-to-colors"><i class="fa fa-check"></i><b>7.4.2</b> Mapping variables to colors</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="map.html"><a href="map.html#an-example-of-county-level-map"><i class="fa fa-check"></i><b>7.5</b> An Example of County-level Map</a></li>
<li class="chapter" data-level="7.6" data-path="map.html"><a href="map.html#spot-maps"><i class="fa fa-check"></i><b>7.6</b> Spot Maps</a></li>
<li class="chapter" data-level="7.7" data-path="map.html"><a href="map.html#integrating-leaflet-with-r-shiny"><i class="fa fa-check"></i><b>7.7</b> Integrating Leaflet with R Shiny</a></li>
<li class="chapter" data-level="7.8" data-path="map.html"><a href="map.html#exercises-3"><i class="fa fa-check"></i><b>7.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="modeling.html"><a href="modeling.html"><i class="fa fa-check"></i><b>8</b> Epidemic Modeling</a><ul>
<li class="chapter" data-level="8.1" data-path="modeling.html"><a href="modeling.html#an-introduction-to-epidemic-modeling"><i class="fa fa-check"></i><b>8.1</b> An Introduction to Epidemic Modeling</a></li>
<li class="chapter" data-level="8.2" data-path="modeling.html"><a href="modeling.html#compartment-models"><i class="fa fa-check"></i><b>8.2</b> Compartment Models</a><ul>
<li class="chapter" data-level="8.2.1" data-path="modeling.html"><a href="modeling.html#a-simple-sis-model-a-model-for-diseases-with-no-immunity"><i class="fa fa-check"></i><b>8.2.1</b> A Simple SIS Model (A Model for Diseases with No Immunity)</a></li>
<li class="chapter" data-level="8.2.2" data-path="modeling.html"><a href="modeling.html#an-sir-model"><i class="fa fa-check"></i><b>8.2.2</b> An SIR Model</a></li>
<li class="chapter" data-level="8.2.3" data-path="modeling.html"><a href="modeling.html#an-sir-model-with-births-and-deaths"><i class="fa fa-check"></i><b>8.2.3</b> An SIR model with births and deaths</a></li>
<li class="chapter" data-level="8.2.4" data-path="modeling.html"><a href="modeling.html#sir-parameter-estimation"><i class="fa fa-check"></i><b>8.2.4</b> SIR parameter estimation</a></li>
<li class="chapter" data-level="8.2.5" data-path="modeling.html"><a href="modeling.html#implementation-of-parameter-estimation-in-r"><i class="fa fa-check"></i><b>8.2.5</b> Implementation of parameter estimation in R</a></li>
<li class="chapter" data-level="8.2.6" data-path="modeling.html"><a href="modeling.html#basic-reproduction-number"><i class="fa fa-check"></i><b>8.2.6</b> Basic Reproduction Number</a></li>
<li class="chapter" data-level="8.2.7" data-path="modeling.html"><a href="modeling.html#seir-model"><i class="fa fa-check"></i><b>8.2.7</b> SEIR Model</a></li>
<li class="chapter" data-level="8.2.8" data-path="modeling.html"><a href="modeling.html#herd-immunity"><i class="fa fa-check"></i><b>8.2.8</b> Herd Immunity</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>9</b> Regression Modeling</a><ul>
<li class="chapter" data-level="9.1" data-path="regression.html"><a href="regression.html#principles-of-regression-modeling"><i class="fa fa-check"></i><b>9.1</b> Principles of Regression Modeling</a><ul>
<li class="chapter" data-level="9.1.1" data-path="regression.html"><a href="regression.html#linear-regression"><i class="fa fa-check"></i><b>9.1.1</b> Linear regression</a></li>
<li class="chapter" data-level="9.1.2" data-path="regression.html"><a href="regression.html#poisson-regression"><i class="fa fa-check"></i><b>9.1.2</b> Poisson regression</a></li>
<li class="chapter" data-level="9.1.3" data-path="regression.html"><a href="regression.html#logistic-regression"><i class="fa fa-check"></i><b>9.1.3</b> Logistic regression</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="regression.html"><a href="regression.html#area-level-data"><i class="fa fa-check"></i><b>9.2</b> Area-level Data</a></li>
<li class="chapter" data-level="9.3" data-path="regression.html"><a href="regression.html#variable-selection"><i class="fa fa-check"></i><b>9.3</b> Variable Selection</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="timeseries.html"><a href="timeseries.html"><i class="fa fa-check"></i><b>10</b> Time Series Analysis of Infectious Disease Data</a><ul>
<li class="chapter" data-level="10.1" data-path="timeseries.html"><a href="timeseries.html#datasets-and-r-packages"><i class="fa fa-check"></i><b>10.1</b> Datasets and R Packages</a></li>
<li class="chapter" data-level="10.2" data-path="timeseries.html"><a href="timeseries.html#time-series-plots"><i class="fa fa-check"></i><b>10.2</b> Time series plots</a><ul>
<li class="chapter" data-level="10.2.1" data-path="timeseries.html"><a href="timeseries.html#tsibble-objects"><i class="fa fa-check"></i><b>10.2.1</b> “tsibble” objects</a></li>
<li class="chapter" data-level="10.2.2" data-path="timeseries.html"><a href="timeseries.html#working-with-tsibble-objects"><i class="fa fa-check"></i><b>10.2.2</b> Working with “tsibble” objects</a></li>
<li class="chapter" data-level="10.2.3" data-path="timeseries.html"><a href="timeseries.html#drawing-time-series-plots"><i class="fa fa-check"></i><b>10.2.3</b> Drawing time series plots</a></li>
<li class="chapter" data-level="10.2.4" data-path="timeseries.html"><a href="timeseries.html#objectives-of-time-series-analysis"><i class="fa fa-check"></i><b>10.2.4</b> Objectives of Time Series Analysis</a></li>
<li class="chapter" data-level="10.2.5" data-path="timeseries.html"><a href="timeseries.html#autocorrelation"><i class="fa fa-check"></i><b>10.2.5</b> Autocorrelation</a></li>
<li class="chapter" data-level="10.2.6" data-path="timeseries.html"><a href="timeseries.html#autocorrelation-1"><i class="fa fa-check"></i><b>10.2.6</b> Autocorrelation</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="timeseries.html"><a href="timeseries.html#time-series-decomposition"><i class="fa fa-check"></i><b>10.3</b> Time Series Decomposition</a></li>
<li class="chapter" data-level="10.4" data-path="timeseries.html"><a href="timeseries.html#simple-time-series-forecasting-approaches"><i class="fa fa-check"></i><b>10.4</b> Simple Time Series Forecasting Approaches</a><ul>
<li class="chapter" data-level="10.4.1" data-path="timeseries.html"><a href="timeseries.html#average-method"><i class="fa fa-check"></i><b>10.4.1</b> Average method</a></li>
<li class="chapter" data-level="10.4.2" data-path="timeseries.html"><a href="timeseries.html#random-walk-forecasts"><i class="fa fa-check"></i><b>10.4.2</b> Random walk forecasts</a></li>
<li class="chapter" data-level="10.4.3" data-path="timeseries.html"><a href="timeseries.html#seasonal-random-walk-forecasts"><i class="fa fa-check"></i><b>10.4.3</b> Seasonal random walk forecasts</a></li>
<li class="chapter" data-level="10.4.4" data-path="timeseries.html"><a href="timeseries.html#random-walk-with-drift-method"><i class="fa fa-check"></i><b>10.4.4</b> Random walk with drift method</a></li>
<li class="chapter" data-level="10.4.5" data-path="timeseries.html"><a href="timeseries.html#combining-the-forecasting-results"><i class="fa fa-check"></i><b>10.4.5</b> Combining the forecasting results</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="timeseries.html"><a href="timeseries.html#methods-for-estimating-the-trend"><i class="fa fa-check"></i><b>10.5</b> Methods for Estimating the Trend</a></li>
<li class="chapter" data-level="10.6" data-path="timeseries.html"><a href="timeseries.html#arma-models"><i class="fa fa-check"></i><b>10.6</b> ARMA Models</a><ul>
<li class="chapter" data-level="10.6.1" data-path="timeseries.html"><a href="timeseries.html#simple-examples-of-arma-models"><i class="fa fa-check"></i><b>10.6.1</b> Simple Examples of ARMA Models</a></li>
<li class="chapter" data-level="10.6.2" data-path="timeseries.html"><a href="timeseries.html#arima"><i class="fa fa-check"></i><b>10.6.2</b> ARIMA</a></li>
<li class="chapter" data-level="10.6.3" data-path="timeseries.html"><a href="timeseries.html#seasonal-arima-model"><i class="fa fa-check"></i><b>10.6.3</b> Seasonal ARIMA model</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="timeseries.html"><a href="timeseries.html#model-comparison"><i class="fa fa-check"></i><b>10.7</b> Model Comparison</a></li>
<li class="chapter" data-level="10.8" data-path="timeseries.html"><a href="timeseries.html#ensuring-forecasts-stay-within-limits"><i class="fa fa-check"></i><b>10.8</b> Ensuring forecasts stay within limits</a><ul>
<li class="chapter" data-level="10.8.1" data-path="timeseries.html"><a href="timeseries.html#positive-forecasts"><i class="fa fa-check"></i><b>10.8.1</b> Positive forecasts</a></li>
<li class="chapter" data-level="10.8.2" data-path="timeseries.html"><a href="timeseries.html#forecasts-constrained-to-an-interval"><i class="fa fa-check"></i><b>10.8.2</b> Forecasts constrained to an interval</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="timeseries.html"><a href="timeseries.html#prediction-intervals-for-aggregates"><i class="fa fa-check"></i><b>10.9</b> Prediction intervals for aggregates</a></li>
<li class="chapter" data-level="10.10" data-path="timeseries.html"><a href="timeseries.html#exercises-4"><i class="fa fa-check"></i><b>10.10</b> Exercises</a></li>
<li class="chapter" data-level="10.11" data-path="timeseries.html"><a href="timeseries.html#references"><i class="fa fa-check"></i><b>10.11</b> References</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="NN.html"><a href="NN.html"><i class="fa fa-check"></i><b>11</b> Neural Networks</a><ul>
<li class="chapter" data-level="11.1" data-path="NN.html"><a href="NN.html#a-single-neuron"><i class="fa fa-check"></i><b>11.1</b> A Single Neuron</a></li>
<li class="chapter" data-level="11.2" data-path="NN.html"><a href="NN.html#neural-network-structure"><i class="fa fa-check"></i><b>11.2</b> Neural Network Structure</a><ul>
<li class="chapter" data-level="11.2.1" data-path="NN.html"><a href="NN.html#forward-propagation"><i class="fa fa-check"></i><b>11.2.1</b> Forward propagation</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="NN.html"><a href="NN.html#overfitting"><i class="fa fa-check"></i><b>11.3</b> Overfitting</a></li>
<li class="chapter" data-level="11.4" data-path="NN.html"><a href="NN.html#neural-network-auto-regressive-nnar-models"><i class="fa fa-check"></i><b>11.4</b> Neural Network Auto-Regressive (NNAR) models</a></li>
<li class="chapter" data-level="11.5" data-path="NN.html"><a href="NN.html#covid-19-forecasting"><i class="fa fa-check"></i><b>11.5</b> COVID-19 Forecasting</a></li>
<li class="chapter" data-level="11.6" data-path="NN.html"><a href="NN.html#box-cox-transformations"><i class="fa fa-check"></i><b>11.6</b> Box-Cox transformations</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="ensemble.html"><a href="ensemble.html"><i class="fa fa-check"></i><b>12</b> Hybrid Mdels</a><ul>
<li class="chapter" data-level="12.1" data-path="ensemble.html"><a href="ensemble.html#ensembling-time-series-models"><i class="fa fa-check"></i><b>12.1</b> Ensembling Time Series Models</a></li>
<li class="chapter" data-level="12.2" data-path="ensemble.html"><a href="ensemble.html#model-diagnostics"><i class="fa fa-check"></i><b>12.2</b> Model Diagnostics</a></li>
<li class="chapter" data-level="12.3" data-path="ensemble.html"><a href="ensemble.html#forecasting"><i class="fa fa-check"></i><b>12.3</b> Forecasting</a><ul>
<li class="chapter" data-level="12.3.1" data-path="ensemble.html"><a href="ensemble.html#perform-cross-validation-on-a-time-series"><i class="fa fa-check"></i><b>12.3.1</b> Perform cross validation on a time series</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="ensemble.html"><a href="ensemble.html#weights-selection-using-cross-validation"><i class="fa fa-check"></i><b>12.4</b> Weights Selection Using Cross Validation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-1.html"><a href="references-1.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i>Appendix</a></li>
<li class="chapter" data-level="13" data-path="appendix-a.html"><a href="appendix-a.html"><i class="fa fa-check"></i><b>13</b> Appendix A</a><ul>
<li class="chapter" data-level="13.1" data-path="appendix-a.html"><a href="appendix-a.html#r-introduction-and-preliminaries"><i class="fa fa-check"></i><b>13.1</b> R Introduction and Preliminaries</a><ul>
<li class="chapter" data-level="13.1.1" data-path="appendix-a.html"><a href="appendix-a.html#the-r-environment-and-language"><i class="fa fa-check"></i><b>13.1.1</b> The R Environment and Language</a></li>
<li class="chapter" data-level="13.1.2" data-path="appendix-a.html"><a href="appendix-a.html#r-and-statistics"><i class="fa fa-check"></i><b>13.1.2</b> R and Statistics</a></li>
<li class="chapter" data-level="13.1.3" data-path="appendix-a.html"><a href="appendix-a.html#obtaining-r-and-installation"><i class="fa fa-check"></i><b>13.1.3</b> Obtaining R and installation</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="appendix-a.html"><a href="appendix-a.html#starting-r"><i class="fa fa-check"></i><b>13.2</b> Starting R</a><ul>
<li class="chapter" data-level="13.2.1" data-path="appendix-a.html"><a href="appendix-a.html#description-of-three-panels-in-user-interface"><i class="fa fa-check"></i><b>13.2.1</b> Description of three panels in user interface</a></li>
<li class="chapter" data-level="13.2.2" data-path="appendix-a.html"><a href="appendix-a.html#r-help"><i class="fa fa-check"></i><b>13.2.2</b> R help</a></li>
<li class="chapter" data-level="13.2.3" data-path="appendix-a.html"><a href="appendix-a.html#some-mathematical-expressions"><i class="fa fa-check"></i><b>13.2.3</b> Some mathematical expressions</a></li>
<li class="chapter" data-level="13.2.4" data-path="appendix-a.html"><a href="appendix-a.html#r-packages"><i class="fa fa-check"></i><b>13.2.4</b> R Packages</a></li>
<li class="chapter" data-level="13.2.5" data-path="appendix-a.html"><a href="appendix-a.html#creating-a-project-and-setting-working-directory"><i class="fa fa-check"></i><b>13.2.5</b> Creating a project and setting working directory</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="appendix-a.html"><a href="appendix-a.html#exportimport-data"><i class="fa fa-check"></i><b>13.3</b> Export/Import Data</a><ul>
<li class="chapter" data-level="13.3.1" data-path="appendix-a.html"><a href="appendix-a.html#data-export"><i class="fa fa-check"></i><b>13.3.1</b> Data Export</a></li>
<li class="chapter" data-level="13.3.2" data-path="appendix-a.html"><a href="appendix-a.html#data-import"><i class="fa fa-check"></i><b>13.3.2</b> Data Import</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="appendix-b.html"><a href="appendix-b.html"><i class="fa fa-check"></i><b>14</b> Appendix B</a><ul>
<li class="chapter" data-level="14.1" data-path="appendix-b.html"><a href="appendix-b.html#epidemic-data"><i class="fa fa-check"></i><b>14.1</b> Epidemic Data</a><ul>
<li class="chapter" data-level="14.1.1" data-path="appendix-b.html"><a href="appendix-b.html#state-level"><i class="fa fa-check"></i><b>14.1.1</b> State level</a></li>
<li class="chapter" data-level="14.1.2" data-path="appendix-b.html"><a href="appendix-b.html#county-level"><i class="fa fa-check"></i><b>14.1.2</b> County level</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="appendix-b.html"><a href="appendix-b.html#other-factors"><i class="fa fa-check"></i><b>14.2</b> Other Factors</a><ul>
<li class="chapter" data-level="14.2.1" data-path="appendix-b.html"><a href="appendix-b.html#policy-data"><i class="fa fa-check"></i><b>14.2.1</b> Policy Data</a></li>
<li class="chapter" data-level="14.2.2" data-path="appendix-b.html"><a href="appendix-b.html#demographic-characteristics"><i class="fa fa-check"></i><b>14.2.2</b> Demographic Characteristics</a></li>
<li class="chapter" data-level="14.2.3" data-path="appendix-b.html"><a href="appendix-b.html#healthcare-infrastructure"><i class="fa fa-check"></i><b>14.2.3</b> Healthcare Infrastructure</a></li>
<li class="chapter" data-level="14.2.4" data-path="appendix-b.html"><a href="appendix-b.html#socioeconomic-status"><i class="fa fa-check"></i><b>14.2.4</b> Socioeconomic Status</a></li>
<li class="chapter" data-level="14.2.5" data-path="appendix-b.html"><a href="appendix-b.html#environmental-factor"><i class="fa fa-check"></i><b>14.2.5</b> Environmental Factor</a></li>
<li class="chapter" data-level="14.2.6" data-path="appendix-b.html"><a href="appendix-b.html#mobility"><i class="fa fa-check"></i><b>14.2.6</b> Mobility</a></li>
<li class="chapter" data-level="14.2.7" data-path="appendix-b.html"><a href="appendix-b.html#geographic-information"><i class="fa fa-check"></i><b>14.2.7</b> Geographic Information</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="appendix-b.html"><a href="appendix-b.html#data-sets"><i class="fa fa-check"></i><b>14.3</b> Data Sets</a><ul>
<li class="chapter" data-level="14.3.1" data-path="appendix-b.html"><a href="appendix-b.html#chapter-2"><i class="fa fa-check"></i><b>14.3.1</b> Chapter 2</a></li>
<li class="chapter" data-level="14.3.2" data-path="appendix-b.html"><a href="appendix-b.html#chapter-3"><i class="fa fa-check"></i><b>14.3.2</b> Chapter 3</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Learning of Infectious Disease Data Analytics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="timeseries" class="section level1">
<h1><span class="header-section-number">Chapter 10</span> Time Series Analysis of Infectious Disease Data</h1>
<p>Several quantities are of interest in COVID-19 forecasting, such as the timing of and incidence in the peak week, cumulative incidence, and weekly incidence. The policy/decision-makers are also interested in evaluating outbreak size and duration, and employing the epidemic curve to identify the mode of transmission of the disease and measure its prevalence of the disease.</p>
<p>Forecasting goals can also be classified as long-term or short-term forecasts. Long-term disease forecasts can predict COVID-19 peak or severity, while short-term forecasts can be used to guide resource allocation in the short term by local agencies or to anticipate the case burden by hospitals in the coming week; see <span class="citation">Altieri et al. (<a href="#ref-altieri2020curating">2020</a>)</span>. The projection can be made at different resolution levels, for example, national, regional or local. National-level or state-level long-term forecasts are of interest to policymakers regulating intervention strategies and deciding how much funding to allocate for resources. Prediction models with a finer resolution are needed to assess the local risk of COVID-19. Knowing more about the vulnerable communities and the reasons for those communities that are more likely to be infected are crucial for the policy and decision-makers to assist in prevention efforts <span class="citation">(Altieri et al. <a href="#ref-altieri2020curating">2020</a>)</span>.</p>
<p>We provide a predictive analysis of the spread of COVID-19, using the dataset made publicly available online by the Johns Hopkins University. Our main objective is to provide future predictions of the number of infected people for different countries. We use two well-known methods for prediction: time series analysis and neural network.</p>
<div id="datasets-and-r-packages" class="section level2">
<h2><span class="header-section-number">10.1</span> Datasets and R Packages</h2>
<p><strong>Data</strong></p>
<p>The dataset from JHU contains the cumulative number of cases reported daily for different countries. We base our analysis on the state-level time series. For each state, we consider the time-series <span class="math inline">\(y_n\)</span> starting from the day when the first case was reported. Given the current day index <span class="math inline">\(n\)</span>, we predict the number of cases for the day <span class="math inline">\(n + h\)</span> by considering as input the number of cases reported for the past <span class="math inline">\(w\)</span> days, that is, for the days <span class="math inline">\(n-w+1\)</span> to <span class="math inline">\(n\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#install_github(&#39;covid19-dashboard-us/slid&#39;)</span>
<span class="kw">library</span>(slid)
<span class="kw">data</span>(state.long)</code></pre></div>
<p><strong>R Package: <code>fable</code></strong></p>
<p>This tutorial leverages a variety of data sets to illustrate unique time-series features. The data sets are all provided by the <code>fable</code> and <code>slid</code> packages. Furthermore, these packages offer various functions for computing and visualizing basic time series components.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
<span class="kw">library</span>(fable)
<span class="kw">library</span>(tsibble)</code></pre></div>
<p>The R package <code>fable</code> provides a collection of commonly used univariate and multivariate time series forecasting models including exponential smoothing via state space models and automatic ARIMA modelling.</p>
<p>The <a href="https://otexts.com/fpp3/tsibbles.html">Forecasting: Principles and Practices</a> online textbook provides an introduction to time series forecasting using <code>fable</code>.</p>
</div>
<div id="time-series-plots" class="section level2">
<h2><span class="header-section-number">10.2</span> Time series plots</h2>
<p>Time series is a set of observations recorded sequentially. The first thing to do in any time series analysis task is to plot the data. Graphs enable many features of the data to be visualized, including patterns, unusual observations, changes over time, and relationships between variables. The features that are seen in plots of the data must then be incorporated, as much as possible, into the forecasting methods to be used. Just as the type of data determines what forecasting method to use, it also determines what graphs are appropriate. But before we produce graphs, we need to set up our time series in R.</p>
<div id="tsibble-objects" class="section level3">
<h3><span class="header-section-number">10.2.1</span> “tsibble” objects</h3>
<p>A time series can be thought of as a list of numbers, along with some information about what times those numbers were recorded. This information can be stored as a “tsibble” object in R.</p>
<p>Take the <code>state.long</code> data for example,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">state.long</code></pre></div>
<pre><code>## # A tibble: 15,925 x 7
##    State  Region Division      pop DATE       Infected Death
##    &lt;fct&gt;  &lt;fct&gt;  &lt;fct&gt;       &lt;int&gt; &lt;date&gt;        &lt;int&gt; &lt;int&gt;
##  1 Alaba… South  East Sout… 4.89e6 2020-12-11   288775  4086
##  2 Alaba… South  East Sout… 4.89e6 2020-12-10   284922  4034
##  3 Alaba… South  East Sout… 4.89e6 2020-12-09   280187  3985
##  4 Alaba… South  East Sout… 4.89e6 2020-12-08   276665  3940
##  5 Alaba… South  East Sout… 4.89e6 2020-12-07   272228  3891
##  6 Alaba… South  East Sout… 4.89e6 2020-12-06   269877  3888
##  7 Alaba… South  East Sout… 4.89e6 2020-12-05   267589  3876
##  8 Alaba… South  East Sout… 4.89e6 2020-12-04   264199  3831
##  9 Alaba… South  East Sout… 4.89e6 2020-12-03   260359  3776
## 10 Alaba… South  East Sout… 4.89e6 2020-12-02   256828  3711
## # … with 15,915 more rows</code></pre>
<p>We can turn this into a “tsibble” object using the <code>as_tsibble()</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">state.ts &lt;-<span class="st"> </span><span class="kw">as_tsibble</span>(state.long, <span class="dt">key =</span> State) 
## Using `DATE` as index variable.
state.ts
## # A tsibble: 15,925 x 7 [1D]
## # Key:       State [49]
##    State  Region Division      pop DATE       Infected Death
##    &lt;fct&gt;  &lt;fct&gt;  &lt;fct&gt;       &lt;int&gt; &lt;date&gt;        &lt;int&gt; &lt;int&gt;
##  1 Alaba… South  East Sout… 4.89e6 2020-01-22        0     0
##  2 Alaba… South  East Sout… 4.89e6 2020-01-23        0     0
##  3 Alaba… South  East Sout… 4.89e6 2020-01-24        0     0
##  4 Alaba… South  East Sout… 4.89e6 2020-01-25        0     0
##  5 Alaba… South  East Sout… 4.89e6 2020-01-26        0     0
##  6 Alaba… South  East Sout… 4.89e6 2020-01-27        0     0
##  7 Alaba… South  East Sout… 4.89e6 2020-01-28        0     0
##  8 Alaba… South  East Sout… 4.89e6 2020-01-29        0     0
##  9 Alaba… South  East Sout… 4.89e6 2020-01-30        0     0
## 10 Alaba… South  East Sout… 4.89e6 2020-01-31        0     0
## # … with 15,915 more rows</code></pre></div>
<p>The summary above shows that this is a “tsibble” object, which contains 15,925 rows and 7 columns. The object is uniquely identified by the key: <code>State</code>. It informs us that there are separate time series in the “tsibble” for each of the 49 states in the US.</p>
<p>A “tsibble” allows multiple time series to be stored in a single object. The <code>state.long</code> dataset contains the infected count, death count for each mainland state in the US and District of Columbia.</p>
</div>
<div id="working-with-tsibble-objects" class="section level3">
<h3><span class="header-section-number">10.2.2</span> Working with “tsibble” objects</h3>
<p>We have used several functions above to work with “tsibble” objects, including <code>mutate()</code> and <code>select()</code>. To illustrate these further and some other useful functions, we will use the <code>state.ts</code> tsibble created in the above.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">state.ts &lt;-<span class="st"> </span><span class="kw">as_tsibble</span>(state.long, <span class="dt">key =</span> State) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(State) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Infected =</span> Infected<span class="op">/</span><span class="dv">1000</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">YDA_Infected =</span> <span class="kw">lag</span>(Infected, <span class="dt">order_by =</span> DATE)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">YDA_Death =</span> <span class="kw">lag</span>(Death, <span class="dt">order_by =</span> DATE)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Y.Infected =</span> Infected <span class="op">-</span><span class="st"> </span>YDA_Infected) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Y.Death =</span> Death <span class="op">-</span><span class="st"> </span>YDA_Death) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(Y.Infected)) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(Y.Death)) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="kw">c</span>(YDA_Infected, YDA_Death))
## Using `DATE` as index variable.

state.ts 
## # A tsibble: 15,876 x 9 [1D]
## # Key:       State [49]
## # Groups:    State [49]
##    State Region Division    pop DATE       Infected Death
##    &lt;fct&gt; &lt;fct&gt;  &lt;fct&gt;     &lt;int&gt; &lt;date&gt;        &lt;dbl&gt; &lt;int&gt;
##  1 Alab… South  East So… 4.89e6 2020-01-23        0     0
##  2 Alab… South  East So… 4.89e6 2020-01-24        0     0
##  3 Alab… South  East So… 4.89e6 2020-01-25        0     0
##  4 Alab… South  East So… 4.89e6 2020-01-26        0     0
##  5 Alab… South  East So… 4.89e6 2020-01-27        0     0
##  6 Alab… South  East So… 4.89e6 2020-01-28        0     0
##  7 Alab… South  East So… 4.89e6 2020-01-29        0     0
##  8 Alab… South  East So… 4.89e6 2020-01-30        0     0
##  9 Alab… South  East So… 4.89e6 2020-01-31        0     0
## 10 Alab… South  East So… 4.89e6 2020-02-01        0     0
## # … with 15,866 more rows, and 2 more variables:
## #   Y.Infected &lt;dbl&gt;, Y.Death &lt;int&gt;</code></pre></div>
<p>This tsibble use the <code>mutate()</code> to create two extra variables: <code>Y.Infected</code> and <code>Y.Death</code>, which are the daily new infected count and the daily new death count for each state.</p>
<p>We can use the <code>filter()</code> function to extract the data for the state of Florida, for example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Florida.ts &lt;-<span class="st"> </span>state.ts <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(State <span class="op">==</span><span class="st"> &quot;Florida&quot;</span>)</code></pre></div>
<p>Next we can simplify the resulting object by selecting five variables we will need in subsequent analysis.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Florida.ts &lt;-<span class="st"> </span>Florida.ts <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(Infected, Death, Y.Infected, Y.Death)
## Adding missing grouping variables: `State`
Florida.ts
## # A tsibble: 324 x 6 [1D]
## # Key:       State [1]
## # Groups:    State [1]
##    State   Infected Death Y.Infected Y.Death DATE      
##    &lt;fct&gt;      &lt;dbl&gt; &lt;int&gt;      &lt;dbl&gt;   &lt;int&gt; &lt;date&gt;    
##  1 Florida        0     0          0       0 2020-01-23
##  2 Florida        0     0          0       0 2020-01-24
##  3 Florida        0     0          0       0 2020-01-25
##  4 Florida        0     0          0       0 2020-01-26
##  5 Florida        0     0          0       0 2020-01-27
##  6 Florida        0     0          0       0 2020-01-28
##  7 Florida        0     0          0       0 2020-01-29
##  8 Florida        0     0          0       0 2020-01-30
##  9 Florida        0     0          0       0 2020-01-31
## 10 Florida        0     0          0       0 2020-02-01
## # … with 314 more rows</code></pre></div>
<p>Note that the index variable <code>DATE</code> would be returned even if it was not explicitly selected as it is required for a tsibble.</p>
</div>
<div id="drawing-time-series-plots" class="section level3">
<h3><span class="header-section-number">10.2.3</span> Drawing time series plots</h3>
<p>To further examine the data, we now use the <code>autoplot()</code> to draw some time series plot; see Figure <a href="timeseries.html#fig:death1">10.1</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Florida.ts <span class="op">%&gt;%</span>
<span class="kw">autoplot</span>(Y.Death)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:death1"></span>
<img src="bookdown-demo_files/figure-html/death1-1.png" alt="The time series plot of the daily new death count in Florida using the `autoplot()` function." width="672" />
<p class="caption">
Figure 10.1: The time series plot of the daily new death count in Florida using the <code>autoplot()</code> function.
</p>
</div>
<p>We can also use the <code>ggplot()</code> to draw some time series plot. Figure <a href="timeseries.html#fig:death2">10.2</a> shows the time series plot with blue line.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">ggplot</span>(Florida.ts, <span class="kw">aes</span>(<span class="dt">x =</span> DATE, <span class="dt">y =</span> Y.Death)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&#39;Florida daily new death count&#39;</span>) </code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:death2"></span>
<img src="bookdown-demo_files/figure-html/death2-1.png" alt="The time series plot of the daily new death count in Florida using the `ggplot()` function." width="672" />
<p class="caption">
Figure 10.2: The time series plot of the daily new death count in Florida using the <code>ggplot()</code> function.
</p>
</div>
<p>We can draw multiple time series on the same plot. The time series plot shown in Figure <a href="timeseries.html#fig:death3">10.3</a> illusterate the daily new infected and death counts in Florida.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  <span class="kw">ggplot</span>(Florida.ts, <span class="kw">aes</span>(<span class="dt">x =</span> DATE)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> Y.Infected, <span class="dt">colour =</span> <span class="st">&quot;Y.Infected (thousand)&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> Y.Death, <span class="dt">colour =</span> <span class="st">&quot;Y.Death&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Count&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Day&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">colour=</span><span class="kw">guide_legend</span>(<span class="dt">title =</span> <span class="st">&quot;Forecasts&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:death3"></span>
<img src="bookdown-demo_files/figure-html/death3-1.png" alt="The time series plot of the daily new infected and death counts in Florida." width="672" />
<p class="caption">
Figure 10.3: The time series plot of the daily new infected and death counts in Florida.
</p>
</div>
<p>We can draw multiple time series on the same plot by <code>group = State</code>. Figure <a href="timeseries.html#fig:death4">10.4</a> shows the time series plot of the daily new death count for each of the midwest states using the <code>ggplot()</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">state.ts <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(Region<span class="op">==</span><span class="st"> &quot;Midwest&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> DATE, <span class="dt">y =</span> Y.Death, 
             <span class="dt">group =</span> State, <span class="dt">color =</span> State)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:death4"></span>
<img src="bookdown-demo_files/figure-html/death4-1.png" alt="The time series plot of the daily new death count for each of the midwest states using the `ggplot()` function." width="672" />
<p class="caption">
Figure 10.4: The time series plot of the daily new death count for each of the midwest states using the <code>ggplot()</code> function.
</p>
</div>
<p>After making the time series plots, we look for</p>
<ul>
<li><p><strong>Trend:</strong> upward or downward movement that might be extrapolated into future; it does not have to be linear.</p></li>
<li><p><strong>Periodicity:</strong> repetition in regular pattern (usually peaks and troughs;</p></li>
<li><p><strong>Seasonality:</strong> periodic behavior of known period (i.e., 12 months for monthly data);</p></li>
<li><p><strong>Heteroskedasticity:</strong> changing variance, particularly with changing level;</p></li>
<li><p><strong>Dependence:</strong> positive (successive observations are similar) or negative (successive observations are dissimilar);</p></li>
<li><p><strong>Missing data</strong>, <strong>structural breaks</strong>, <strong>outliers</strong>.</p></li>
</ul>
<p><strong>Remark:</strong> Some readers confuse cyclic behavior with seasonal behavior, but they are really quite different. If the fluctuations are not of a fixed frequency, then they are cyclic; if the frequency is unchanging and associated with some aspect of the calendar, then the pattern is seasonal.</p>
<p><strong>A lag plot</strong></p>
<p>We can draw a lag plot to show the time series against lags of itself using the <code>gg_lag()</code> in the R library <code>feasts</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(feasts)
Florida.ts <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">gg_lag</span>(<span class="dt">y =</span> Y.Death, <span class="dt">geom =</span> <span class="st">&quot;point&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:deathlag"></span>
<img src="bookdown-demo_files/figure-html/deathlag-1.png" alt="The lag plot of the daily new death count for Florida." width="672" />
<p class="caption">
Figure 10.5: The lag plot of the daily new death count for Florida.
</p>
</div>
<p>It is often colored the seasonal period (here weekly cycle) to identify how each season (each date in a week) correlates with others. From Figure @(fig:deathlag), one sees that the relationship is strongly positive at lag 7, reflecting the strong weekly cycle in the data.</p>
</div>
<div id="objectives-of-time-series-analysis" class="section level3">
<h3><span class="header-section-number">10.2.4</span> Objectives of Time Series Analysis</h3>
<ul>
<li>Provide an interpretable model of data
<ul>
<li>often involves multivariate series</li>
<li>allows testing of scientific hypotheses</li>
<li>but, not always a major emphasis in time series analysis</li>
</ul></li>
<li>Predict future values of series
<ul>
<li>very common application of time series analysis</li>
<li>predictive models often do not try to explain</li>
</ul></li>
<li>Provide a compact description of data
<ul>
<li>good predictive model can be used for data compression</li>
<li>used extensively in telecommunications</li>
</ul></li>
</ul>
<p><strong>Modeling Strategy</strong></p>
<ul>
<li>Take a probabilistic approach
<ul>
<li>observations <span class="math inline">\(=\)</span> realizations of random variables</li>
<li>in much of statistics, random variables are assumed to be indepedent</li>
</ul></li>
<li>Difficulties in time series:
<ul>
<li>random variables are typically not identically distributed</li>
<li>different means due to trend, seasonality</li>
<li>may be different variances as well</li>
<li>random variables typically not independent</li>
<li>dependence may be positive or negative</li>
</ul></li>
<li>Try to make things easier
<ul>
<li>eliminate heterostedasticity via transformation (e.g. log)</li>
<li>eliminate trend and seasonality</li>
<li>model remainder as dependent but identically distributed</li>
</ul></li>
</ul>
</div>
<div id="autocorrelation" class="section level3">
<h3><span class="header-section-number">10.2.5</span> Autocorrelation</h3>
<p>Let <span class="math inline">\(\{X_t\}\)</span> be a time series with <span class="math inline">\(E(X_t^2)&lt;\infty\)</span>.</p>
<ul>
<li>The <strong>mean function</strong> of <span class="math inline">\(\{X_t\}\)</span> is <span class="math display">\[
  \mu_X(t)=\mathrm{E}(X_t).
  \]</span></li>
<li>The <strong>covariance function</strong> of <span class="math inline">\(\{X_t\}\)</span> is <span class="math display">\[
  \gamma_X(s,t)=\mathrm{Cov}(X_t,X_s) = \mathrm{E}[(X_s-\mu_X(s))(X_t-\mu_X(t))]
  \]</span> for all integers <span class="math inline">\(s\)</span> and <span class="math inline">\(t\)</span>.</li>
</ul>
<p><strong>Modeling Dependence</strong></p>
<ul>
<li>Hard to model dependence if dependence changes with time</li>
<li>Easiest to model dependence in stationary case</li>
</ul>
<p>Roughly speaking, stationary means <strong>probabilistic properties</strong> of series do not change with time. There are two versions of interest.</p>
<ol style="list-style-type: decimal">
<li><strong>Strict stationarity:</strong> joint probability distributions do not change with time.</li>
</ol>
<p>A time series <span class="math inline">\(\{X_t\}\)</span> is <strong>strictly stationary</strong> if for any positive integer <span class="math inline">\(k\)</span> and integers <span class="math inline">\(t_1, \ldots, t_k\)</span> and <span class="math inline">\(h\)</span>, <span class="math display">\[
 (X_{t_1},X_{t_2},\ldots,X_{t_k}) \overset{d}{=} (X_{t_1+h},X_{t_2+h},\ldots,X_{t_k+h})
 \]</span> where ``<span class="math inline">\(\overset{d}{=}\)</span>'' denotes equality in probability distribution.</p>
<p>Remark: covariances make sense only if variances exist</p>
<ul>
<li>If <span class="math inline">\(\{X_t\}\)</span> is IID, then <span class="math inline">\(\{X_t\}\)</span> is strictly stationary</li>
<li>Strict stationarity is a very strong modeling assumption
<ul>
<li>hard to verify in practice</li>
<li>often stronger than necessary for useful results <span class="math inline">\(\Rightarrow\)</span> introduce next so-called weak stationarity</li>
</ul></li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li><strong>Weak stationarity:</strong> 1st and 2nd order moment properties (i.e., mean and covariance structures) do not change over time</li>
</ol>
<ul>
<li><p>A time series <span class="math inline">\(\{X_t\}\)</span> is <strong>weakly stationary</strong> if for all integers <span class="math inline">\(t\)</span> and <span class="math inline">\(h\)</span>:</p>
<ol style="list-style-type: lower-alpha">
<li><span class="math inline">\(\mathrm{Var}(X_t)&lt;\infty\)</span></li>
<li><span class="math inline">\(E[X_t]\)</span> does not depend on <span class="math inline">\(t\)</span></li>
<li><span class="math inline">\(\mathrm{Cov}(X_t,X_{t+h})\)</span> does not depend on <span class="math inline">\(t\)</span></li>
</ol></li>
<li>Notes
<ol style="list-style-type: lower-alpha">
<li>implies all means, variances, and covariances exist</li>
<li>implies means are constant (rules out trend, seasonality)</li>
<li>with <span class="math inline">\(h = 0\)</span>, (c) implies variances are constant (rules out heteroskedasticity)</li>
</ol></li>
<li><p><strong>Weakly stationary</strong> also known as covariance stationary, second order stationary, or just stationary</p>
<pre><code>* 1st and 2nd-order moments do not change with time
* much weaker than strict stationarity </code></pre></li>
</ul>
</div>
<div id="autocorrelation-1" class="section level3">
<h3><span class="header-section-number">10.2.6</span> Autocorrelation</h3>
<ol style="list-style-type: decimal">
<li><strong>Autocovariance Function (ACVF)</strong></li>
</ol>
<p>For weakly stationary time series, <span class="math inline">\(\mathrm{Cov}(X_{t},X_{t+h})=\gamma(h)\)</span>, a function of <span class="math inline">\(h\)</span> only.</p>
<ol start="2" style="list-style-type: decimal">
<li><strong>Autocorrelation Function (ACF)</strong></li>
</ol>
<p>The autocorrelation function (ACF) of <span class="math inline">\(\{X_t\}\)</span> is defined by <span class="math display">\[
\rho(h)=\frac{\gamma(h)}{\gamma(0)}=\frac{\mathrm{Cov}(X_{t},X_{t+h})}{\sqrt{\mathrm{Var}(X_{t})\mathrm{Var}(X_{t+h})}}
\]</span></p>
<ol start="3" style="list-style-type: decimal">
<li><strong>Sample ACVF</strong></li>
</ol>
<p>Let <span class="math inline">\(\{X_t\}_{t=1}^n\)</span> be a time series and <span class="math inline">\(\bar{X}_{n}=\frac{1}{n}\sum_{t=1}^{n}X_t\)</span> be its sample mean. The sample ACVF (based on <span class="math inline">\(\{X_t\}_{t=1}^n\)</span>): <span class="math display">\[
\hat{\gamma}(h)\equiv \frac{1}{n}\sum_{t=1}^{n-|h|} (X_{t}-\bar{X}_{n})(X_{t+|h|}-\bar{X}_{n}), ~|h|&lt;n
\]</span> which estimates <span class="math inline">\(\gamma(h)=E[(X_t-EX_t)(X_{t+|h|}-EX_t)]\)</span>.</p>
<ol start="4" style="list-style-type: decimal">
<li><strong>Sample ACF</strong></li>
</ol>
<p>The sample ACF based on <span class="math inline">\(\{X_t\}_{t=1}^n\)</span> is defined as <span class="math display">\[
\hat{\rho}(h)\equiv \hat{\gamma}(h)/\hat{\gamma}(0), ~|h|&lt;n
\]</span> which estimates <span class="math inline">\(\rho(h)=\gamma(h)/\gamma(0)\)</span>, <span class="math inline">\(|\hat{\rho}(h)|\leq 1\)</span>, <span class="math inline">\(\hat{\rho}(0)=1\)</span>.</p>
<p>The autocorrelation coefficients are plotted to show the autocorrelation function or ACF. Figure <a href="timeseries.html#fig:acf">10.6</a> shows the ACF plot of the daily new death count in Florida.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Florida.ts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ACF</span>(Y.Death) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">autoplot</span>()</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:acf"></span>
<img src="bookdown-demo_files/figure-html/acf-1.png" alt="The ACF plot of the daily new death count in Florida." width="672" />
<p class="caption">
Figure 10.6: The ACF plot of the daily new death count in Florida.
</p>
</div>
<p>The dashed blue lines in this graph indicate whether the correlations are significantly different from zero, and <span class="math inline">\(\hat{\rho}(4)\)</span> is higher than for the other lags. This is due to the weekly pattern in the data: the peaks tend to be four quarters apart, and the troughs tend to be four quarters apart.</p>
<p><strong>Remark:</strong></p>
<ol style="list-style-type: decimal">
<li><p>When data have a trend, the autocorrelations for small lags tend to be large and positive because observations nearby in time are also nearby in size. So the ACF of the time series with a trend tends to have positive values that slowly decrease as the lags increase.</p></li>
<li><p>When data are seasonal, the autocorrelations will be larger for the seasonal lags (at multiples of the seasonal frequency) than for other lags.</p></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Florida.ts <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">gg_tsdisplay</span>(<span class="kw">difference</span>(Y.Death, <span class="dv">7</span>), <span class="dt">plot_type=</span><span class="st">&#39;partial&#39;</span>, <span class="dt">lag=</span><span class="dv">36</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">y=</span><span class="st">&quot;Lag 7 differenced&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:acfpacf"></span>
<img src="bookdown-demo_files/figure-html/acfpacf-1.png" alt="Time plot, ACF plot and PACF plot of lag-7 differenced data." width="672" />
<p class="caption">
Figure 10.7: Time plot, ACF plot and PACF plot of lag-7 differenced data.
</p>
</div>
</div>
</div>
<div id="time-series-decomposition" class="section level2">
<h2><span class="header-section-number">10.3</span> Time Series Decomposition</h2>
<p>Time series data can exhibit various patterns, and it is often helpful to split a time series into several components, each representing an underlying pattern category. In the literature, a time series is usually decomposed into three components: a trend component, a seasonal component, and a remainder component. In the following, we consider the following classical decomposition: <span class="math display">\[
    X_t=m_t+s_t+Y_t
    \]</span> where <span class="math inline">\(m_t\)</span> is the <strong>trend</strong> at <span class="math inline">\(t\)</span> (non-random often), <span class="math inline">\(s_t\)</span>: a function with known period <span class="math inline">\(d\)</span> referred to as <strong>seasonality</strong> (non-random), and <span class="math inline">\(Y_t\)</span>: irregular and random noise that is stationary.</p>
<p>Our aims are the following:</p>
<ul>
<li>to estimate and extract <span class="math inline">\(m_t\)</span> and <span class="math inline">\(s_t\)</span> so that the residual <span class="math inline">\(Y_t\)</span> will turn out to be stationary;</li>
<li>to find a satisfactory probabilistic model for <span class="math inline">\(Y_t\)</span>;</li>
<li>use it in conjunction with <span class="math inline">\(m_t\)</span> and <span class="math inline">\(s_t\)</span> for prediction and simulation of <span class="math inline">\(\{X_t\}\)</span>.</li>
</ul>
<p>When decomposing a time series, it is sometimes helpful to first transform or adjust the series in order to make the decomposition (and later analysis) as simple as possible. So we will begin by discussing transformations and adjustments.</p>
<p><code>STL</code> developed by <span class="citation">R. B. Cleveland et al. (<a href="#ref-Cleveland1990">1990</a>)</span> is a versatile and robust method for decomposing time series. STL is an acronym for “Seasonal and Trend decomposition using Loess,” while Loess is a method for estimating nonlinear relationships.</p>
<p>Below we will demonstrate how to use the <code>STL()</code> to decompose the time series of the daily new death count in Florida.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Time series decomposition</span>
dcmp &lt;-<span class="st"> </span>Florida.ts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">model</span>(<span class="kw">STL</span>(Y.Death))
<span class="kw">components</span>(dcmp)</code></pre></div>
<pre><code>## # A dable:           324 x 8 [1D]
## # Key:               State, .model [1]
## # STL Decomposition: Y.Death = trend + season_week +
## #   remainder
##    State .model DATE       Y.Death    trend season_week
##    &lt;fct&gt; &lt;chr&gt;  &lt;date&gt;       &lt;int&gt;    &lt;dbl&gt;       &lt;dbl&gt;
##  1 Flor… STL(Y… 2020-01-23       0 -0.0944       0.415 
##  2 Flor… STL(Y… 2020-01-24       0 -0.0748      -0.139 
##  3 Flor… STL(Y… 2020-01-25       0 -0.0553       0.182 
##  4 Flor… STL(Y… 2020-01-26       0 -0.0407      -0.0670
##  5 Flor… STL(Y… 2020-01-27       0 -0.0262      -0.364 
##  6 Flor… STL(Y… 2020-01-28       0 -0.0162       0.0220
##  7 Flor… STL(Y… 2020-01-29       0 -0.00616     -0.0895
##  8 Flor… STL(Y… 2020-01-30       0 -0.00120      0.497 
##  9 Flor… STL(Y… 2020-01-31       0  0.00376     -0.158 
## 10 Flor… STL(Y… 2020-02-01       0  0.00224      0.214 
## # … with 314 more rows, and 2 more variables:
## #   remainder &lt;dbl&gt;, season_adjust &lt;dbl&gt;</code></pre>
<p>We will decompose the time series of the daily new deaths in Florida as shown in Figure <a href="timeseries.html#fig:death1">10.1</a>. Figure <a href="#fig:dcmp1"><strong>??</strong></a> shows the trend of the time series.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Florida.ts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">autoplot</span>(Y.Death, <span class="dt">color =</span> <span class="st">&quot;gray&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">autolayer</span>(<span class="kw">components</span>(dcmp), trend, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Death Count&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Daily New Death Count with Trend&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:dcmp1-1"></span>
<img src="bookdown-demo_files/figure-html/dcmp1-1.png" alt="Trend of the daily new death count time series in Florida." width="672" />
<p class="caption">
Figure 10.8: Trend of the daily new death count time series in Florida.
</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">components</span>(dcmp) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">autoplot</span>()</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:dcmp1-2"></span>
<img src="bookdown-demo_files/figure-html/dcmp1-2.png" alt="Trend of the daily new death count time series in Florida." width="672" />
<p class="caption">
Figure 10.9: Trend of the daily new death count time series in Florida.
</p>
</div>
<p>The <code>STL()</code> function also allows us to choose the trend window <code>trend(window = )</code> and the seasonal window <code>season(window = )</code>, which controls how rapidly the trend and seasonal components can change. The smaller the value, the more rapid the changes. The trend window is the number of consecutive observations to be used when estimating the trend-cycle; the season window is the number of consecutive days to estimate each value in the seasonal component. For example, Figure <a href="timeseries.html#fig:dcmp2">10.10</a> shows the trend, seasonality and residuals of the daily new death count time series in Florida based on <code>trend(window = 14)</code> and <code>season(window = 7)</code>. Both trend and seasonal windows should be odd numbers.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Florida.ts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">model</span>(<span class="kw">STL</span>(Y.Death <span class="op">~</span><span class="st"> </span><span class="kw">trend</span>(<span class="dt">window =</span> <span class="dv">14</span>) <span class="op">+</span><span class="st"> </span><span class="kw">season</span>(<span class="dt">window =</span> <span class="dv">7</span>),
            <span class="dt">robust =</span> <span class="ot">TRUE</span>
  )) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">components</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">autoplot</span>()</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:dcmp2"></span>
<img src="bookdown-demo_files/figure-html/dcmp2-1.png" alt="The trend, seasonality and residuals of the daily new death count time series in Florida based on trend window = 14 and seasonal window = 7." width="672" />
<p class="caption">
Figure 10.10: The trend, seasonality and residuals of the daily new death count time series in Florida based on trend window = 14 and seasonal window = 7.
</p>
</div>
<p><strong>Trend and Seasonal Estimation: Method I</strong></p>
<p>Step 1. Form preliminary estimate <span class="math inline">\(\hat{m}_t\)</span> of trend by passing data through filter/smoothing that eliminates <span class="math inline">\(s_t\)</span> as much as possible.</p>
<p>Step 2. Subtract trend estimate from data: <span class="math inline">\(u_t = x_t - \hat{m}_t\)</span> .</p>
<p>Step 3. Obtain seasonal pattern estimate <span class="math inline">\(\{\hat{s}_j : j = 1,\ldots,d\}\)</span>.</p>
<p>Step 4. Replicate <span class="math inline">\(\{\hat{s}_j\}\)</span> as need be to form estimate <span class="math inline">\(\{\hat{s}_t\}\)</span> of <span class="math inline">\(\{s_t\}\)</span>.</p>
<p>Step 5. Form deseasonalized data: <span class="math inline">\(d_t = x_t -\hat{s}_t\)</span>.</p>
<p>Step 6. Use deseasonalized data to get final estimate <span class="math inline">\(\hat{m}_t\)</span> of trend.</p>
<p><strong>Trend and Seasonal Estimation: Method II</strong></p>
<p>Step 1. Apply a lag-<span class="math inline">\(d\)</span> differencing operator to <span class="math inline">\(X_t\)</span>, then</p>
<span class="math display">\[\begin{eqnarray*}
(1-B^d)X_t&amp;=&amp;m_t-m_{t-d}+s_t-s_{t-d}+Y_t-Y_{t-d}\\
&amp;=&amp;m_t-m_{t-d}+Y_t-Y_{t-d}.
\end{eqnarray*}\]</span>
<p>Step 2. Resulting model has a trend component defined by <span class="math inline">\(m_t-m_{t-d}\)</span> and a stochastic component given by <span class="math inline">\(Y_t-Y_{t-d}\)</span>.</p>
<p>Step 3. Trend component can be eliminated by applying an appropriate power of differencing operator, say <span class="math inline">\((1-B)^{d^{\prime}}\)</span>. Thus, <span class="math display">\[
  \underbrace{(1-B)^{d^{\prime}}}{}\underbrace{(1-B^d)}{}X_t
  =\underbrace{(1-B)^{d^{\prime}}}{}\underbrace{(1-B^d)}{}m_t
  +\underbrace{(1-B)^{d^{\prime}}}{}\underbrace{(1-B^d)}{}Y_t
\]</span> is a model for a series related to <span class="math inline">\(\{x_t\}\)</span> that is free of trend and seasonal components.</p>
</div>
<div id="simple-time-series-forecasting-approaches" class="section level2">
<h2><span class="header-section-number">10.4</span> Simple Time Series Forecasting Approaches</h2>
<p>We use data-driven prediction approaches without considering any other aspect, such as the disease spread mechanism. We describe each approach in detail in the following subsections. If <span class="math inline">\(\{Z_t\}\)</span> is a sequence of independent random variables that follow the same normal distribution with zero mean, we call <span class="math inline">\(\{Z_t\}\)</span> IID Gaussian noise.</p>
<div id="average-method" class="section level3">
<h3><span class="header-section-number">10.4.1</span> Average method</h3>
<p>Denote the time series data by <span class="math inline">\(\{Y_t\}\)</span>, and consider the following model: <span class="math display">\[
Y_t=\mu+Z_t, 
\]</span> where <span class="math inline">\(\{Z_t\}\)</span> are IID gaussian noise.</p>
<p>The average method assumes that forecasts of all future values are equal to the average (or “mean”) of the historical data. If we let the historical data be denoted by <span class="math inline">\(Y_1,\ldots,Y_n\)</span>, and let <span class="math inline">\(\hat{Y}_{n+h|n}\)</span> be the estimate of <span class="math inline">\(Y_{n+h}\)</span> based on the historical data, then we can write the forecasts as <span class="math display">\[
\hat{Y}_{n+h|n}=\frac{1}{n}\sum_{t=1}^n Y_t.
\]</span></p>
<p>For a numeric vector or time series of class <code>ts</code> <span class="math inline">\(y\)</span>, the function <code>MEAN(y)</code> returns an i.i.d model applied to <code>y</code>. The <code>forecast(h = )</code> returns the forecasts and prediction intervals for <span class="math inline">\(Y_{n+h}\)</span> via the average method, and <span class="math inline">\(h\)</span> is the number of periods for forecasting. Figure <a href="timeseries.html#fig:predmean">10.11</a> shows the two weeks ahead forecast and 95% prediction intervals for the daily death count in Florida based on the average method.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Florida.ts <span class="op">%&gt;%</span><span class="st"> </span>
<span class="kw">model</span>(<span class="kw">MEAN</span>(Y.Death))<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="dv">14</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">autoplot</span>(Florida.ts, <span class="dt">level =</span> <span class="dv">95</span>, <span class="dt">title =</span> <span class="st">&quot;Average Method&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Death count&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Average Method&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:predmean"></span>
<img src="bookdown-demo_files/figure-html/predmean-1.png" alt="Two weeks ahead forecast of the daily death count for Florida using the average method." width="672" />
<p class="caption">
Figure 10.11: Two weeks ahead forecast of the daily death count for Florida using the average method.
</p>
</div>
</div>
<div id="random-walk-forecasts" class="section level3">
<h3><span class="header-section-number">10.4.2</span> Random walk forecasts</h3>
<p>The random walk model assumes that <span class="math display">\[
Y_t=Y_{t-1}+Z_t,
\]</span> where <span class="math inline">\(\{Z_t\}\)</span> are IID gaussian noise.</p>
<p>The random walk approach simply sets all forecasts to be the value of the last observation. That is, <span class="math display">\[
\hat{Y}_{n+h|n}=Y_n.
\]</span> The function <code>RW(y)</code> or <code>NAIVE(y)</code> together with <code>forecast(h)</code> provide the random walk forecasts and prediction intervals for <span class="math inline">\(Y_{n+h}\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Florida.ts <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">model</span>(<span class="kw">RW</span>(Y.Death))<span class="op">%&gt;%</span>
<span class="co"># NAIVE(Y.Death) is an equivalent alternative</span>
<span class="st">  </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="dv">14</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">autoplot</span>(Florida.ts, <span class="dt">level =</span> <span class="dv">95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Death count&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Random Work Method&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:predrw"></span>
<img src="bookdown-demo_files/figure-html/predrw-1.png" alt="Two weeks ahead forecast of the daily death count for Florida using the random walk method." width="672" />
<p class="caption">
Figure 10.12: Two weeks ahead forecast of the daily death count for Florida using the random walk method.
</p>
</div>
</div>
<div id="seasonal-random-walk-forecasts" class="section level3">
<h3><span class="header-section-number">10.4.3</span> Seasonal random walk forecasts</h3>
<p>A similar method is useful for highly seasonal data. In this case, we set each forecast to be equal to the last observed value from the same day of the previous week. Formally, the forecast for time <span class="math inline">\(n+h\)</span> is written as <span class="math display">\[
\hat{Y}_{n+h|n}=Y_{n+h-m(k+1)},
\]</span> where <span class="math inline">\(m=\)</span> the seasonal period, and <span class="math inline">\(k=[(h-1)/m]\)</span>. For COVID-19 data, we often observe the seven day cycle; see <span class="citation">G. Wang et al. (<a href="#ref-wang:2020:comparing">2020</a>)</span>. Then, <span class="math inline">\(m=7\)</span> and <span class="math inline">\(k\)</span> is the number of complete weeks in the forecast period prior to time <span class="math inline">\(n+h\)</span>.</p>
<p>The function <code>SNAIVE(y)</code> with <code>forecast(h)</code> provides the seasonal random walk forecasts and prediction intervals for <span class="math inline">\(Y_{n+h}\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Florida.ts <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">model</span>(<span class="kw">SNAIVE</span>(Y.Death))<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="dv">14</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">autoplot</span>(Florida.ts, <span class="dt">level =</span> <span class="dv">95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Death count&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Seasonal Random Work Method&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:predsnaive"></span>
<img src="bookdown-demo_files/figure-html/predsnaive-1.png" alt="Two weeks ahead forecast of the daily death count for Florida using the seasonal random walk method." width="672" />
<p class="caption">
Figure 10.13: Two weeks ahead forecast of the daily death count for Florida using the seasonal random walk method.
</p>
</div>
</div>
<div id="random-walk-with-drift-method" class="section level3">
<h3><span class="header-section-number">10.4.4</span> Random walk with drift method</h3>
<p>The random walk with drift model is <span class="math display">\[
Y_t=c+Y_{t-1}+Z_t
\]</span> where <span class="math inline">\(\{Z_t\}\)</span> are i.i.d and follow a normal distribution.</p>
<p>A variation on the random walk method allows the forecasts to increase or decrease over time, where the amount of change over time (called the <strong>drift</strong>) is set to be the average change seen in the historical data. Forecasts are given by <span class="math display">\[
\hat{Y}_{n+h|n}=\hat{c}h+Y_n=Y_n+h\frac{Y_n-Y_1}{n-1}.
\]</span></p>
<p>We use the <code>RW( ~ drift())</code> with <code>forecast(h)</code> provide to make an <span class="math inline">\(h\)</span> step ahead forecast.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Florida.ts <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">model</span>(<span class="kw">RW</span>(Y.Death <span class="op">~</span><span class="st"> </span><span class="kw">drift</span>())) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="dv">14</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">autoplot</span>(Florida.ts, <span class="dt">level =</span> <span class="dv">95</span>)  <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Death count&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Random Work Method with Drift&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:predrwd"></span>
<img src="bookdown-demo_files/figure-html/predrwd-1.png" alt="Two weeks ahead forecast of the daily death count for Florida using the random walk with drift method." width="672" />
<p class="caption">
Figure 10.14: Two weeks ahead forecast of the daily death count for Florida using the random walk with drift method.
</p>
</div>
</div>
<div id="combining-the-forecasting-results" class="section level3">
<h3><span class="header-section-number">10.4.5</span> Combining the forecasting results</h3>
<p>Now, let us combine all the forecasting results based on the previous methods together. Figure (fig:pred4) shows the comparison among different methods.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tsibble)
<span class="co"># Set training data from JAN 23 to NOV 27</span>
train &lt;-<span class="st"> </span>Florida.ts <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter_index</span>(<span class="st">&quot;2020-01-23&quot;</span> <span class="op">~</span><span class="st"> &quot;2020-11-27&quot;</span>)

<span class="co"># Fit the models</span>
death_fit &lt;-<span class="st"> </span>train <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">model</span>(
    <span class="dt">Mean =</span> <span class="kw">MEAN</span>(Y.Death),
    <span class="st">`</span><span class="dt">RW</span><span class="st">`</span> =<span class="st"> </span><span class="kw">RW</span>(Y.Death),
    <span class="st">`</span><span class="dt">Seasonal naïve</span><span class="st">`</span> =<span class="st"> </span><span class="kw">SNAIVE</span>(Y.Death),
    <span class="st">`</span><span class="dt">RW-Drift</span><span class="st">`</span> =<span class="st"> </span><span class="kw">RW</span>(Y.Death <span class="op">~</span><span class="st"> </span><span class="kw">drift</span>())
  )
<span class="co"># Generate forecasts for the next 2 weeks</span>
death_fc &lt;-<span class="st"> </span>death_fit <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="dv">14</span>)
<span class="co"># Plot forecasts against actual values</span>
death_fc <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">autoplot</span>(train, <span class="dt">level =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">autolayer</span>(<span class="kw">filter_index</span>(dplyr<span class="op">::</span><span class="kw">select</span>(Florida.ts, Y.Death), 
                         <span class="st">&quot;2020-11-28&quot;</span> <span class="op">~</span><span class="st"> </span>.), <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Death count&quot;</span>, 
       <span class="dt">title =</span> <span class="st">&quot;Simple Time Series Forecasting Methods&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">colour =</span> <span class="kw">guide_legend</span>(<span class="dt">title =</span> <span class="st">&quot;Forecast&quot;</span>))</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:pred4"></span>
<img src="bookdown-demo_files/figure-html/pred4-1.png" alt="Two weeks ahead forecast of the daily death count for Florida using four differentt methods." width="672" />
<p class="caption">
Figure 10.15: Two weeks ahead forecast of the daily death count for Florida using four differentt methods.
</p>
</div>
</div>
</div>
<div id="methods-for-estimating-the-trend" class="section level2">
<h2><span class="header-section-number">10.5</span> Methods for Estimating the Trend</h2>
<ol style="list-style-type: decimal">
<li>Polynomial regression</li>
</ol>
<p>Simplest curve fit or approximation model, where the number of cases is approximated locally with polynomials of degree <span class="math inline">\(d\)</span>. <span class="math display">\[
Y_t = \beta_0 + \beta_1 t + \beta_2 t^2 + \cdots + \beta_d t^d + Z_t,
\]</span> where <span class="math inline">\(\{Z_t\}\)</span> are IID gaussian noise.</p>
<p>Figure <a href="timeseries.html#fig:predlm">10.16</a> of the 14 days ahead forecast of the daily death count for Florida using the linear regression method.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">death_lmfit &lt;-<span class="st"> </span>train <span class="op">%&gt;%</span><span class="st">  </span>
<span class="st">  </span><span class="kw">model</span>(<span class="kw">TSLM</span>(Y.Death <span class="op">~</span><span class="st"> </span>DATE)) </code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:predlm"></span>
<img src="bookdown-demo_files/figure-html/predlm-1.png" alt="Two weeks ahead forecast of the daily death count for Florida using the linear regression method." width="672" />
<p class="caption">
Figure 10.16: Two weeks ahead forecast of the daily death count for Florida using the linear regression method.
</p>
</div>
<p>Figure <a href="timeseries.html#fig:predlm">10.16</a> shows the 14 days ahead forecast of the daily death count for Florida using the linear regression method with the seasonal component: <code>season(7)</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">death_lmsfit &lt;-<span class="st"> </span>train <span class="op">%&gt;%</span><span class="st">  </span>
<span class="st">  </span><span class="kw">model</span>(<span class="kw">TSLM</span>(Y.Death  <span class="op">~</span><span class="st"> </span>DATE <span class="op">+</span><span class="st"> </span><span class="kw">season</span>(<span class="dv">7</span>))) </code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:predlms"></span>
<img src="bookdown-demo_files/figure-html/predlms-1.png" alt="Two weeks ahead forecast of the daily death count for Florida using the linear regression method with the seasonal component." width="672" />
<p class="caption">
Figure 10.17: Two weeks ahead forecast of the daily death count for Florida using the linear regression method with the seasonal component.
</p>
</div>
<ol start="2" style="list-style-type: decimal">
<li>Simple exponential smoothing</li>
</ol>
<p>Consider the following nonseasonal model with trend: <span class="math display">\[
Y_t=m_t+Z_t,
\]</span> where <span class="math inline">\(\mathrm{E}Z_t=0\)</span>.</p>
<p>We can estimate <span class="math inline">\(m_t\)</span> using simple exponential smoothing (SES). For any fixed <span class="math inline">\(0&lt;\alpha&lt;1\)</span>, consider <span class="math inline">\(\hat{m}_t\)</span> defined by the following recursions:</p>
<span class="math display">\[\begin{eqnarray*}
\hat{m}_1 &amp;=&amp; Y_1, \mathrm{~~and}\\
\hat{m}_t &amp;=&amp; \alpha Y_t+(1-\alpha)\hat{m}_{t-1}\\
          &amp;=&amp; \alpha Y_t+(1-\alpha)\{\alpha Y_{t-1}+(1-\alpha)\hat{m}_{t-2}\}\\
          &amp;=&amp; \alpha Y_t+(1-\alpha)\alpha Y_{t-1}+(1-\alpha)^2\alpha X_{t-2}+(1-\alpha)^3\hat{m}_{t-3}\\
          &amp;=&amp; \ldots
\end{eqnarray*}\]</span>
<p>with exponentially decreasing weights on previous observations: <span class="math inline">\(\alpha(1-\alpha)^0\)</span> on <span class="math inline">\(Y_t\)</span>, <span class="math inline">\(\alpha(1-\alpha)^1\)</span> on <span class="math inline">\(Y_{t-1}\)</span>, <span class="math inline">\(\alpha(1-\alpha)^2\)</span> on <span class="math inline">\(Y_{t-2}\)</span>, <span class="math inline">\(\ldots\)</span></p>
<ul>
<li><span class="math inline">\(\alpha\rightarrow 1\)</span>, less bias, more variance</li>
<li><span class="math inline">\(\alpha\rightarrow 0\)</span>, more bias, less variance</li>
</ul>
<p>This method is suitable for forecasting data with no clear trend or seasonal pattern. The function <code>SES(y)</code> function returns forecasts and other information for the simple exponential smoothing forecasts applied to <code>y</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ets_fit &lt;-<span class="st"> </span>train <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">model</span>(<span class="dt">additive =</span> <span class="kw">ETS</span>(Y.Death 
                       <span class="op">~</span><span class="st"> </span><span class="kw">error</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">trend</span>(<span class="st">&quot;N&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">season</span>(<span class="st">&quot;N&quot;</span>), 
                       <span class="dt">opt_crit =</span> <span class="st">&quot;mse&quot;</span>)) </code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:predses1"></span>
<img src="bookdown-demo_files/figure-html/predses1-1.png" alt="Two weeks ahead forecast of the daily death count for Florida using the simple exponential smoothing method." width="672" />
<p class="caption">
Figure 10.18: Two weeks ahead forecast of the daily death count for Florida using the simple exponential smoothing method.
</p>
</div>
<p>The <code>ETS()</code> also allows you to extend the simple exponential smoothing to allow the forecasting of data with a trend and seasonality.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">etss_fit &lt;-<span class="st"> </span>train <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">model</span>(<span class="dt">additive =</span> <span class="kw">ETS</span>(Y.Death 
                       <span class="op">~</span><span class="st"> </span><span class="kw">error</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">trend</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">season</span>(<span class="st">&quot;A&quot;</span>))) </code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:predses2"></span>
<img src="bookdown-demo_files/figure-html/predses2-1.png" alt="Two weeks ahead forecast of the daily death count for Florida using the extended exponential smoothing method with trend and seasonality components." width="672" />
<p class="caption">
Figure 10.19: Two weeks ahead forecast of the daily death count for Florida using the extended exponential smoothing method with trend and seasonality components.
</p>
</div>
<ol start="3" style="list-style-type: decimal">
<li>Residual diagnostics</li>
</ol>
<p>The fitted values and residuals from a model can be obtained using the <code>augment()</code> function. In the above example, we saved the fitted models as beer_fit. So we can simply apply <code>augment()</code> to this object to compute the fitted values and residuals for all models.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">augment</span>(death_lmfit)</code></pre></div>
<pre><code>## # A tsibble: 310 x 7 [1D]
## # Key:       State, .model [1]
##    State  .model    DATE       Y.Death .fitted .resid .innov
##    &lt;fct&gt;  &lt;chr&gt;     &lt;date&gt;       &lt;int&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
##  1 Flori… TSLM(Y.D… 2020-01-23       0    2.95  -2.95  -2.95
##  2 Flori… TSLM(Y.D… 2020-01-24       0    3.32  -3.32  -3.32
##  3 Flori… TSLM(Y.D… 2020-01-25       0    3.68  -3.68  -3.68
##  4 Flori… TSLM(Y.D… 2020-01-26       0    4.05  -4.05  -4.05
##  5 Flori… TSLM(Y.D… 2020-01-27       0    4.41  -4.41  -4.41
##  6 Flori… TSLM(Y.D… 2020-01-28       0    4.78  -4.78  -4.78
##  7 Flori… TSLM(Y.D… 2020-01-29       0    5.14  -5.14  -5.14
##  8 Flori… TSLM(Y.D… 2020-01-30       0    5.50  -5.50  -5.50
##  9 Flori… TSLM(Y.D… 2020-01-31       0    5.87  -5.87  -5.87
## 10 Flori… TSLM(Y.D… 2020-02-01       0    6.23  -6.23  -6.23
## # … with 300 more rows</code></pre>
<p>Residuals are useful in checking whether a model has adequately captured the information in the data. If patterns are observable in the residuals, the model can probably be improved.</p>
<p>A good forecasting method will yield residuals with the following properties:</p>
<ul>
<li>The residuals are uncorrelated. If there are correlations between residuals, then there is information left in the residuals that should be used in computing forecasts.</li>
<li>The residuals have zero mean. If the residuals have a mean other than zero, then the forecasts are biased.</li>
<li>The residuals have constant variance.</li>
<li>The residuals are normally distributed.</li>
</ul>
<p>Any forecasting method that does not satisfy these properties can be improved.</p>
<p>The residuals obtained from forecasting this series using the linear regression method with seasonal components are shown in Figure <a href="timeseries.html#fig:reslmsts">10.20</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">augment</span>(death_lmsfit) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">autoplot</span>(.resid) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Day&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Residual&quot;</span>, 
       <span class="dt">title =</span> <span class="st">&quot;Residuals from linear regression with seasonal component.&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:reslmsts"></span>
<img src="bookdown-demo_files/figure-html/reslmsts-1.png" alt="Residual plot based on the linear regression method with seasonal components." width="672" />
<p class="caption">
Figure 10.20: Residual plot based on the linear regression method with seasonal components.
</p>
</div>
<p>A convenient shortcut for producing these residual diagnostic graphs is the <code>gg_tsresiduals()</code> function, which will produce a time plot, ACF plot and histogram of the residuals.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gg_tsresiduals</span>(death_lmsfit)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:reslms"></span>
<img src="bookdown-demo_files/figure-html/reslms-1.png" alt="Time plot, ACF plot and histogram of the residuals based on the linear regression method with seasonal components." width="672" />
<p class="caption">
Figure 10.21: Time plot, ACF plot and histogram of the residuals based on the linear regression method with seasonal components.
</p>
</div>
<p>The residuals plots obtained from forecasting this series using the extended exponential smoothing method with trend and seasonality components are shown in Figure <a href="timeseries.html#fig:resets">10.22</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gg_tsresiduals</span>(etss_fit)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:resets"></span>
<img src="bookdown-demo_files/figure-html/resets-1.png" alt="Time plot, ACF plot and histogram of the residuals based on the extended ETS method with trend and seasonal components." width="672" />
<p class="caption">
Figure 10.22: Time plot, ACF plot and histogram of the residuals based on the extended ETS method with trend and seasonal components.
</p>
</div>
<p>These graphs show that the ETS method produces forecasts that appear to account for all available information. The residuals' mean is close to zero, and there is no significant correlation in the residuals series. The time plot of the residuals shows that the variation of the residuals stays much the same across the historical data, apart from the one outlier. Therefore the residual variance can be treated as constant. This can also be seen on the histogram of the residuals. The histogram suggests that the residuals seem to be normal. Consequently, forecasts from this method will probably be quite good, but prediction intervals that are computed assuming a normal distribution seem to be reasonable.</p>
</div>
<div id="arma-models" class="section level2">
<h2><span class="header-section-number">10.6</span> ARMA Models</h2>
<p>A process <span class="math inline">\(\{X_t\}\)</span> is said to be ARMA<span class="math inline">\((p,q)\)</span> (for integers <span class="math inline">\(p,q \geq 0\)</span>), or an AutoRegressive (AR) Moving Average (MA), with</p>
<span class="math display">\[\begin{eqnarray*}
\mathrm{AR~polynomial~} \phi(z) &amp;=&amp; 1 -\phi_1 z -\phi_2 z^2 - \cdots -\phi_p z^p \\
\mathrm{MA~polynomial~} \theta(z) &amp;=&amp; 1 + \theta_1 z +\theta_2 z^2 + \cdots +\theta_q z^q
\end{eqnarray*}\]</span>
<p>if <span class="math inline">\(\{X_t\}\)</span> satisfies</p>
<p><span class="math display">\[
\phi(B)X_t = \theta(B)Z_t \quad \mathrm{for~all~integers~} t,
\]</span></p>
<p>with respect to some <span class="math inline">\(\{Z_t\}\sim \mathrm{WN}(0,\sigma^2)\)</span>. That is,</p>
<span class="math display">\[\begin{eqnarray*}
\phi(B)X_t &amp;=&amp; X_t -\phi_1 X_{t-1} -\phi_2 X_{t-2} - \cdots -\phi_p X_{t-p}\\
&amp;=&amp;Z_t+\theta_1 Z_{t-1} +\theta_2 Z_{t-2} + \cdots +\theta_q Z_{t-q}=\theta(B)Z_t
\end{eqnarray*}\]</span>
<div id="simple-examples-of-arma-models" class="section level3">
<h3><span class="header-section-number">10.6.1</span> Simple Examples of ARMA Models</h3>
<ul>
<li><p>AR(1) or ARMA(1,0) <span class="math display">\[
X_t=\phi X_{t-1}+Z_{t}
\]</span> with AR polynomial: <span class="math inline">\(\phi(z)=1-\phi z\)</span> and MA polynomial: <span class="math inline">\(\theta(z)=1\)</span>.</p></li>
<li><p>MA(1) or ARMA(0,1) <span class="math display">\[
X_t=Z_{t}+\theta Z_{t-1}
\]</span> with AR polynomial: <span class="math inline">\(\phi(z)=1\)</span> and MA polynomial: <span class="math inline">\(\theta(z)=1 +\theta z\)</span>.</p></li>
</ul>
<p>A Remark of an ARMA Model:</p>
<p>If <span class="math inline">\(\{X_t\}\)</span> satisfies <span class="math inline">\(\phi(B)X_t = \theta(B)Z_t\)</span>, then <span class="math inline">\(\{X_t\}\)</span> also satisfies <span class="math display">\[
(1 - aB)\phi(B)X_t = (1-aB)\theta(B)Z_t
\]</span> for any <span class="math inline">\(a\in \mathbb{R}\)</span>. So, the same process <span class="math inline">\(\{X_t\}\)</span> would satisfy different ARMA models.</p>
<p>In the ARMA definition, assume that the polynomials <span class="math inline">\(\phi(z)\)</span> and <span class="math inline">\(\theta(z)\)</span> have no common factors!</p>
</div>
<div id="arima" class="section level3">
<h3><span class="header-section-number">10.6.2</span> ARIMA</h3>
<p>A process <span class="math inline">\(\{Y_t\}\)</span> is said to be ARIMA<span class="math inline">\((p,d,q)\)</span> (for integers <span class="math inline">\(p,d,q \geq 0\)</span>), or an AutoRegressive (AR) Integrated (I) Moving Average (MA), if <span class="math inline">\(\{Y_t\}\)</span> satisfies</p>
<span class="math display">\[\begin{eqnarray*}
(1-B)^d Y_t = X_t \sim \mathrm{ARMA}(p,q) \mathrm{~for~all~integers~} t.
\end{eqnarray*}\]</span>
<p>Example: <span class="math inline">\(Y_t \sim\)</span> ARIMA<span class="math inline">\((p,1,q)\)</span>: suppose <span class="math inline">\(X_t \sim \mathrm{ARMA}(p,q)\)</span> <span class="math display">\[
Y_t=Y_{t-1}+X_t=\cdots=Y_{0}+\sum_{j=1}^t X_j, ~ t=1,2, \ldots
\]</span></p>
<p><strong>Remarks:</strong></p>
<ul>
<li>For any positive integer <span class="math inline">\(d=1,2,\ldots\)</span>, <span class="math inline">\(\{Y_t\}\)</span> is not weakly stationary.</li>
<li>For <span class="math inline">\(d = 0\)</span>, <span class="math inline">\(\{Y_t\}\)</span> is just <span class="math inline">\(\mathrm{ARMA}(p, q)\)</span> [typically weakly stationary] with so-called <strong>short-memory</strong> dependence.</li>
<li>For <span class="math inline">\(0&lt;d&lt;1\)</span>, <span class="math inline">\(\{Y_t\}\)</span> is weakly stationary with so-called <strong>long-memory</strong> dependence.</li>
</ul>
<p><strong>Example 1:</strong> Suppose <span class="math inline">\(\{X_t\}\)</span> is an ARIMA(1,1,0): <span class="math display">\[
(1-\phi B)(1-B)X_t=Z_t, ~ Z_t\sim \mathrm{WN}(0,\sigma^2)
\]</span> One can solve this as <span class="math display">\[
X_t=X_0+\sum_{j=1}^{t}Y_j, \mathrm{~with}
\]</span> <span class="math display">\[
Y_t=(1-B)X_t=\sum_{j=0}^{\infty}\phi^jZ_{t-j}.
\]</span></p>
<p><strong>Example 2:</strong> Suppose <span class="math inline">\(\{X_t\}\)</span> is an ARIMA(0,1,1): <span class="math display">\[
X_t=X_{t-1}+W_t-\theta_1W_{t-1}
\]</span> If <span class="math inline">\(|\theta_1|&lt;1\)</span>, we can show <span class="math display">\[
X_t=\sum_{j=1}^{\infty}(1-\theta_1)\theta_1^jX_{t-j}+W_t, \mathrm{~and~so}
\]</span></p>
<span class="math display">\[\begin{eqnarray*}
\tilde{X}_{n+1}&amp;=&amp;\sum_{j=1}^{\infty}(1-\theta_1)\theta_1^jX_{n+1-j}\\
&amp;=&amp; (1-\theta_1)X_n+\sum_{j=2}^{\infty}(1-\theta_1)\theta_1^jX_{n+1-j}\\
&amp;=&amp; (1-\theta_1)X_n+\theta_1\tilde{X}_{n}
\end{eqnarray*}\]</span>
<p>Exponentially weighted moving average.</p>
<p><strong>Building ARIMA models</strong></p>
<p>Step 1. Plot the time series. Look for trends, seasonal components, step changes, outliers.</p>
<p>Step 2. Nonlinearly transform data, if necessary.</p>
<p>Step 3. Identify preliminary values of <span class="math inline">\(d\)</span>, <span class="math inline">\(p\)</span>, and <span class="math inline">\(q\)</span>.</p>
<p>Step 4. Estimate parameters.</p>
<p>Step 5. Use diagnostics to confirm residuals are white noise/iid/normal.</p>
<p>Step 6. Model selection.</p>
<p><strong>Identifying <span class="math inline">\(d, p, q\)</span></strong></p>
<ul>
<li>For identifying preliminary values of <span class="math inline">\(d\)</span>, a time series plot can also help.</li>
<li>Too little differencing: not stationary.</li>
<li>Too much differencing: extra dependence introduced.</li>
<li>For identifying <span class="math inline">\(p, q\)</span>, look at sample ACF, PACF of <span class="math inline">\((1 - B)^dX_t\)</span>:</li>
</ul>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-158">Table 10.1: </span>My caption
</caption>
<thead>
<tr>
<th style="text-align:left;">
Model
</th>
<th style="text-align:left;">
ACF
</th>
<th style="text-align:left;">
PACF
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
AR(p)
</td>
<td style="text-align:left;">
decays
</td>
<td style="text-align:left;">
zero for h &gt; p
</td>
</tr>
<tr>
<td style="text-align:left;">
MA(q)
</td>
<td style="text-align:left;">
zero for h &gt; q
</td>
<td style="text-align:left;">
decays
</td>
</tr>
<tr>
<td style="text-align:left;">
ARMA(p,q)
</td>
<td style="text-align:left;">
decays
</td>
<td style="text-align:left;">
decays
</td>
</tr>
</tbody>
</table>
</div>
<div id="seasonal-arima-model" class="section level3">
<h3><span class="header-section-number">10.6.3</span> Seasonal ARIMA model</h3>
<p>A seasonal ARIMA model is formed by including additional seasonal terms in the ARIMA models we have seen so far. It is written as follows:</p>
<p><strong>Pure seasonal ARMA Models</strong></p>
<p>For <span class="math inline">\(P,Q \geq 0\)</span> and <span class="math inline">\(s &gt; 0\)</span>, we say that a time series <span class="math inline">\(\{X_t\}\)</span> is an ARMA(P,Q)<span class="math inline">\(_s\)</span> process if <span class="math inline">\(\Phi(B^s)X_t = \Theta(B^s)Z_t\)</span>, where <span class="math display">\[
\Phi(B^s) = 1 - \sum_{j=1}^{P}\Phi_jB^{js},
\]</span> <span class="math display">\[
\Theta(B^s) = 1+ \sum_{j=1}^{Q}\Theta_jB^{js},
\]</span></p>
<p>Example: <span class="math inline">\(P=0\)</span>, <span class="math inline">\(Q=1\)</span>, <span class="math inline">\(s=12\)</span>. <span class="math inline">\(X_t=Z_t+\Theta_1Z_{t-12}\)</span>.</p>
<span class="math display">\[\begin{align*}
\gamma(0) &amp;= (1+\Theta_1^2)\sigma^2,\\
\gamma(12)&amp;= \Theta_1 \sigma^2,\\
\gamma(h) &amp;= 0, \mathrm{~for~} h = 1, 2,\ldots, 11, 13, 14, \ldots.
\end{align*}\]</span>
<p>Example: <span class="math inline">\(P=1\)</span>, <span class="math inline">\(Q=0\)</span>, <span class="math inline">\(s=12\)</span>. <span class="math inline">\(X_t=\Phi_1X_{t-12}+Z_{t}\)</span>.</p>
<span class="math display">\[\begin{align*}
\gamma(0) &amp;= \frac{\sigma^2}{1-\Phi_1^2},\\
\gamma(12i)&amp;= \frac{\sigma^2\Phi_1^i}{1-\Phi_1^2},\\
\gamma(h) &amp;= 0, \mathrm{~for~other~} h.
\end{align*}\]</span>
<p>The ACF and PACF for a seasonal ARMA(P,Q)s are zero for <span class="math inline">\(h \neq si\)</span>. For <span class="math inline">\(h = si\)</span>, they are analogous to the patterns for ARMA(p,q):</p>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-159">Table 10.2: </span>My caption
</caption>
<thead>
<tr>
<th style="text-align:left;">
Model
</th>
<th style="text-align:left;">
ACF
</th>
<th style="text-align:left;">
PACF
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
AR(P)s
</td>
<td style="text-align:left;">
decays
</td>
<td style="text-align:left;">
zero for i &gt; P
</td>
</tr>
<tr>
<td style="text-align:left;">
MA(Q)s
</td>
<td style="text-align:left;">
zero for i &gt; Q
</td>
<td style="text-align:left;">
decays
</td>
</tr>
<tr>
<td style="text-align:left;">
ARMA(P,Q)s
</td>
<td style="text-align:left;">
decays
</td>
<td style="text-align:left;">
decays
</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">death_arima &lt;-<span class="st"> </span>train <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">model</span>(
    <span class="dt">arima210 =</span> <span class="kw">ARIMA</span>(Y.Death <span class="op">~</span><span class="st"> </span><span class="kw">pdq</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">0</span>)),
    <span class="dt">arima013 =</span> <span class="kw">ARIMA</span>(Y.Death <span class="op">~</span><span class="st"> </span><span class="kw">pdq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">3</span>)),
    <span class="dt">stepwise =</span> <span class="kw">ARIMA</span>(Y.Death),
    <span class="dt">search =</span> <span class="kw">ARIMA</span>(Y.Death, <span class="dt">stepwise=</span><span class="ot">FALSE</span>)
  )
<span class="co"># Generate forecasts for the next 2 weeks</span>
death_fc &lt;-<span class="st"> </span>death_arima <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="dv">14</span>)
<span class="co"># Plot forecasts against actual values</span>
death_fc <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">autoplot</span>(train, <span class="dt">level =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">autolayer</span>(<span class="kw">filter_index</span>(dplyr<span class="op">::</span><span class="kw">select</span>(Florida.ts, Y.Death), 
                         <span class="st">&quot;2020-11-28&quot;</span> <span class="op">~</span><span class="st"> </span>.), <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Death count&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Different ARIMA Forecasts&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">colour =</span> <span class="kw">guide_legend</span>(<span class="dt">title =</span> <span class="st">&quot;Methods&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:predarima"></span>
<img src="bookdown-demo_files/figure-html/predarima-1.png" alt="Two weeks ahead forecast of the daily death count for Florida using different ARIMA models." width="672" />
<p class="caption">
Figure 10.23: Two weeks ahead forecast of the daily death count for Florida using different ARIMA models.
</p>
</div>
<p>The <code>glance()</code> function provides a one-row summary of each model, and commonly includes descriptions of the model’s fit, such as the residual variance and information criteria. It is worth noticing that the information criteria (AIC, AICc, BIC) are only comparable between the same model class and only if those models share the same response (after transformations and differencing).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">death_arima <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">glance</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">arrange</span>(AICc)</code></pre></div>
<pre><code>## # A tibble: 4 x 9
##   State .model sigma2 log_lik   AIC  AICc   BIC ar_roots
##   &lt;fct&gt; &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;list&gt;  
## 1 Flor… search   859.  -1453. 2919. 2920. 2945. &lt;cpl [3…
## 2 Flor… arima…   913.  -1458. 2926. 2926. 2945. &lt;cpl [0…
## 3 Flor… stepw…   903.  -1461. 2929. 2929. 2944. &lt;cpl [1…
## 4 Flor… arima…  1069.  -1482. 2973. 2973. 2992. &lt;cpl [2…
## # … with 1 more variable: ma_roots &lt;list&gt;</code></pre>
<p>If you’re working with a single model (or want to look at one model in particular), the <code>report()</code> function gives a familiar and nicely formatted model-specific display.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">death_arima <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(arima210) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">report</span>()</code></pre></div>
<pre><code>## Series: Y.Death 
## Model: ARIMA(2,1,0)(0,1,2)[7] 
## 
## Coefficients:
##           ar1      ar2     sma1     sma2
##       -0.5481  -0.3398  -0.5747  -0.0837
## s.e.   0.0570   0.0552   0.0601   0.0615
## 
## sigma^2 estimated as 1069:  log likelihood=-1481.63
## AIC=2973.27   AICc=2973.47   BIC=2991.82</code></pre>
</div>
</div>
<div id="model-comparison" class="section level2">
<h2><span class="header-section-number">10.7</span> Model Comparison</h2>
<p>Exponential smoothing and ARIMA models are the two most widely used approaches to time series forecasting, and provide complementary approaches to the problem. While exponential smoothing models are based on a description of the trend and seasonality in the data, ARIMA models aim to describe the autocorrelations in the data.</p>
<p>To compare how well the models fit the data, we can consider some common accuracy measures. It seems that on the training set the ETS model out-performs ARIMA for the series where travellers are on holiday, business, and visiting friends and relatives. The Evaluating modelling accuracy chapter from the <a href="https://otexts.com/fpp3/">Forecasting: Principles and Practices</a> textbook provides more detail in how modelling and forecasting accuracy is evaluated.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">death_fit &lt;-<span class="st">  </span>train <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">model</span>(
    <span class="st">`</span><span class="dt">ETS</span><span class="st">`</span> =<span class="st"> </span><span class="kw">ETS</span>(Y.Death 
                <span class="op">~</span><span class="st"> </span><span class="kw">error</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">trend</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">season</span>(<span class="st">&quot;A&quot;</span>)),  
    <span class="st">`</span><span class="dt">ARIMA</span><span class="st">`</span> =<span class="st"> </span><span class="kw">ARIMA</span>(Y.Death, <span class="dt">stepwise=</span><span class="ot">FALSE</span>)
  )

<span class="co"># Model fitting results of ARIMA</span>
death_fit <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(ARIMA) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">report</span>()</code></pre></div>
<pre><code>## Series: Y.Death 
## Model: ARIMA(3,0,2)(0,1,1)[7] 
## 
## Coefficients:
##          ar1      ar2     ar3      ma1     ma2     sma1
##       2.0725  -1.3305  0.2443  -1.8798  0.9449  -0.6705
## s.e.  0.0671   0.1278  0.0657   0.0341  0.0377   0.0648
## 
## sigma^2 estimated as 858.6:  log likelihood=-1452.72
## AIC=2919.44   AICc=2919.82   BIC=2945.43</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Evaluate the modeling and forecasting accuracy</span>
death_fit <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">accuracy</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">arrange</span>(MASE)</code></pre></div>
<pre><code>## # A tibble: 2 x 11
##   State   .model .type      ME  RMSE   MAE   MPE  MAPE  MASE
##   &lt;fct&gt;   &lt;chr&gt;  &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 Florida ARIMA  Traini… 1.00   28.7  17.7   NaN   Inf 0.813
## 2 Florida ETS    Traini… 0.138  29.9  18.2   NaN   Inf 0.835
## # … with 2 more variables: RMSSE &lt;dbl&gt;, ACF1 &lt;dbl&gt;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Generate forecasts for the next 2 weeks</span>
death_fc &lt;-<span class="st"> </span>death_fit <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="dv">14</span>)

<span class="co"># Plot forecasts against actual values</span>
death_fc <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">autoplot</span>(train, <span class="dt">level =</span> <span class="dv">95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">autolayer</span>(<span class="kw">filter_index</span>(dplyr<span class="op">::</span><span class="kw">select</span>(Florida.ts, Y.Death), 
                         <span class="st">&quot;2020-11-28&quot;</span> <span class="op">~</span><span class="st"> </span>.), <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Death count&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;ETS vs ARIMA Forecasts&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">colour =</span> <span class="kw">guide_legend</span>(<span class="dt">title =</span> <span class="st">&quot;Forecasts&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:predetsarima"></span>
<img src="bookdown-demo_files/figure-html/predetsarima-1.png" alt="Two weeks ahead forecast of the daily death count for Florida using ETS and ARIMA models." width="672" />
<p class="caption">
Figure 10.24: Two weeks ahead forecast of the daily death count for Florida using ETS and ARIMA models.
</p>
</div>
</div>
<div id="ensuring-forecasts-stay-within-limits" class="section level2">
<h2><span class="header-section-number">10.8</span> Ensuring forecasts stay within limits</h2>
<p>It is common to want forecasts to be positive, or to require them to be within some specified range <span class="math inline">\([a,b]\)</span>. Both of these situations are relatively easy to handle using transformations.</p>
<div id="positive-forecasts" class="section level3">
<h3><span class="header-section-number">10.8.1</span> Positive forecasts</h3>
<p>To impose a positivity constraint, we can simply work on the log scale. Here is an example using ETS models applied to the daily new death count time series for Florida.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">train <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">model</span>(<span class="st">`</span><span class="dt">ETS</span><span class="st">`</span> =<span class="st"> </span><span class="kw">ETS</span>(<span class="kw">log</span>(Y.Death<span class="op">+</span><span class="dv">1</span>) 
                <span class="op">~</span><span class="st"> </span><span class="kw">error</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">trend</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">season</span>(<span class="st">&quot;A&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="dv">14</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">autoplot</span>(train, <span class="dt">level =</span> <span class="dv">95</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:predetslog"></span>
<img src="bookdown-demo_files/figure-html/predetslog-1.png" alt="Two weeks ahead forecast of the daily death count for Florida using ETS, constrained to be positive." width="672" />
<p class="caption">
Figure 10.25: Two weeks ahead forecast of the daily death count for Florida using ETS, constrained to be positive.
</p>
</div>
</div>
<div id="forecasts-constrained-to-an-interval" class="section level3">
<h3><span class="header-section-number">10.8.2</span> Forecasts constrained to an interval</h3>
<p>To see how to handle data constrained to an interval, imagine that the egg prices were constrained to lie within <span class="math inline">\([a,b]\)</span>. Then we can transform the data using a scaled logit transform as follows:<br />
<span class="math display">\[
y=\log\left(\frac{x-a}{b-x}\right),
\]</span> where <span class="math inline">\(x\)</span> is on the original scale and <span class="math inline">\(y\)</span> is the transformed data. To reverse the transformation, we will use <span class="math display">\[
x=\frac{(b-a)e^y}{1+e^y}+a.
\]</span> This is not a built-in transformation, so we will need to first setup the transformation functions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">scaled_logit &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">lower =</span> <span class="dv">0</span>, <span class="dt">upper =</span> <span class="dv">1</span>){
  <span class="kw">log</span>((x <span class="op">-</span><span class="st"> </span>lower) <span class="op">/</span><span class="st"> </span>(upper <span class="op">-</span><span class="st"> </span>x))
}
inv_scaled_logit &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">lower =</span> <span class="dv">0</span>, <span class="dt">upper =</span> <span class="dv">1</span>){
  (upper <span class="op">-</span><span class="st"> </span>lower) <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(x) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(x)) <span class="op">+</span><span class="st"> </span>lower
}
my_scaled_logit &lt;-<span class="st"> </span><span class="kw">new_transformation</span>(scaled_logit, inv_scaled_logit)</code></pre></div>
<p>Now, we can make the prediction based on the transfromed time series. Let us consider the forecast within <span class="math inline">\([0,300]\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">train <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">model</span>(<span class="kw">ETS</span>(<span class="kw">my_scaled_logit</span>(Y.Death <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">lower =</span> <span class="dv">0</span>, <span class="dt">upper =</span> <span class="dv">300</span>) <span class="op">~</span><span class="st"> </span>
<span class="st">              </span><span class="kw">error</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">trend</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">season</span>(<span class="st">&quot;A&quot;</span>))) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="dv">14</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">autoplot</span>(train, <span class="dt">level =</span> <span class="dv">95</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:predetslog2"></span>
<img src="bookdown-demo_files/figure-html/predetslog2-1.png" alt="Two weeks ahead forecast of the daily death count for Florida using ETS, constrained to be within [0,300]." width="672" />
<p class="caption">
Figure 10.26: Two weeks ahead forecast of the daily death count for Florida using ETS, constrained to be within [0,300].
</p>
</div>
</div>
</div>
<div id="prediction-intervals-for-aggregates" class="section level2">
<h2><span class="header-section-number">10.9</span> Prediction intervals for aggregates</h2>
<p>We considered the daily new death count in the above sections, but we may want to forecast the cumulative count.</p>
<p>If the point forecasts are means, then adding them up will give a reasonable estimate of the total. But prediction intervals are more tricky due to the correlations between forecast errors. A general solution is to use simulations. For example, we consider the forecast of the cumulative death count in the next two weeks.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d_ets_fit &lt;-<span class="st">  </span>train <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">model</span>(
    <span class="st">`</span><span class="dt">ETS</span><span class="st">`</span> =<span class="st"> </span><span class="kw">ETS</span>(Y.Death 
                <span class="op">~</span><span class="st"> </span><span class="kw">error</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">trend</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">season</span>(<span class="st">&quot;A&quot;</span>)) 
  )

d.pred.paths &lt;-<span class="st"> </span>d_ets_fit <span class="op">%&gt;%</span>
<span class="st">  </span><span class="co"># Simulate 10000 future sample paths, each of length 14</span>
<span class="st">  </span><span class="kw">generate</span>(<span class="dt">times =</span> <span class="dv">10000</span>, <span class="dt">h =</span> <span class="dv">14</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="co"># Sum the results for each sample path</span>
<span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(.rep) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">.sim =</span> <span class="kw">as.integer</span>(.sim)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">.sim =</span> <span class="kw">replace</span>(.sim, <span class="kw">which</span>(.sim <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>), <span class="dv">0</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">.csum =</span> <span class="kw">cumsum</span>(.sim))</code></pre></div>
<p>We can compute the mean of the simulations, and extract a specified prediction interval at a particular confidence level. For example,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d.pred.report &lt;-<span class="st"> </span>d.pred.paths <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(DATE) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">.mean =</span> <span class="kw">mean</span>(.csum),
            <span class="dt">.lpi95 =</span> <span class="kw">quantile</span>(.csum, .<span class="dv">025</span>), 
            <span class="dt">.upi95 =</span> <span class="kw">quantile</span>(.csum, .<span class="dv">975</span>),
            ) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">.mean =</span> .mean <span class="op">+</span><span class="st"> </span><span class="kw">tail</span>(train<span class="op">$</span>Death,<span class="dv">1</span>),
         <span class="dt">.lpi95 =</span> .lpi95 <span class="op">+</span><span class="st"> </span><span class="kw">tail</span>(train<span class="op">$</span>Death,<span class="dv">1</span>),
         <span class="dt">.upi95 =</span> .upi95 <span class="op">+</span><span class="st"> </span><span class="kw">tail</span>(train<span class="op">$</span>Death,<span class="dv">1</span>)
         )</code></pre></div>
<p>Figure @(fig:predcum) shows the two weeks ahead forecast of the cumulative death count for Florida using ETS.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(DATE, Death)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Days&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Count&quot;</span>, 
       <span class="dt">title =</span> <span class="st">&#39;Daily new Death cases and prediction&#39;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="co"># Add prediction intervals</span>
<span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> DATE, 
                            <span class="dt">y =</span> .mean, 
                            <span class="dt">ymin =</span> .lpi95, 
                            <span class="dt">ymax =</span> .upi95,
                            <span class="dt">fill =</span> <span class="st">&#39;95% Prediction Band&#39;</span>), 
              <span class="dt">data =</span> d.pred.report, <span class="dt">alpha =</span> <span class="fl">0.4</span>) <span class="op">+</span>
<span class="st">  </span><span class="co"># Add line for predicted values</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> DATE, 
                          <span class="dt">y =</span> .mean,
                          <span class="dt">colour =</span> <span class="st">&#39;Predicted Value&#39;</span>),
            <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">data =</span> d.pred.report,
            <span class="co"># Set the line type in legend</span>
            <span class="dt">key_glyph =</span> <span class="st">&quot;timeseries&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">scale_colour_manual</span>(<span class="st">&quot;&quot;</span>, <span class="dt">values =</span> <span class="st">&quot;red&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="st">&quot;&quot;</span>, <span class="dt">values =</span> <span class="st">&quot;pink&quot;</span>) 
p </code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:predcum"></span>
<img src="bookdown-demo_files/figure-html/predcum-1.png" alt="Two weeks ahead forecast of the cumulative death count for Florida using ETS." width="672" />
<p class="caption">
Figure 10.27: Two weeks ahead forecast of the cumulative death count for Florida using ETS.
</p>
</div>
</div>
<div id="exercises-4" class="section level2">
<h2><span class="header-section-number">10.10</span> Exercises</h2>
<ol style="list-style-type: decimal">
<li>Download the file <code>tute1.csv</code> from the book website, open it in Excel (or some other spreadsheet application), and review its contents. You should find four columns of information. Columns B through D each contain a quarterly series, labelled Sales, AdBudget and GDP.</li>
</ol>
<p>You can read the data into R with the following script:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tute1 &lt;-<span class="st"> </span>readr<span class="op">::</span><span class="kw">read_csv</span>(<span class="st">&quot;tute1.csv&quot;</span>)
<span class="kw">View</span>(tute1)</code></pre></div>
<ol style="list-style-type: lower-alpha">
<li>Convert the data to time series</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mytimeseries &lt;-<span class="st"> </span>tute1 <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Quarter =</span> <span class="kw">yearmonth</span>(Quarter)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">as_tsibble</span>(<span class="dt">index =</span> Quarter)</code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>Construct time series plots of each of the three series</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mytimeseries <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">pivot_longer</span>(<span class="op">-</span>Quarter, <span class="dt">names_to=</span><span class="st">&quot;Key&quot;</span>, <span class="dt">values_to=</span><span class="st">&quot;Value&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Quarter, <span class="dt">y =</span> Value, <span class="dt">colour =</span> Key)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">facet_grid</span>(<span class="kw">vars</span>(Key), <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>)</code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Use the following graphics functions: <code>autoplot()</code>, <code>gg_season()</code>, <code>gg_subseries()</code>, <code>gg_lag()</code>, <code>ACF()</code> and explore features from the following time series:</li>
</ol>
<ol style="list-style-type: lower-alpha">
<li>Can you spot any seasonality and trend?</li>
<li>What do you learn about the series?</li>
<li>What can you say about the seasonal patterns?</li>
<li>Can you identify any unusual years?</li>
</ol>
<ol start="3" style="list-style-type: decimal">
<li>For your retail time series (???):</li>
</ol>
<ol style="list-style-type: lower-alpha">
<li>Create a training dataset consisting of observations before 2011 using</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myts_train &lt;-<span class="st"> </span>myts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(Month <span class="op">&lt;=</span><span class="st"> </span><span class="kw">yearmonth</span>(<span class="st">&quot;2010 Dec&quot;</span>))</code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>Check that your data have been split appropriately by producing the following plot.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">autoplot</span>(myts) <span class="op">+</span>
<span class="st">  </span><span class="kw">autolayer</span>(myts_train, <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>)</code></pre></div>
<ol start="3" style="list-style-type: lower-alpha">
<li>Calculate seasonal naïve forecasts using SNAIVE() applied to your training data (myts_train).</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit &lt;-<span class="st"> </span>myts_train <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">model</span>(<span class="kw">SNAIVE</span>())
fc &lt;-<span class="st"> </span>fit <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">forecast</span>()</code></pre></div>
<ol start="4" style="list-style-type: lower-alpha">
<li>Compare the accuracy of your forecasts against the actual values.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">accuracy</span>()
fc <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">accuracy</span>(myts)</code></pre></div>
<ol start="5" style="list-style-type: lower-alpha">
<li>Check the residuals.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gg_tsresiduals</span>()
Do the residuals appear to be uncorrelated and normally distributed?</code></pre></div>
<ol start="6" style="list-style-type: lower-alpha">
<li>How sensitive are the accuracy measures to the amount of training data used?</li>
</ol>
</div>
<div id="references" class="section level2">
<h2><span class="header-section-number">10.11</span> References</h2>
<p><span class="citation">Hyndman and Athanasopoulos (<a href="#ref-Hyndman2018">2018</a>)</span></p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-altieri2020curating">
<p>Altieri, Nick, Rebecca L Barter, James Duncan, Raaz Dwivedi, Karl Kumbier, Xiao Li, Robert Netzorg, et al. 2020. “Curating a COVID-19 Data Repository and Forecasting County-Level Death Counts in the United States.” <em>arXiv</em>. doi:<a href="https://doi.org/10.1162/99608f92.1d4e0dae">10.1162/99608f92.1d4e0dae</a>.</p>
</div>
<div id="ref-Cleveland1990">
<p>Cleveland, Robert B, William S Cleveland, Jean E McRae, and Irma Terpenning. 1990. “STL: A Seasonal-Trend Decomposition.” <em>Journal of Official Statistics</em> 6 (1): 3–73.</p>
</div>
<div id="ref-Hyndman2018">
<p>Hyndman, Rob J, and George Athanasopoulos. 2018. <em>Forecasting: Principles and Practice</em>. OTexts.</p>
</div>
<div id="ref-wang:2020:comparing">
<p>Wang, Guannan, Zhiling Gu, Xinyi Li, Shan Yu, Myungjin Kim, Yueying Wang, Lei Gao, and Li Wang. 2020. “Comparing and Integrating US COVID-19 Daily Data from Multiple Sources: A County-Level Dataset with Local Characteristics.” Available at <a href="https://arxiv.org/abs/2006.01333v3" class="uri">https://arxiv.org/abs/2006.01333v3</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="NN.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/09-time_series.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
