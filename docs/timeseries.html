<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 Time Series Analysis of Infectious Disease Data | Statistical Learning of Infectious Disease Data Analytics</title>
  <meta name="description" content="The use of statistical models to understand infectious disease dynamics has a very rich history in epidemiology. This book introduces modern statistical models and state-of-the-art learning methods to analyze infectious disease data. Many of the key approaches, examples and case studies will be presented. The primary emphasis will be interpretation, inference and hands-on data analyses. This course also provides practical concepts and R computing skills to perform infectious disease data analysis and visualization." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 Time Series Analysis of Infectious Disease Data | Statistical Learning of Infectious Disease Data Analytics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="The use of statistical models to understand infectious disease dynamics has a very rich history in epidemiology. This book introduces modern statistical models and state-of-the-art learning methods to analyze infectious disease data. Many of the key approaches, examples and case studies will be presented. The primary emphasis will be interpretation, inference and hands-on data analyses. This course also provides practical concepts and R computing skills to perform infectious disease data analysis and visualization." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 Time Series Analysis of Infectious Disease Data | Statistical Learning of Infectious Disease Data Analytics" />
  
  <meta name="twitter:description" content="The use of statistical models to understand infectious disease dynamics has a very rich history in epidemiology. This book introduces modern statistical models and state-of-the-art learning methods to analyze infectious disease data. Many of the key approaches, examples and case studies will be presented. The primary emphasis will be interpretation, inference and hands-on data analyses. This course also provides practical concepts and R computing skills to perform infectious disease data analysis and visualization." />
  

<meta name="author" content="Lily Wang" />


<meta name="date" content="2021-04-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="compartment.html"/>
<link rel="next" href="regression.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.3.9000/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#data-sets-used-in-labs-and-exercises"><i class="fa fa-check"></i><b>1.1</b> Data Sets Used in Labs and Exercises</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>1.2</b> Acknowledgements</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#about-the-author"><i class="fa fa-check"></i><b>1.3</b> About the Author</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#aims-and-scope-of-this-book"><i class="fa fa-check"></i><b>2.1</b> Aims and Scope of This Book</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#the-structure-of-this-book"><i class="fa fa-check"></i><b>2.2</b> The Structure of This Book</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="intro.html"><a href="intro.html#infectious-disease-data"><i class="fa fa-check"></i><b>2.2.1</b> Infectious disease data</a></li>
<li class="chapter" data-level="2.2.2" data-path="intro.html"><a href="intro.html#basic-characteristics-of-the-infection-process"><i class="fa fa-check"></i><b>2.2.2</b> Basic characteristics of the infection process</a></li>
<li class="chapter" data-level="2.2.3" data-path="intro.html"><a href="intro.html#data-visualization"><i class="fa fa-check"></i><b>2.2.3</b> Data visualization</a></li>
<li class="chapter" data-level="2.2.4" data-path="intro.html"><a href="intro.html#modeling-and-forecasting"><i class="fa fa-check"></i><b>2.2.4</b> Modeling and Forecasting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="dplyr.html"><a href="dplyr.html"><i class="fa fa-check"></i><b>3</b> Data Wrangling with <code>dplyr</code> and <code>tidyr</code></a>
<ul>
<li class="chapter" data-level="3.1" data-path="dplyr.html"><a href="dplyr.html#learning-dplyr"><i class="fa fa-check"></i><b>3.1</b> Learning <code>dplyr</code></a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="dplyr.html"><a href="dplyr.html#tibbles"><i class="fa fa-check"></i><b>3.1.1</b> Tibbles</a></li>
<li class="chapter" data-level="3.1.2" data-path="dplyr.html"><a href="dplyr.html#import-data"><i class="fa fa-check"></i><b>3.1.2</b> Import data</a></li>
<li class="chapter" data-level="3.1.3" data-path="dplyr.html"><a href="dplyr.html#common-dplyr-functions"><i class="fa fa-check"></i><b>3.1.3</b> Common <code>dplyr</code> functions</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="dplyr.html"><a href="dplyr.html#selecting-columns-and-filtering-rows"><i class="fa fa-check"></i><b>3.2</b> Selecting Columns and Filtering Rows</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="dplyr.html"><a href="dplyr.html#subset-variables-columns"><i class="fa fa-check"></i><b>3.2.1</b> Subset Variables (Columns)</a></li>
<li class="chapter" data-level="3.2.2" data-path="dplyr.html"><a href="dplyr.html#subset-observations-rows"><i class="fa fa-check"></i><b>3.2.2</b> Subset Observations (Rows)</a></li>
<li class="chapter" data-level="3.2.3" data-path="dplyr.html"><a href="dplyr.html#pipes"><i class="fa fa-check"></i><b>3.2.3</b> Pipes</a></li>
<li class="chapter" data-level="3.2.4" data-path="dplyr.html"><a href="dplyr.html#select-and-order-top-n-entries-by-group-if-grouped-data."><i class="fa fa-check"></i><b>3.2.4</b> Select and order top n entries (by group if grouped data).</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="dplyr.html"><a href="dplyr.html#make-new-variables-mutate"><i class="fa fa-check"></i><b>3.3</b> Make New Variables: Mutate</a></li>
<li class="chapter" data-level="3.4" data-path="dplyr.html"><a href="dplyr.html#summarize-data"><i class="fa fa-check"></i><b>3.4</b> Summarize Data</a></li>
<li class="chapter" data-level="3.5" data-path="dplyr.html"><a href="dplyr.html#combine-data-sets"><i class="fa fa-check"></i><b>3.5</b> Combine Data Sets</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="dplyr.html"><a href="dplyr.html#the-join-family"><i class="fa fa-check"></i><b>3.5.1</b> The join family</a></li>
<li class="chapter" data-level="3.5.2" data-path="dplyr.html"><a href="dplyr.html#toy-examples-with-joins"><i class="fa fa-check"></i><b>3.5.2</b> Toy examples with joins</a></li>
<li class="chapter" data-level="3.5.3" data-path="dplyr.html"><a href="dplyr.html#practice-with-joins-for-real-data"><i class="fa fa-check"></i><b>3.5.3</b> Practice with joins for real data</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="dplyr.html"><a href="dplyr.html#reshaping-data"><i class="fa fa-check"></i><b>3.6</b> Reshaping Data</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="dplyr.html"><a href="dplyr.html#from-wide-to-long"><i class="fa fa-check"></i><b>3.6.1</b> From wide to long</a></li>
<li class="chapter" data-level="3.6.2" data-path="dplyr.html"><a href="dplyr.html#from-long-to-wide"><i class="fa fa-check"></i><b>3.6.2</b> From long to wide</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="dplyr.html"><a href="dplyr.html#exercises"><i class="fa fa-check"></i><b>3.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>4</b> Data Visualization with ggplot2</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ggplot2.html"><a href="ggplot2.html#introduction"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="ggplot2.html"><a href="ggplot2.html#types-of-variables-and-preparation"><i class="fa fa-check"></i><b>4.2</b> Types of Variables and Preparation</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="ggplot2.html"><a href="ggplot2.html#types-of-variables"><i class="fa fa-check"></i><b>4.2.1</b> Types of Variables</a></li>
<li class="chapter" data-level="4.2.2" data-path="ggplot2.html"><a href="ggplot2.html#rules-for-graph-designing"><i class="fa fa-check"></i><b>4.2.2</b> Rules for Graph Designing</a></li>
<li class="chapter" data-level="4.2.3" data-path="ggplot2.html"><a href="ggplot2.html#installing-packages-and-loading-data"><i class="fa fa-check"></i><b>4.2.3</b> Installing packages and loading data</a></li>
<li class="chapter" data-level="4.2.4" data-path="ggplot2.html"><a href="ggplot2.html#your-first-scatterplot"><i class="fa fa-check"></i><b>4.2.4</b> Your first scatterplot</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="ggplot2.html"><a href="ggplot2.html#position-scales-and-axes"><i class="fa fa-check"></i><b>4.3</b> Position Scales and Axes</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="ggplot2.html"><a href="ggplot2.html#change-the-labels-of-the-axis-using-xlab-and-ylab"><i class="fa fa-check"></i><b>4.3.1</b> Change the labels of the axis using <code>xlab()</code> and <code>ylab()</code></a></li>
<li class="chapter" data-level="4.3.2" data-path="ggplot2.html"><a href="ggplot2.html#change-the-range-of-the-axis-using-xlim-and-ylim"><i class="fa fa-check"></i><b>4.3.2</b> Change the range of the axis using <code>xlim()</code> and <code>ylim()</code></a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="ggplot2.html"><a href="ggplot2.html#color-scales-and-size-of-geom_points"><i class="fa fa-check"></i><b>4.4</b> Color Scales and Size of <code>geom_points()</code></a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="ggplot2.html"><a href="ggplot2.html#change-the-color-of-all-points"><i class="fa fa-check"></i><b>4.4.1</b> Change the color of all points</a></li>
<li class="chapter" data-level="4.4.2" data-path="ggplot2.html"><a href="ggplot2.html#color-the-observations-by-the-value-of-a-feature"><i class="fa fa-check"></i><b>4.4.2</b> Color the observations by the value of a feature</a></li>
<li class="chapter" data-level="4.4.3" data-path="ggplot2.html"><a href="ggplot2.html#change-the-color-palette"><i class="fa fa-check"></i><b>4.4.3</b> Change the color palette</a></li>
<li class="chapter" data-level="4.4.4" data-path="ggplot2.html"><a href="ggplot2.html#change-the-size-by-the-value-of-a-feature"><i class="fa fa-check"></i><b>4.4.4</b> Change the size by the value of a feature</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="ggplot2.html"><a href="ggplot2.html#individual-geoms"><i class="fa fa-check"></i><b>4.5</b> Individual geoms</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="ggplot2.html"><a href="ggplot2.html#histogram"><i class="fa fa-check"></i><b>4.5.1</b> Histogram</a></li>
<li class="chapter" data-level="4.5.2" data-path="ggplot2.html"><a href="ggplot2.html#bar-chart"><i class="fa fa-check"></i><b>4.5.2</b> Bar chart</a></li>
<li class="chapter" data-level="4.5.3" data-path="ggplot2.html"><a href="ggplot2.html#default-bar-chart"><i class="fa fa-check"></i><b>4.5.3</b> Default bar chart</a></li>
<li class="chapter" data-level="4.5.4" data-path="ggplot2.html"><a href="ggplot2.html#bar-chart-with-assigned-value"><i class="fa fa-check"></i><b>4.5.4</b> Bar chart with assigned value</a></li>
<li class="chapter" data-level="4.5.5" data-path="ggplot2.html"><a href="ggplot2.html#legend"><i class="fa fa-check"></i><b>4.5.5</b> Legend</a></li>
<li class="chapter" data-level="4.5.6" data-path="ggplot2.html"><a href="ggplot2.html#boxplots-jittering-and-violin-plots"><i class="fa fa-check"></i><b>4.5.6</b> Boxplots, jittering and violin plots</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="ggplot2.html"><a href="ggplot2.html#collective-geoms"><i class="fa fa-check"></i><b>4.6</b> Collective geoms</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="ggplot2.html"><a href="ggplot2.html#smoother"><i class="fa fa-check"></i><b>4.6.1</b> Smoother</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="ggplot2.html"><a href="ggplot2.html#time-series"><i class="fa fa-check"></i><b>4.7</b> Time Series</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="ggplot2.html"><a href="ggplot2.html#basic-line-plots"><i class="fa fa-check"></i><b>4.7.1</b> Basic line plots</a></li>
<li class="chapter" data-level="4.7.2" data-path="ggplot2.html"><a href="ggplot2.html#add-a-second-line"><i class="fa fa-check"></i><b>4.7.2</b> Add a second line</a></li>
<li class="chapter" data-level="4.7.3" data-path="ggplot2.html"><a href="ggplot2.html#add-ribbons"><i class="fa fa-check"></i><b>4.7.3</b> Add ribbons</a></li>
<li class="chapter" data-level="4.7.4" data-path="ggplot2.html"><a href="ggplot2.html#adjust-the-scale-of-time-axis"><i class="fa fa-check"></i><b>4.7.4</b> Adjust the scale of time axis</a></li>
<li class="chapter" data-level="4.7.5" data-path="ggplot2.html"><a href="ggplot2.html#add-annotations"><i class="fa fa-check"></i><b>4.7.5</b> Add annotations</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="ggplot2.html"><a href="ggplot2.html#maps"><i class="fa fa-check"></i><b>4.8</b> Maps</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="ggplot2.html"><a href="ggplot2.html#making-a-base-map"><i class="fa fa-check"></i><b>4.8.1</b> Making a base map</a></li>
<li class="chapter" data-level="4.8.2" data-path="ggplot2.html"><a href="ggplot2.html#customizing-choropleth-map"><i class="fa fa-check"></i><b>4.8.2</b> Customizing <code>choropleth</code> map</a></li>
<li class="chapter" data-level="4.8.3" data-path="ggplot2.html"><a href="ggplot2.html#overlay-polygon-maps"><i class="fa fa-check"></i><b>4.8.3</b> Overlay polygon maps</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="ggplot2.html"><a href="ggplot2.html#arranging-plots"><i class="fa fa-check"></i><b>4.9</b> Arranging Plots</a>
<ul>
<li class="chapter" data-level="4.9.1" data-path="ggplot2.html"><a href="ggplot2.html#facet"><i class="fa fa-check"></i><b>4.9.1</b> Facet</a></li>
<li class="chapter" data-level="4.9.2" data-path="ggplot2.html"><a href="ggplot2.html#combining-plots-using-patchwork-package"><i class="fa fa-check"></i><b>4.9.2</b> Combining plots using <code>patchwork</code> package</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="ggplot2.html"><a href="ggplot2.html#output"><i class="fa fa-check"></i><b>4.10</b> Output</a>
<ul>
<li class="chapter" data-level="4.10.1" data-path="ggplot2.html"><a href="ggplot2.html#save-in-figure-format"><i class="fa fa-check"></i><b>4.10.1</b> Save in figure format</a></li>
<li class="chapter" data-level="4.10.2" data-path="ggplot2.html"><a href="ggplot2.html#save-in-rds-format"><i class="fa fa-check"></i><b>4.10.2</b> Save in RDS format</a></li>
</ul></li>
<li class="chapter" data-level="4.11" data-path="ggplot2.html"><a href="ggplot2.html#exercises-1"><i class="fa fa-check"></i><b>4.11</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="plotly.html"><a href="plotly.html"><i class="fa fa-check"></i><b>5</b> Interactive Visualization</a>
<ul>
<li class="chapter" data-level="5.1" data-path="plotly.html"><a href="plotly.html#an-introduction"><i class="fa fa-check"></i><b>5.1</b> An Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="plotly.html"><a href="plotly.html#creating-plotly-objects"><i class="fa fa-check"></i><b>5.2</b> Creating Plotly Objects</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="plotly.html"><a href="plotly.html#using-plot_ly-to-create-a-plotly-object"><i class="fa fa-check"></i><b>5.2.1</b> Using <code>plot_ly()</code> to create a plotly object</a></li>
<li class="chapter" data-level="5.2.2" data-path="plotly.html"><a href="plotly.html#use-dplyr-verbs-to-modify-data"><i class="fa fa-check"></i><b>5.2.2</b> Use <code>dplyr</code> verbs to modify data</a></li>
<li class="chapter" data-level="5.2.3" data-path="plotly.html"><a href="plotly.html#using-ggplotly-to-create-a-plotly-object"><i class="fa fa-check"></i><b>5.2.3</b> Using <code>ggplotly()</code> to create a <code>plotly</code> object</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="plotly.html"><a href="plotly.html#scatterplots-and-line-plots"><i class="fa fa-check"></i><b>5.3</b> Scatterplots and Line Plots</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="plotly.html"><a href="plotly.html#make-a-scatterplot"><i class="fa fa-check"></i><b>5.3.1</b> Make a scatterplot</a></li>
<li class="chapter" data-level="5.3.2" data-path="plotly.html"><a href="plotly.html#markers"><i class="fa fa-check"></i><b>5.3.2</b> Markers</a></li>
<li class="chapter" data-level="5.3.3" data-path="plotly.html"><a href="plotly.html#a-single-time-series-plot"><i class="fa fa-check"></i><b>5.3.3</b> A single time series plot</a></li>
<li class="chapter" data-level="5.3.4" data-path="plotly.html"><a href="plotly.html#hover-text-and-template"><i class="fa fa-check"></i><b>5.3.4</b> Hover text and template</a></li>
<li class="chapter" data-level="5.3.5" data-path="plotly.html"><a href="plotly.html#multiple-time-series-plots"><i class="fa fa-check"></i><b>5.3.5</b> Multiple time series plots</a></li>
<li class="chapter" data-level="5.3.6" data-path="plotly.html"><a href="plotly.html#more-features-about-the-lines"><i class="fa fa-check"></i><b>5.3.6</b> More features about the lines</a></li>
<li class="chapter" data-level="5.3.7" data-path="plotly.html"><a href="plotly.html#add-ribbons-1"><i class="fa fa-check"></i><b>5.3.7</b> Add ribbons</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="plotly.html"><a href="plotly.html#pie-charts"><i class="fa fa-check"></i><b>5.4</b> Pie Charts</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="plotly.html"><a href="plotly.html#draw-static-pie-charts-using-ggplot2"><i class="fa fa-check"></i><b>5.4.1</b> Draw static pie charts using ggplot2</a></li>
<li class="chapter" data-level="5.4.2" data-path="plotly.html"><a href="plotly.html#draw-interactive-pie-charts"><i class="fa fa-check"></i><b>5.4.2</b> Draw interactive pie charts</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="plotly.html"><a href="plotly.html#animation"><i class="fa fa-check"></i><b>5.5</b> Animation</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="plotly.html"><a href="plotly.html#an-animation-of-the-evolution-of-infected-vs.-death-count"><i class="fa fa-check"></i><b>5.5.1</b> An animation of the evolution of infected vs. death count</a></li>
<li class="chapter" data-level="5.5.2" data-path="plotly.html"><a href="plotly.html#an-animation-of-the-state-level-time-series-plot-of-infected-count"><i class="fa fa-check"></i><b>5.5.2</b> An animation of the state-level time series plot of infected count</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="plotly.html"><a href="plotly.html#saving-html"><i class="fa fa-check"></i><b>5.6</b> Saving HTML</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="plotly.html"><a href="plotly.html#save-as-a-standalone-html-file"><i class="fa fa-check"></i><b>5.6.1</b> Save as a standalone HTML file</a></li>
<li class="chapter" data-level="5.6.2" data-path="plotly.html"><a href="plotly.html#save-as-non-selfcontained-html-file"><i class="fa fa-check"></i><b>5.6.2</b> Save as non-selfcontained HTML file</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="plotly.html"><a href="plotly.html#exercises-2"><i class="fa fa-check"></i><b>5.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="shiny.html"><a href="shiny.html"><i class="fa fa-check"></i><b>6</b> R Shiny</a>
<ul>
<li class="chapter" data-level="6.1" data-path="shiny.html"><a href="shiny.html#an-introduction-to-shiny"><i class="fa fa-check"></i><b>6.1</b> An Introduction to Shiny</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="shiny.html"><a href="shiny.html#your-first-shiny-app"><i class="fa fa-check"></i><b>6.1.1</b> Your first shiny app</a></li>
<li class="chapter" data-level="6.1.2" data-path="shiny.html"><a href="shiny.html#create-a-new-shiny-app-in-rstudio"><i class="fa fa-check"></i><b>6.1.2</b> Create a new shiny app in RStudio</a></li>
<li class="chapter" data-level="6.1.3" data-path="shiny.html"><a href="shiny.html#share-your-app"><i class="fa fa-check"></i><b>6.1.3</b> Share your app</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="shiny.html"><a href="shiny.html#useful-input-widgets"><i class="fa fa-check"></i><b>6.2</b> Useful Input Widgets</a></li>
<li class="chapter" data-level="6.3" data-path="shiny.html"><a href="shiny.html#displaying-reactive-output"><i class="fa fa-check"></i><b>6.3</b> Displaying Reactive Output</a></li>
<li class="chapter" data-level="6.4" data-path="shiny.html"><a href="shiny.html#rendering-plotly-inside-shiny"><i class="fa fa-check"></i><b>6.4</b> Rendering Plotly Inside Shiny</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="map.html"><a href="map.html"><i class="fa fa-check"></i><b>7</b> Interactive Geospatial Visualization</a>
<ul>
<li class="chapter" data-level="7.1" data-path="map.html"><a href="map.html#an-introduction-to-leaflet"><i class="fa fa-check"></i><b>7.1</b> An Introduction to Leaflet</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="map.html"><a href="map.html#more-references"><i class="fa fa-check"></i><b>7.1.1</b> More References</a></li>
<li class="chapter" data-level="7.1.2" data-path="map.html"><a href="map.html#features-and-installation"><i class="fa fa-check"></i><b>7.1.2</b> Features and installation</a></li>
<li class="chapter" data-level="7.1.3" data-path="map.html"><a href="map.html#basic-usage"><i class="fa fa-check"></i><b>7.1.3</b> Basic Usage</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="map.html"><a href="map.html#the-data-object"><i class="fa fa-check"></i><b>7.2</b> The Data Object</a></li>
<li class="chapter" data-level="7.3" data-path="map.html"><a href="map.html#choropleth-map"><i class="fa fa-check"></i><b>7.3</b> Choropleth map</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="map.html"><a href="map.html#create-a-base-map"><i class="fa fa-check"></i><b>7.3.1</b> Create a base map</a></li>
<li class="chapter" data-level="7.3.2" data-path="map.html"><a href="map.html#color-the-map"><i class="fa fa-check"></i><b>7.3.2</b> Color the map</a></li>
<li class="chapter" data-level="7.3.3" data-path="map.html"><a href="map.html#interactive-map"><i class="fa fa-check"></i><b>7.3.3</b> Interactive map</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="map.html"><a href="map.html#legend-1"><i class="fa fa-check"></i><b>7.4</b> Legend</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="map.html"><a href="map.html#classification-schemes"><i class="fa fa-check"></i><b>7.4.1</b> Classification schemes</a></li>
<li class="chapter" data-level="7.4.2" data-path="map.html"><a href="map.html#mapping-variables-to-colors"><i class="fa fa-check"></i><b>7.4.2</b> Mapping variables to colors</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="map.html"><a href="map.html#an-example-of-county-level-map"><i class="fa fa-check"></i><b>7.5</b> An Example of County-level Map</a></li>
<li class="chapter" data-level="7.6" data-path="map.html"><a href="map.html#spot-maps"><i class="fa fa-check"></i><b>7.6</b> Spot Maps</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="map.html"><a href="map.html#adding-circles"><i class="fa fa-check"></i><b>7.6.1</b> Adding circles</a></li>
<li class="chapter" data-level="7.6.2" data-path="map.html"><a href="map.html#add-popups"><i class="fa fa-check"></i><b>7.6.2</b> Add popups</a></li>
<li class="chapter" data-level="7.6.3" data-path="map.html"><a href="map.html#add-labels"><i class="fa fa-check"></i><b>7.6.3</b> Add labels</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="map.html"><a href="map.html#integrating-leaflet-with-r-shiny"><i class="fa fa-check"></i><b>7.7</b> Integrating Leaflet with R Shiny</a></li>
<li class="chapter" data-level="7.8" data-path="map.html"><a href="map.html#exercises-3"><i class="fa fa-check"></i><b>7.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="modeling.html"><a href="modeling.html"><i class="fa fa-check"></i><b>8</b> Epidemic Modeling</a>
<ul>
<li class="chapter" data-level="8.1" data-path="modeling.html"><a href="modeling.html#an-introduction-to-epidemic-modeling"><i class="fa fa-check"></i><b>8.1</b> An Introduction to Epidemic Modeling</a></li>
<li class="chapter" data-level="8.2" data-path="modeling.html"><a href="modeling.html#mechanistic-models"><i class="fa fa-check"></i><b>8.2</b> Mechanistic Models</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="modeling.html"><a href="modeling.html#compartment-modeling"><i class="fa fa-check"></i><b>8.2.1</b> Compartment Modeling</a></li>
<li class="chapter" data-level="8.2.2" data-path="modeling.html"><a href="modeling.html#agent-based-methods"><i class="fa fa-check"></i><b>8.2.2</b> Agent-based Methods</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="modeling.html"><a href="modeling.html#phenomenological-models"><i class="fa fa-check"></i><b>8.3</b> Phenomenological Models</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="modeling.html"><a href="modeling.html#time-series-analysis"><i class="fa fa-check"></i><b>8.3.1</b> Time Series Analysis</a></li>
<li class="chapter" data-level="8.3.2" data-path="modeling.html"><a href="modeling.html#regression-methods"><i class="fa fa-check"></i><b>8.3.2</b> Regression methods</a></li>
<li class="chapter" data-level="8.3.3" data-path="modeling.html"><a href="modeling.html#machine-learning-methods"><i class="fa fa-check"></i><b>8.3.3</b> Machine learning methods</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="modeling.html"><a href="modeling.html#hybrid-models-and-ensemble-methods"><i class="fa fa-check"></i><b>8.4</b> Hybrid Models and Ensemble Methods</a></li>
<li class="chapter" data-level="8.5" data-path="modeling.html"><a href="modeling.html#epidemic-modeling-mathematical-and-statistical-perspectives"><i class="fa fa-check"></i><b>8.5</b> Epidemic Modeling: Mathematical and Statistical Perspectives</a></li>
<li class="chapter" data-level="8.6" data-path="modeling.html"><a href="modeling.html#some-terminologies-in-epidemic-modeling"><i class="fa fa-check"></i><b>8.6</b> Some Terminologies in Epidemic Modeling</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="compartment.html"><a href="compartment.html"><i class="fa fa-check"></i><b>9</b> Compartment Models</a>
<ul>
<li class="chapter" data-level="9.1" data-path="compartment.html"><a href="compartment.html#a-simple-sis-model-a-model-for-diseases-with-no-immunity"><i class="fa fa-check"></i><b>9.1</b> A Simple SIS Model (A Model for Diseases with No Immunity)</a></li>
<li class="chapter" data-level="9.2" data-path="compartment.html"><a href="compartment.html#an-sir-model"><i class="fa fa-check"></i><b>9.2</b> An SIR Model</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="compartment.html"><a href="compartment.html#an-sir-model-with-births-and-deaths"><i class="fa fa-check"></i><b>9.2.1</b> An SIR model with births and deaths</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="compartment.html"><a href="compartment.html#sir-parameter-estimation"><i class="fa fa-check"></i><b>9.3</b> SIR parameter estimation</a></li>
<li class="chapter" data-level="9.4" data-path="compartment.html"><a href="compartment.html#implementation-of-parameter-estimation-in-r"><i class="fa fa-check"></i><b>9.4</b> Implementation of parameter estimation in R</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="compartment.html"><a href="compartment.html#example-1.-outbreak-of-measles-in-niamey"><i class="fa fa-check"></i><b>9.4.1</b> Example 1. Outbreak of measles in Niamey</a></li>
<li class="chapter" data-level="9.4.2" data-path="compartment.html"><a href="compartment.html#example-2.-covid-19"><i class="fa fa-check"></i><b>9.4.2</b> Example 2. COVID-19</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="compartment.html"><a href="compartment.html#basic-reproduction-number"><i class="fa fa-check"></i><b>9.5</b> Basic Reproduction Number</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="compartment.html"><a href="compartment.html#seir-model"><i class="fa fa-check"></i><b>9.5.1</b> SEIR Model</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="compartment.html"><a href="compartment.html#herd-immunity"><i class="fa fa-check"></i><b>9.6</b> Herd Immunity</a></li>
<li class="chapter" data-level="9.7" data-path="compartment.html"><a href="compartment.html#exercises-4"><i class="fa fa-check"></i><b>9.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="timeseries.html"><a href="timeseries.html"><i class="fa fa-check"></i><b>10</b> Time Series Analysis of Infectious Disease Data</a>
<ul>
<li class="chapter" data-level="10.1" data-path="timeseries.html"><a href="timeseries.html#datasets-and-r-packages"><i class="fa fa-check"></i><b>10.1</b> Datasets and R Packages</a></li>
<li class="chapter" data-level="10.2" data-path="timeseries.html"><a href="timeseries.html#an-introduction-to-time-series-analysis"><i class="fa fa-check"></i><b>10.2</b> An Introduction to Time Series Analysis</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="timeseries.html"><a href="timeseries.html#tsibble-objects"><i class="fa fa-check"></i><b>10.2.1</b> “tsibble” objects</a></li>
<li class="chapter" data-level="10.2.2" data-path="timeseries.html"><a href="timeseries.html#working-with-tsibble-objects"><i class="fa fa-check"></i><b>10.2.2</b> Working with “tsibble” objects</a></li>
<li class="chapter" data-level="10.2.3" data-path="timeseries.html"><a href="timeseries.html#drawing-time-series-plots"><i class="fa fa-check"></i><b>10.2.3</b> Drawing time series plots</a></li>
<li class="chapter" data-level="10.2.4" data-path="timeseries.html"><a href="timeseries.html#objectives-of-time-series-analysis"><i class="fa fa-check"></i><b>10.2.4</b> Objectives of Time Series Analysis</a></li>
<li class="chapter" data-level="10.2.5" data-path="timeseries.html"><a href="timeseries.html#stationarity"><i class="fa fa-check"></i><b>10.2.5</b> Stationarity</a></li>
<li class="chapter" data-level="10.2.6" data-path="timeseries.html"><a href="timeseries.html#autocorrelation"><i class="fa fa-check"></i><b>10.2.6</b> Autocorrelation</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="timeseries.html"><a href="timeseries.html#time-series-decomposition"><i class="fa fa-check"></i><b>10.3</b> Time Series Decomposition</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="timeseries.html"><a href="timeseries.html#box-cox-transformations"><i class="fa fa-check"></i><b>10.3.1</b> Box-Cox transformations</a></li>
<li class="chapter" data-level="10.3.2" data-path="timeseries.html"><a href="timeseries.html#methods-for-estimating-the-trend"><i class="fa fa-check"></i><b>10.3.2</b> Methods for estimating the trend</a></li>
<li class="chapter" data-level="10.3.3" data-path="timeseries.html"><a href="timeseries.html#seasonal-component"><i class="fa fa-check"></i><b>10.3.3</b> Seasonal component</a></li>
<li class="chapter" data-level="10.3.4" data-path="timeseries.html"><a href="timeseries.html#trend-and-seasonal-estimation"><i class="fa fa-check"></i><b>10.3.4</b> Trend and seasonal estimation:</a></li>
<li class="chapter" data-level="10.3.5" data-path="timeseries.html"><a href="timeseries.html#seasonal-and-trend-decomposition-using-loess-stl"><i class="fa fa-check"></i><b>10.3.5</b> Seasonal and trend decomposition using Loess (STL)</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="timeseries.html"><a href="timeseries.html#simple-time-series-forecasting-approaches"><i class="fa fa-check"></i><b>10.4</b> Simple Time Series Forecasting Approaches</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="timeseries.html"><a href="timeseries.html#average-method"><i class="fa fa-check"></i><b>10.4.1</b> Average method</a></li>
<li class="chapter" data-level="10.4.2" data-path="timeseries.html"><a href="timeseries.html#random-walk-forecasts"><i class="fa fa-check"></i><b>10.4.2</b> Random walk forecasts</a></li>
<li class="chapter" data-level="10.4.3" data-path="timeseries.html"><a href="timeseries.html#seasonal-random-walk-forecasts"><i class="fa fa-check"></i><b>10.4.3</b> Seasonal random walk forecasts</a></li>
<li class="chapter" data-level="10.4.4" data-path="timeseries.html"><a href="timeseries.html#random-walk-with-drift-method"><i class="fa fa-check"></i><b>10.4.4</b> Random walk with drift method</a></li>
<li class="chapter" data-level="10.4.5" data-path="timeseries.html"><a href="timeseries.html#displaying-all-the-forecasting-results"><i class="fa fa-check"></i><b>10.4.5</b> Displaying all the forecasting results</a></li>
<li class="chapter" data-level="10.4.6" data-path="timeseries.html"><a href="timeseries.html#distributional-forecasts-and-prediction-intervals"><i class="fa fa-check"></i><b>10.4.6</b> Distributional forecasts and prediction intervals</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="timeseries.html"><a href="timeseries.html#residual-diagnostics-and-accuracy-evaluation"><i class="fa fa-check"></i><b>10.5</b> Residual Diagnostics and Accuracy Evaluation</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="timeseries.html"><a href="timeseries.html#residual-diagnostics"><i class="fa fa-check"></i><b>10.5.1</b> Residual diagnostics</a></li>
<li class="chapter" data-level="10.5.2" data-path="timeseries.html"><a href="timeseries.html#forecasting-accuracy"><i class="fa fa-check"></i><b>10.5.2</b> Forecasting accuracy</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="timeseries.html"><a href="timeseries.html#arima-models"><i class="fa fa-check"></i><b>10.6</b> ARIMA Models</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="timeseries.html"><a href="timeseries.html#differencing"><i class="fa fa-check"></i><b>10.6.1</b> Differencing</a></li>
<li class="chapter" data-level="10.6.2" data-path="timeseries.html"><a href="timeseries.html#arma-models"><i class="fa fa-check"></i><b>10.6.2</b> ARMA models</a></li>
<li class="chapter" data-level="10.6.3" data-path="timeseries.html"><a href="timeseries.html#simple-examples-of-arma-models"><i class="fa fa-check"></i><b>10.6.3</b> Simple examples of ARMA models</a></li>
<li class="chapter" data-level="10.6.4" data-path="timeseries.html"><a href="timeseries.html#arima-models-1"><i class="fa fa-check"></i><b>10.6.4</b> ARIMA models</a></li>
<li class="chapter" data-level="10.6.5" data-path="timeseries.html"><a href="timeseries.html#seasonal-arima-sarima-model"><i class="fa fa-check"></i><b>10.6.5</b> Seasonal ARIMA (SARIMA) model</a></li>
<li class="chapter" data-level="10.6.6" data-path="timeseries.html"><a href="timeseries.html#building-sarima-models"><i class="fa fa-check"></i><b>10.6.6</b> Building SARIMA Models</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="timeseries.html"><a href="timeseries.html#model-comparison"><i class="fa fa-check"></i><b>10.7</b> Model Comparison</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="timeseries.html"><a href="timeseries.html#exponential-smoothing-and-arima-models"><i class="fa fa-check"></i><b>10.7.1</b> Exponential smoothing and ARIMA models</a></li>
<li class="chapter" data-level="10.7.2" data-path="timeseries.html"><a href="timeseries.html#cross-validation-for-time-series-analysis"><i class="fa fa-check"></i><b>10.7.2</b> Cross-validation for Time series analysis</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="timeseries.html"><a href="timeseries.html#ensuring-forecasts-stay-within-limits"><i class="fa fa-check"></i><b>10.8</b> Ensuring Forecasts Stay Within Limits</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="timeseries.html"><a href="timeseries.html#positive-forecasts"><i class="fa fa-check"></i><b>10.8.1</b> Positive forecasts</a></li>
<li class="chapter" data-level="10.8.2" data-path="timeseries.html"><a href="timeseries.html#forecasts-constrained-to-an-interval"><i class="fa fa-check"></i><b>10.8.2</b> Forecasts constrained to an interval</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="timeseries.html"><a href="timeseries.html#prediction-and-prediction-intervals-for-aggregates"><i class="fa fa-check"></i><b>10.9</b> Prediction and Prediction Intervals for Aggregates</a></li>
<li class="chapter" data-level="10.10" data-path="timeseries.html"><a href="timeseries.html#exercises-5"><i class="fa fa-check"></i><b>10.10</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>11</b> Regression Methods</a>
<ul>
<li class="chapter" data-level="11.1" data-path="regression.html"><a href="regression.html#parametric-regression-methods"><i class="fa fa-check"></i><b>11.1</b> Parametric Regression Methods</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="regression.html"><a href="regression.html#examples"><i class="fa fa-check"></i><b>11.1.1</b> Examples</a></li>
<li class="chapter" data-level="11.1.2" data-path="regression.html"><a href="regression.html#model-adequacy-checking"><i class="fa fa-check"></i><b>11.1.2</b> Model adequacy checking</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="regression.html"><a href="regression.html#nonparametric-regression-methods"><i class="fa fa-check"></i><b>11.2</b> Nonparametric Regression Methods</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="regression.html"><a href="regression.html#piecewise-constant-splines"><i class="fa fa-check"></i><b>11.2.1</b> Piecewise constant splines</a></li>
<li class="chapter" data-level="11.2.2" data-path="regression.html"><a href="regression.html#truncated-power-splines"><i class="fa fa-check"></i><b>11.2.2</b> Truncated power splines</a></li>
<li class="chapter" data-level="11.2.3" data-path="regression.html"><a href="regression.html#b-splines-and-natural-splines"><i class="fa fa-check"></i><b>11.2.3</b> B-splines and natural splines</a></li>
<li class="chapter" data-level="11.2.4" data-path="regression.html"><a href="regression.html#smoothing-splines"><i class="fa fa-check"></i><b>11.2.4</b> Smoothing splines</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="regression.html"><a href="regression.html#example-cdc-fluview-portal-data"><i class="fa fa-check"></i><b>11.3</b> Example: CDC FluView Portal Data</a></li>
<li class="chapter" data-level="11.4" data-path="regression.html"><a href="regression.html#poisson-regression"><i class="fa fa-check"></i><b>11.4</b> Poisson regression</a></li>
<li class="chapter" data-level="11.5" data-path="regression.html"><a href="regression.html#logistic-regression"><i class="fa fa-check"></i><b>11.5</b> Logistic regression</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="regression.html"><a href="regression.html#odds-and-odds-ratios"><i class="fa fa-check"></i><b>11.5.1</b> Odds and odds ratios</a></li>
<li class="chapter" data-level="11.5.2" data-path="regression.html"><a href="regression.html#estimating-logistic-regression-coefficients"><i class="fa fa-check"></i><b>11.5.2</b> Estimating logistic regression coefficients</a></li>
<li class="chapter" data-level="11.5.3" data-path="regression.html"><a href="regression.html#logistic-regression-with-multiple-explanatory-variables"><i class="fa fa-check"></i><b>11.5.3</b> Logistic regression with multiple explanatory variables</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="regression.html"><a href="regression.html#exercises-6"><i class="fa fa-check"></i><b>11.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="NN.html"><a href="NN.html"><i class="fa fa-check"></i><b>12</b> Neural Networks</a>
<ul>
<li class="chapter" data-level="12.1" data-path="NN.html"><a href="NN.html#a-single-neuron"><i class="fa fa-check"></i><b>12.1</b> A Single Neuron</a></li>
<li class="chapter" data-level="12.2" data-path="NN.html"><a href="NN.html#neural-network-structure"><i class="fa fa-check"></i><b>12.2</b> Neural Network Structure</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="NN.html"><a href="NN.html#forward-propagation"><i class="fa fa-check"></i><b>12.2.1</b> Forward propagation</a></li>
<li class="chapter" data-level="12.2.2" data-path="NN.html"><a href="NN.html#back-propagation"><i class="fa fa-check"></i><b>12.2.2</b> Back-propagation</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="NN.html"><a href="NN.html#overfitting"><i class="fa fa-check"></i><b>12.3</b> Overfitting</a></li>
<li class="chapter" data-level="12.4" data-path="NN.html"><a href="NN.html#neural-network-auto-regressive-nnar-models"><i class="fa fa-check"></i><b>12.4</b> Neural Network Auto-Regressive (NNAR) models</a></li>
<li class="chapter" data-level="12.5" data-path="NN.html"><a href="NN.html#covid-19-forecasting"><i class="fa fa-check"></i><b>12.5</b> COVID-19 Forecasting</a></li>
<li class="chapter" data-level="12.6" data-path="NN.html"><a href="NN.html#exercises-7"><i class="fa fa-check"></i><b>12.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="ensemble.html"><a href="ensemble.html"><i class="fa fa-check"></i><b>13</b> Hybrid Mdels</a>
<ul>
<li class="chapter" data-level="13.1" data-path="ensemble.html"><a href="ensemble.html#ensembling-time-series-models"><i class="fa fa-check"></i><b>13.1</b> Ensembling Time Series Models</a></li>
<li class="chapter" data-level="13.2" data-path="ensemble.html"><a href="ensemble.html#model-diagnostics"><i class="fa fa-check"></i><b>13.2</b> Model Diagnostics</a></li>
<li class="chapter" data-level="13.3" data-path="ensemble.html"><a href="ensemble.html#forecasting"><i class="fa fa-check"></i><b>13.3</b> Forecasting</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="ensemble.html"><a href="ensemble.html#perform-cross-validation-on-a-time-series"><i class="fa fa-check"></i><b>13.3.1</b> Perform cross validation on a time series</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="ensemble.html"><a href="ensemble.html#weights-selection-using-cross-validation"><i class="fa fa-check"></i><b>13.4</b> Weights Selection Using Cross Validation</a></li>
<li class="chapter" data-level="13.5" data-path="ensemble.html"><a href="ensemble.html#a-project"><i class="fa fa-check"></i><b>13.5</b> A Project</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="ensemble.html"><a href="ensemble.html#projection"><i class="fa fa-check"></i><b>13.5.1</b> Projection</a></li>
<li class="chapter" data-level="13.5.2" data-path="ensemble.html"><a href="ensemble.html#visualization"><i class="fa fa-check"></i><b>13.5.2</b> Visualization</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i>Appendix</a></li>
<li class="chapter" data-level="14" data-path="appendix-a.html"><a href="appendix-a.html"><i class="fa fa-check"></i><b>14</b> Appendix A</a>
<ul>
<li class="chapter" data-level="14.1" data-path="appendix-a.html"><a href="appendix-a.html#r-introduction-and-preliminaries"><i class="fa fa-check"></i><b>14.1</b> R Introduction and Preliminaries</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="appendix-a.html"><a href="appendix-a.html#the-r-environment-and-language"><i class="fa fa-check"></i><b>14.1.1</b> The R Environment and Language</a></li>
<li class="chapter" data-level="14.1.2" data-path="appendix-a.html"><a href="appendix-a.html#r-and-statistics"><i class="fa fa-check"></i><b>14.1.2</b> R and Statistics</a></li>
<li class="chapter" data-level="14.1.3" data-path="appendix-a.html"><a href="appendix-a.html#obtaining-r-and-installation"><i class="fa fa-check"></i><b>14.1.3</b> Obtaining R and installation</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="appendix-a.html"><a href="appendix-a.html#starting-r"><i class="fa fa-check"></i><b>14.2</b> Starting R</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="appendix-a.html"><a href="appendix-a.html#description-of-three-panels-in-user-interface"><i class="fa fa-check"></i><b>14.2.1</b> Description of three panels in user interface</a></li>
<li class="chapter" data-level="14.2.2" data-path="appendix-a.html"><a href="appendix-a.html#r-help"><i class="fa fa-check"></i><b>14.2.2</b> R help</a></li>
<li class="chapter" data-level="14.2.3" data-path="appendix-a.html"><a href="appendix-a.html#some-mathematical-expressions"><i class="fa fa-check"></i><b>14.2.3</b> Some mathematical expressions</a></li>
<li class="chapter" data-level="14.2.4" data-path="appendix-a.html"><a href="appendix-a.html#r-packages"><i class="fa fa-check"></i><b>14.2.4</b> R Packages</a></li>
<li class="chapter" data-level="14.2.5" data-path="appendix-a.html"><a href="appendix-a.html#creating-a-project-and-setting-working-directory"><i class="fa fa-check"></i><b>14.2.5</b> Creating a project and setting working directory</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="appendix-a.html"><a href="appendix-a.html#exportimport-data"><i class="fa fa-check"></i><b>14.3</b> Export/Import Data</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="appendix-a.html"><a href="appendix-a.html#data-export"><i class="fa fa-check"></i><b>14.3.1</b> Data Export</a></li>
<li class="chapter" data-level="14.3.2" data-path="appendix-a.html"><a href="appendix-a.html#data-import"><i class="fa fa-check"></i><b>14.3.2</b> Data Import</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="appendix-b.html"><a href="appendix-b.html"><i class="fa fa-check"></i><b>15</b> Appendix B</a>
<ul>
<li class="chapter" data-level="15.1" data-path="appendix-b.html"><a href="appendix-b.html#epidemic-data"><i class="fa fa-check"></i><b>15.1</b> Epidemic Data</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="appendix-b.html"><a href="appendix-b.html#state-level"><i class="fa fa-check"></i><b>15.1.1</b> State level</a></li>
<li class="chapter" data-level="15.1.2" data-path="appendix-b.html"><a href="appendix-b.html#county-level"><i class="fa fa-check"></i><b>15.1.2</b> County level</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="appendix-b.html"><a href="appendix-b.html#other-factors"><i class="fa fa-check"></i><b>15.2</b> Other Factors</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="appendix-b.html"><a href="appendix-b.html#policy-data"><i class="fa fa-check"></i><b>15.2.1</b> Policy Data</a></li>
<li class="chapter" data-level="15.2.2" data-path="appendix-b.html"><a href="appendix-b.html#demographic-characteristics"><i class="fa fa-check"></i><b>15.2.2</b> Demographic Characteristics</a></li>
<li class="chapter" data-level="15.2.3" data-path="appendix-b.html"><a href="appendix-b.html#healthcare-infrastructure"><i class="fa fa-check"></i><b>15.2.3</b> Healthcare Infrastructure</a></li>
<li class="chapter" data-level="15.2.4" data-path="appendix-b.html"><a href="appendix-b.html#socioeconomic-status"><i class="fa fa-check"></i><b>15.2.4</b> Socioeconomic Status</a></li>
<li class="chapter" data-level="15.2.5" data-path="appendix-b.html"><a href="appendix-b.html#environmental-factor"><i class="fa fa-check"></i><b>15.2.5</b> Environmental Factor</a></li>
<li class="chapter" data-level="15.2.6" data-path="appendix-b.html"><a href="appendix-b.html#mobility"><i class="fa fa-check"></i><b>15.2.6</b> Mobility</a></li>
<li class="chapter" data-level="15.2.7" data-path="appendix-b.html"><a href="appendix-b.html#geographic-information"><i class="fa fa-check"></i><b>15.2.7</b> Geographic Information</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="appendix-b.html"><a href="appendix-b.html#data-sets"><i class="fa fa-check"></i><b>15.3</b> Data Sets</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="appendix-b.html"><a href="appendix-b.html#chapter-2"><i class="fa fa-check"></i><b>15.3.1</b> Chapter 2</a></li>
<li class="chapter" data-level="15.3.2" data-path="appendix-b.html"><a href="appendix-b.html#chapter-3"><i class="fa fa-check"></i><b>15.3.2</b> Chapter 3</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Learning of Infectious Disease Data Analytics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="timeseries" class="section level1" number="10">
<h1><span class="header-section-number">Chapter 10</span> Time Series Analysis of Infectious Disease Data</h1>
<p>Predicting the severity and speed of transmission of disease is crucial to resource management and developing strategies to deal with this epidemic. Forecasting goals can also be classified as long-term or short-term forecasts. Long-term disease forecasts can predict the peak or severity, while short-term forecasts can be used to guide resource allocation in the short term by local agencies or to anticipate the case burden by hospitals in the coming week; see <span class="citation"><a href="appendix-b.html#ref-altieri2020curating" role="doc-biblioref">Altieri et al.</a> (<a href="appendix-b.html#ref-altieri2020curating" role="doc-biblioref">2020</a>)</span>.</p>
<p>In this chapter, we provide a predictive analysis of the spread of infectious disease in a given area. Our main objective is to provide short-term predictions of the number of infected people or deaths. We use a well-known method in Statistics for prediction: time series analysis. In time series analysis, we focus on using the past observations of a random variable to capture the underlying patterns and predict the future values.</p>
<div id="datasets-and-r-packages" class="section level2" number="10.1">
<h2><span class="header-section-number">10.1</span> Datasets and R Packages</h2>
<p><strong>Data</strong></p>
<p>The dataset from JHU contains the cumulative number of cases reported daily for different countries. We base our analysis on the state-level time series. For each state, we consider the time-series <span class="math inline">\(y_n\)</span> starting from the day when the first case was reported. Given the current day index <span class="math inline">\(n\)</span>, we predict the number of cases for the day <span class="math inline">\(n + h\)</span> by considering as input the number of cases reported for the past <span class="math inline">\(w\)</span> days, that is, for the days <span class="math inline">\(n-w+1\)</span> to <span class="math inline">\(n\)</span>.</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="timeseries.html#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install_github(&#39;covid19-dashboard-us/slid&#39;)</span></span>
<span id="cb236-2"><a href="timeseries.html#cb236-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(slid)</span>
<span id="cb236-3"><a href="timeseries.html#cb236-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(state.long)</span></code></pre></div>
<p><strong>R Package: <code>fable</code></strong></p>
<p>We will use the R packages <code>fable</code>, <code>tsibble</code> and <code>dplyr</code>, which together offer various functions for computing and visualizing basic time series components.</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="timeseries.html#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb237-2"><a href="timeseries.html#cb237-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fable)</span>
<span id="cb237-3"><a href="timeseries.html#cb237-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tsibble)</span></code></pre></div>
<p>The R package “fable” provides a collection of commonly used univariate and multivariate time series forecasting models including exponential smoothing via state space models and autoregressive integrated moving average (ARIMA) modeling. The “fable” package provides the tools to evaluate, visualize, and combine models in a workflow consistent with the “tidyverse.”</p>
<p>The <a href="https://otexts.com/fpp3/">Forecasting: Principles and Practices</a> online textbook provides an introduction to time series forecasting using <code>fable</code>.</p>
</div>
<div id="an-introduction-to-time-series-analysis" class="section level2" number="10.2">
<h2><span class="header-section-number">10.2</span> An Introduction to Time Series Analysis</h2>
<p>Time series is a set of observations recorded sequentially. The first thing to do in any time series analysis task is to plot the data. Graphs enable many features of the data to be visualized, including patterns, unusual observations, changes over time, and relationships between variables. The features that are seen in plots of the data must then be incorporated, as much as possible, into the forecasting methods to be used. Just as the type of data determines what forecasting method to use, it also determines what graphs are appropriate. But before we produce graphs, we need to set up our time series in R.</p>
<div id="tsibble-objects" class="section level3" number="10.2.1">
<h3><span class="header-section-number">10.2.1</span> “tsibble” objects</h3>
<p>A time series can be thought of as a list of numbers, along with some information about what times those numbers were recorded. This information can be stored as a “tsibble” object in R. Beyond the tibble-like representation, <strong>key</strong> comprised of single or multiple variables is introduced to uniquely identify observational units over time (<strong>index</strong>). Each observation should be uniquely identified by <strong>index</strong> and <strong>key</strong> in a valid “tsibble” object.</p>
<p>Take the <code>state.long</code> data for example,</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="timeseries.html#cb238-1" aria-hidden="true" tabindex="-1"></a>state.long</span></code></pre></div>
<pre><code>## # A tibble: 15,925 x 7
##    State  Region Division      pop DATE       Infected Death
##    &lt;fct&gt;  &lt;fct&gt;  &lt;fct&gt;       &lt;int&gt; &lt;date&gt;        &lt;int&gt; &lt;int&gt;
##  1 Alaba… South  East Sout… 4.89e6 2020-12-11   288775  4086
##  2 Alaba… South  East Sout… 4.89e6 2020-12-10   284922  4034
##  3 Alaba… South  East Sout… 4.89e6 2020-12-09   280187  3985
##  4 Alaba… South  East Sout… 4.89e6 2020-12-08   276665  3940
##  5 Alaba… South  East Sout… 4.89e6 2020-12-07   272228  3891
##  6 Alaba… South  East Sout… 4.89e6 2020-12-06   269877  3888
##  7 Alaba… South  East Sout… 4.89e6 2020-12-05   267589  3876
##  8 Alaba… South  East Sout… 4.89e6 2020-12-04   264199  3831
##  9 Alaba… South  East Sout… 4.89e6 2020-12-03   260359  3776
## 10 Alaba… South  East Sout… 4.89e6 2020-12-02   256828  3711
## # … with 15,915 more rows</code></pre>
<p>We can turn this into a “tsibble” object using the <code>as_tsibble()</code> function:</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="timeseries.html#cb240-1" aria-hidden="true" tabindex="-1"></a>state.ts <span class="ot">&lt;-</span> <span class="fu">as_tsibble</span>(state.long, <span class="at">key =</span> State) </span>
<span id="cb240-2"><a href="timeseries.html#cb240-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Using `DATE` as index variable.</span></span>
<span id="cb240-3"><a href="timeseries.html#cb240-3" aria-hidden="true" tabindex="-1"></a>state.ts</span>
<span id="cb240-4"><a href="timeseries.html#cb240-4" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tsibble: 15,925 x 7 [1D]</span></span>
<span id="cb240-5"><a href="timeseries.html#cb240-5" aria-hidden="true" tabindex="-1"></a><span class="do">## # Key:       State [49]</span></span>
<span id="cb240-6"><a href="timeseries.html#cb240-6" aria-hidden="true" tabindex="-1"></a><span class="do">##    State  Region Division      pop DATE       Infected Death</span></span>
<span id="cb240-7"><a href="timeseries.html#cb240-7" aria-hidden="true" tabindex="-1"></a><span class="do">##    &lt;fct&gt;  &lt;fct&gt;  &lt;fct&gt;       &lt;int&gt; &lt;date&gt;        &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb240-8"><a href="timeseries.html#cb240-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  1 Alaba… South  East Sout… 4.89e6 2020-01-22        0     0</span></span>
<span id="cb240-9"><a href="timeseries.html#cb240-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  2 Alaba… South  East Sout… 4.89e6 2020-01-23        0     0</span></span>
<span id="cb240-10"><a href="timeseries.html#cb240-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  3 Alaba… South  East Sout… 4.89e6 2020-01-24        0     0</span></span>
<span id="cb240-11"><a href="timeseries.html#cb240-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  4 Alaba… South  East Sout… 4.89e6 2020-01-25        0     0</span></span>
<span id="cb240-12"><a href="timeseries.html#cb240-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  5 Alaba… South  East Sout… 4.89e6 2020-01-26        0     0</span></span>
<span id="cb240-13"><a href="timeseries.html#cb240-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  6 Alaba… South  East Sout… 4.89e6 2020-01-27        0     0</span></span>
<span id="cb240-14"><a href="timeseries.html#cb240-14" aria-hidden="true" tabindex="-1"></a><span class="do">##  7 Alaba… South  East Sout… 4.89e6 2020-01-28        0     0</span></span>
<span id="cb240-15"><a href="timeseries.html#cb240-15" aria-hidden="true" tabindex="-1"></a><span class="do">##  8 Alaba… South  East Sout… 4.89e6 2020-01-29        0     0</span></span>
<span id="cb240-16"><a href="timeseries.html#cb240-16" aria-hidden="true" tabindex="-1"></a><span class="do">##  9 Alaba… South  East Sout… 4.89e6 2020-01-30        0     0</span></span>
<span id="cb240-17"><a href="timeseries.html#cb240-17" aria-hidden="true" tabindex="-1"></a><span class="do">## 10 Alaba… South  East Sout… 4.89e6 2020-01-31        0     0</span></span>
<span id="cb240-18"><a href="timeseries.html#cb240-18" aria-hidden="true" tabindex="-1"></a><span class="do">## # … with 15,915 more rows</span></span></code></pre></div>
<p>The summary above shows that this is a “tsibble” object, which contains 15,925 rows and 7 columns. The object is uniquely identified by the key: <code>State</code>. It informs us that there are separate time series in the “tsibble” for each of the 49 states in the US.</p>
<p>A “tsibble” allows multiple time series to be stored in a single object. The <code>state.long</code> dataset contains the infected count, death count for each mainland state in the US and District of Columbia.</p>
</div>
<div id="working-with-tsibble-objects" class="section level3" number="10.2.2">
<h3><span class="header-section-number">10.2.2</span> Working with “tsibble” objects</h3>
<p>Several functions in the “dplyr” package can be used to work with “tsibble” objects, including <code>mutate()</code> and <code>select()</code>. To illustrate these further and some other useful functions, we will use the <code>state.ts</code> tsibble created in the above.</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="timeseries.html#cb241-1" aria-hidden="true" tabindex="-1"></a>state.ts <span class="ot">&lt;-</span> <span class="fu">as_tsibble</span>(state.long, <span class="at">key =</span> State) <span class="sc">%&gt;%</span></span>
<span id="cb241-2"><a href="timeseries.html#cb241-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(State) <span class="sc">%&gt;%</span></span>
<span id="cb241-3"><a href="timeseries.html#cb241-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Infected =</span> Infected<span class="sc">/</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb241-4"><a href="timeseries.html#cb241-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">YDA_Infected =</span> <span class="fu">lag</span>(Infected, <span class="at">order_by =</span> DATE)) <span class="sc">%&gt;%</span></span>
<span id="cb241-5"><a href="timeseries.html#cb241-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">YDA_Death =</span> <span class="fu">lag</span>(Death, <span class="at">order_by =</span> DATE)) <span class="sc">%&gt;%</span></span>
<span id="cb241-6"><a href="timeseries.html#cb241-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Y.Infected =</span> Infected <span class="sc">-</span> YDA_Infected) <span class="sc">%&gt;%</span></span>
<span id="cb241-7"><a href="timeseries.html#cb241-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Y.Death =</span> Death <span class="sc">-</span> YDA_Death) <span class="sc">%&gt;%</span></span>
<span id="cb241-8"><a href="timeseries.html#cb241-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Y.Infected)) <span class="sc">%&gt;%</span></span>
<span id="cb241-9"><a href="timeseries.html#cb241-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Y.Death)) <span class="sc">%&gt;%</span></span>
<span id="cb241-10"><a href="timeseries.html#cb241-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(YDA_Infected, YDA_Death))</span>
<span id="cb241-11"><a href="timeseries.html#cb241-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Using `DATE` as index variable.</span></span>
<span id="cb241-12"><a href="timeseries.html#cb241-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-13"><a href="timeseries.html#cb241-13" aria-hidden="true" tabindex="-1"></a>state.ts </span>
<span id="cb241-14"><a href="timeseries.html#cb241-14" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tsibble: 15,876 x 9 [1D]</span></span>
<span id="cb241-15"><a href="timeseries.html#cb241-15" aria-hidden="true" tabindex="-1"></a><span class="do">## # Key:       State [49]</span></span>
<span id="cb241-16"><a href="timeseries.html#cb241-16" aria-hidden="true" tabindex="-1"></a><span class="do">## # Groups:    State [49]</span></span>
<span id="cb241-17"><a href="timeseries.html#cb241-17" aria-hidden="true" tabindex="-1"></a><span class="do">##    State Region Division    pop DATE       Infected Death</span></span>
<span id="cb241-18"><a href="timeseries.html#cb241-18" aria-hidden="true" tabindex="-1"></a><span class="do">##    &lt;fct&gt; &lt;fct&gt;  &lt;fct&gt;     &lt;int&gt; &lt;date&gt;        &lt;dbl&gt; &lt;int&gt;</span></span>
<span id="cb241-19"><a href="timeseries.html#cb241-19" aria-hidden="true" tabindex="-1"></a><span class="do">##  1 Alab… South  East So… 4.89e6 2020-01-23        0     0</span></span>
<span id="cb241-20"><a href="timeseries.html#cb241-20" aria-hidden="true" tabindex="-1"></a><span class="do">##  2 Alab… South  East So… 4.89e6 2020-01-24        0     0</span></span>
<span id="cb241-21"><a href="timeseries.html#cb241-21" aria-hidden="true" tabindex="-1"></a><span class="do">##  3 Alab… South  East So… 4.89e6 2020-01-25        0     0</span></span>
<span id="cb241-22"><a href="timeseries.html#cb241-22" aria-hidden="true" tabindex="-1"></a><span class="do">##  4 Alab… South  East So… 4.89e6 2020-01-26        0     0</span></span>
<span id="cb241-23"><a href="timeseries.html#cb241-23" aria-hidden="true" tabindex="-1"></a><span class="do">##  5 Alab… South  East So… 4.89e6 2020-01-27        0     0</span></span>
<span id="cb241-24"><a href="timeseries.html#cb241-24" aria-hidden="true" tabindex="-1"></a><span class="do">##  6 Alab… South  East So… 4.89e6 2020-01-28        0     0</span></span>
<span id="cb241-25"><a href="timeseries.html#cb241-25" aria-hidden="true" tabindex="-1"></a><span class="do">##  7 Alab… South  East So… 4.89e6 2020-01-29        0     0</span></span>
<span id="cb241-26"><a href="timeseries.html#cb241-26" aria-hidden="true" tabindex="-1"></a><span class="do">##  8 Alab… South  East So… 4.89e6 2020-01-30        0     0</span></span>
<span id="cb241-27"><a href="timeseries.html#cb241-27" aria-hidden="true" tabindex="-1"></a><span class="do">##  9 Alab… South  East So… 4.89e6 2020-01-31        0     0</span></span>
<span id="cb241-28"><a href="timeseries.html#cb241-28" aria-hidden="true" tabindex="-1"></a><span class="do">## 10 Alab… South  East So… 4.89e6 2020-02-01        0     0</span></span>
<span id="cb241-29"><a href="timeseries.html#cb241-29" aria-hidden="true" tabindex="-1"></a><span class="do">## # … with 15,866 more rows, and 2 more variables:</span></span>
<span id="cb241-30"><a href="timeseries.html#cb241-30" aria-hidden="true" tabindex="-1"></a><span class="do">## #   Y.Infected &lt;dbl&gt;, Y.Death &lt;int&gt;</span></span></code></pre></div>
<p>This tsibble use the <code>mutate()</code> to create two extra variables: <code>Y.Infected</code> and <code>Y.Death</code>, which are the daily new infected count and the daily new death count for each state.</p>
<p>We can use the <code>filter()</code> function to extract the data for the state of Florida, for example:</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="timeseries.html#cb242-1" aria-hidden="true" tabindex="-1"></a>Florida.ts <span class="ot">&lt;-</span> state.ts <span class="sc">%&gt;%</span></span>
<span id="cb242-2"><a href="timeseries.html#cb242-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(State <span class="sc">==</span> <span class="st">&quot;Florida&quot;</span>)</span></code></pre></div>
<p>Next, we can simplify the resulting object by selecting five variables we will need in subsequent analysis.</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="timeseries.html#cb243-1" aria-hidden="true" tabindex="-1"></a>Florida.ts <span class="ot">&lt;-</span> Florida.ts <span class="sc">%&gt;%</span> </span>
<span id="cb243-2"><a href="timeseries.html#cb243-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Infected, Death, Y.Infected, Y.Death)</span>
<span id="cb243-3"><a href="timeseries.html#cb243-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Adding missing grouping variables: `State`</span></span>
<span id="cb243-4"><a href="timeseries.html#cb243-4" aria-hidden="true" tabindex="-1"></a>Florida.ts</span>
<span id="cb243-5"><a href="timeseries.html#cb243-5" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tsibble: 324 x 6 [1D]</span></span>
<span id="cb243-6"><a href="timeseries.html#cb243-6" aria-hidden="true" tabindex="-1"></a><span class="do">## # Key:       State [1]</span></span>
<span id="cb243-7"><a href="timeseries.html#cb243-7" aria-hidden="true" tabindex="-1"></a><span class="do">## # Groups:    State [1]</span></span>
<span id="cb243-8"><a href="timeseries.html#cb243-8" aria-hidden="true" tabindex="-1"></a><span class="do">##    State   Infected Death Y.Infected Y.Death DATE      </span></span>
<span id="cb243-9"><a href="timeseries.html#cb243-9" aria-hidden="true" tabindex="-1"></a><span class="do">##    &lt;fct&gt;      &lt;dbl&gt; &lt;int&gt;      &lt;dbl&gt;   &lt;int&gt; &lt;date&gt;    </span></span>
<span id="cb243-10"><a href="timeseries.html#cb243-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  1 Florida        0     0          0       0 2020-01-23</span></span>
<span id="cb243-11"><a href="timeseries.html#cb243-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  2 Florida        0     0          0       0 2020-01-24</span></span>
<span id="cb243-12"><a href="timeseries.html#cb243-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  3 Florida        0     0          0       0 2020-01-25</span></span>
<span id="cb243-13"><a href="timeseries.html#cb243-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  4 Florida        0     0          0       0 2020-01-26</span></span>
<span id="cb243-14"><a href="timeseries.html#cb243-14" aria-hidden="true" tabindex="-1"></a><span class="do">##  5 Florida        0     0          0       0 2020-01-27</span></span>
<span id="cb243-15"><a href="timeseries.html#cb243-15" aria-hidden="true" tabindex="-1"></a><span class="do">##  6 Florida        0     0          0       0 2020-01-28</span></span>
<span id="cb243-16"><a href="timeseries.html#cb243-16" aria-hidden="true" tabindex="-1"></a><span class="do">##  7 Florida        0     0          0       0 2020-01-29</span></span>
<span id="cb243-17"><a href="timeseries.html#cb243-17" aria-hidden="true" tabindex="-1"></a><span class="do">##  8 Florida        0     0          0       0 2020-01-30</span></span>
<span id="cb243-18"><a href="timeseries.html#cb243-18" aria-hidden="true" tabindex="-1"></a><span class="do">##  9 Florida        0     0          0       0 2020-01-31</span></span>
<span id="cb243-19"><a href="timeseries.html#cb243-19" aria-hidden="true" tabindex="-1"></a><span class="do">## 10 Florida        0     0          0       0 2020-02-01</span></span>
<span id="cb243-20"><a href="timeseries.html#cb243-20" aria-hidden="true" tabindex="-1"></a><span class="do">## # … with 314 more rows</span></span></code></pre></div>
<p>Note that the index variable <code>DATE</code> would be returned even if it was not explicitly selected as it is required for a tsibble.</p>
</div>
<div id="drawing-time-series-plots" class="section level3" number="10.2.3">
<h3><span class="header-section-number">10.2.3</span> Drawing time series plots</h3>
<p>To further examine the data, we now use the <code>autoplot()</code> to draw some time series plot; see Figure <a href="timeseries.html#fig:death1">10.1</a>.</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="timeseries.html#cb244-1" aria-hidden="true" tabindex="-1"></a>Florida.ts <span class="sc">%&gt;%</span></span>
<span id="cb244-2"><a href="timeseries.html#cb244-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(Y.Death)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:death1"></span>
<img src="SLID_book_files/figure-html/death1-1.png" alt="The time series plot of the daily new death count in Florida using the `autoplot()` function." width="672" />
<p class="caption">
Figure 10.1: The time series plot of the daily new death count in Florida using the <code>autoplot()</code> function.
</p>
</div>
<p>We can also use the “ggplot2” to draw some time series plot. Figure <a href="timeseries.html#fig:death2">10.2</a> shows the time series plot with blue line.</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="timeseries.html#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb245-2"><a href="timeseries.html#cb245-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Florida.ts, <span class="fu">aes</span>(<span class="at">x =</span> DATE, <span class="at">y =</span> Y.Death)) <span class="sc">+</span> </span>
<span id="cb245-3"><a href="timeseries.html#cb245-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb245-4"><a href="timeseries.html#cb245-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Florida daily new death count&#39;</span>) </span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:death2"></span>
<img src="SLID_book_files/figure-html/death2-1.png" alt="The time series plot of the daily new death count in Florida using the `ggplot()` function." width="672" />
<p class="caption">
Figure 10.2: The time series plot of the daily new death count in Florida using the <code>ggplot()</code> function.
</p>
</div>
<p>We can draw multiple time series on the same plot using “ggplot2.” The time series plot shown in Figure <a href="timeseries.html#fig:death3">10.3</a> illusterate the daily new infected and death counts in Florida.</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="timeseries.html#cb246-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(Florida.ts, <span class="fu">aes</span>(<span class="at">x =</span> DATE)) <span class="sc">+</span></span>
<span id="cb246-2"><a href="timeseries.html#cb246-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Y.Infected, <span class="at">colour =</span> <span class="st">&quot;Y.Infected (thousand)&quot;</span>)) <span class="sc">+</span></span>
<span id="cb246-3"><a href="timeseries.html#cb246-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Y.Death, <span class="at">colour =</span> <span class="st">&quot;Y.Death&quot;</span>)) <span class="sc">+</span></span>
<span id="cb246-4"><a href="timeseries.html#cb246-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Count&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Day&quot;</span>) <span class="sc">+</span></span>
<span id="cb246-5"><a href="timeseries.html#cb246-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour=</span><span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">&quot;Forecasts&quot;</span>)) <span class="sc">+</span></span>
<span id="cb246-6"><a href="timeseries.html#cb246-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:death3"></span>
<img src="SLID_book_files/figure-html/death3-1.png" alt="The time series plot of the daily new infected and death counts in Florida." width="672" />
<p class="caption">
Figure 10.3: The time series plot of the daily new infected and death counts in Florida.
</p>
</div>
<p>Figure <a href="timeseries.html#fig:death4">10.4</a> shows the time series plot of the daily new death count for each of the midwest states using the <code>ggplot()</code> function.</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="timeseries.html#cb247-1" aria-hidden="true" tabindex="-1"></a>state.ts <span class="sc">%&gt;%</span></span>
<span id="cb247-2"><a href="timeseries.html#cb247-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Region<span class="sc">==</span> <span class="st">&quot;Midwest&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb247-3"><a href="timeseries.html#cb247-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> DATE, <span class="at">y =</span> Y.Death, </span>
<span id="cb247-4"><a href="timeseries.html#cb247-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> State, <span class="at">color =</span> State)) <span class="sc">+</span></span>
<span id="cb247-5"><a href="timeseries.html#cb247-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb247-6"><a href="timeseries.html#cb247-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:death4"></span>
<img src="SLID_book_files/figure-html/death4-1.png" alt="The time series plot of the daily new death count for each of the midwest states using the `ggplot()` function." width="672" />
<p class="caption">
Figure 10.4: The time series plot of the daily new death count for each of the midwest states using the <code>ggplot()</code> function.
</p>
</div>
<p>We can also use the <code>autoplot()</code> function to draw multiple time series on one plot. Figure <a href="timeseries.html#fig:deathall">10.5</a> shows the time series plot of the daily new death count for each of the midwest states using the <code>autoplot()</code> function.</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="timeseries.html#cb248-1" aria-hidden="true" tabindex="-1"></a>state.ts <span class="sc">%&gt;%</span> </span>
<span id="cb248-2"><a href="timeseries.html#cb248-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Region<span class="sc">==</span> <span class="st">&quot;Midwest&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb248-3"><a href="timeseries.html#cb248-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(Y.Death) <span class="sc">+</span></span>
<span id="cb248-4"><a href="timeseries.html#cb248-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ylab</span>(<span class="st">&quot;Deaths&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Day&quot;</span>) <span class="sc">+</span></span>
<span id="cb248-5"><a href="timeseries.html#cb248-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggtitle</span>(<span class="st">&quot;Daily new death count for each of the midwest&quot;</span>)</span></code></pre></div>
<pre><code>## `mutate_if()` ignored the following grouping variables:
## Column `State`</code></pre>
<div class="figure" style="text-align: center"><span id="fig:deathall"></span>
<img src="SLID_book_files/figure-html/deathall-1.png" alt="The time series plot of the daily new death count for each of the midwest states using the `autoplot()` function." width="672" />
<p class="caption">
Figure 10.5: The time series plot of the daily new death count for each of the midwest states using the <code>autoplot()</code> function.
</p>
</div>
<p>After making the time series plots, we look for</p>
<ul>
<li><p><strong>Trend:</strong> upward or downward movement that might be extrapolated into future; it does not have to be linear.</p></li>
<li><p><strong>Periodicity:</strong> repetition in regular pattern (usually peaks and troughs;</p></li>
<li><p><strong>Seasonality:</strong> periodic behavior of known period (i.e., 12 months for monthly data);</p></li>
<li><p><strong>Heteroskedasticity:</strong> changing variance, particularly with changing level;</p></li>
<li><p><strong>Dependence:</strong> positive (successive observations are similar) or negative (successive observations are dissimilar);</p></li>
<li><p><strong>Missing data</strong>, <strong>structural breaks</strong>, <strong>outliers</strong>.</p></li>
</ul>
<p><strong>Remark:</strong> Some readers confuse cyclic behavior with seasonal behavior, but they are really quite different. If the fluctuations are not of a fixed frequency, then they are cyclic; if the frequency is unchanging and associated with some aspect of the calendar, then the pattern is seasonal.</p>
<p><strong>Time series seasonal plot</strong></p>
<p>We can produce a time series seasonal plot using <code>gg_season()</code> function in the “feast” R package, which provides a collection of features, decomposition methods, statistical summaries and graphics functions for analyzing tidy time series data.</p>
<p>A seasonal plot is similar to a regular time series plot, except the x-axis shows data from within each season. This plot type allows the underlying seasonal pattern to be seen more clearly, and is especially useful in identifying the time in which the pattern changes. Figure <a href="timeseries.html#fig:deathweek">10.6</a> shows the time series weekly plot of the daily new death count.</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="timeseries.html#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(feasts)</span>
<span id="cb250-2"><a href="timeseries.html#cb250-2" aria-hidden="true" tabindex="-1"></a>Florida.ts <span class="sc">%&gt;%</span> <span class="fu">gg_season</span>(Y.Death, <span class="at">period =</span> <span class="st">&quot;week&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:deathweek"></span>
<img src="SLID_book_files/figure-html/deathweek-1.png" alt="The time series weekly plot of the daily new death count." width="672" />
<p class="caption">
Figure 10.6: The time series weekly plot of the daily new death count.
</p>
</div>
<p><strong>A lag plot</strong></p>
<p>We can draw a lag plot to show the time series against lags of itself using the <code>gg_lag()</code> in the R library <code>feasts</code>.</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="timeseries.html#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(feasts)</span>
<span id="cb251-2"><a href="timeseries.html#cb251-2" aria-hidden="true" tabindex="-1"></a>Florida.ts <span class="sc">%&gt;%</span> </span>
<span id="cb251-3"><a href="timeseries.html#cb251-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gg_lag</span>(<span class="at">y =</span> Y.Death, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:deathlag"></span>
<img src="SLID_book_files/figure-html/deathlag-1.png" alt="The lag plot of the daily new death count for Florida." width="672" />
<p class="caption">
Figure 10.7: The lag plot of the daily new death count for Florida.
</p>
</div>
<p>It is often colored the seasonal period (here weekly cycle) to identify how each season (each date in a week) correlates with others. From Figure <a href="timeseries.html#fig:deathlag">10.7</a>, one sees that the relationship is strongly positive at lag 7, reflecting the strong weekly cycle in the data.</p>
</div>
<div id="objectives-of-time-series-analysis" class="section level3" number="10.2.4">
<h3><span class="header-section-number">10.2.4</span> Objectives of Time Series Analysis</h3>
<ul>
<li>Provide an interpretable model of data
<ul>
<li>often involves multivariate series</li>
<li>allows testing of scientific hypotheses</li>
<li>but, not always a major emphasis in time series analysis</li>
</ul></li>
<li>Predict future values of series
<ul>
<li>very common application of time series analysis</li>
<li>predictive models often do not try to explain</li>
</ul></li>
<li>Provide a compact description of data
<ul>
<li>good predictive model can be used for data compression</li>
<li>used extensively in telecommunications</li>
</ul></li>
</ul>
<p><strong>Modeling Strategy</strong></p>
<ul>
<li>Take a probabilistic approach
<ul>
<li>observations <span class="math inline">\(=\)</span> realizations of random variables</li>
<li>in much of statistics, random variables are assumed to be indepedent</li>
</ul></li>
<li>Difficulties in time series:
<ul>
<li>random variables are typically not identically distributed</li>
<li>different means due to trend, seasonality</li>
<li>may be different variances as well</li>
<li>random variables typically not independent</li>
<li>dependence may be positive or negative</li>
</ul></li>
<li>Try to make things easier
<ul>
<li>eliminate heterostedasticity via transformation (e.g. log)</li>
<li>eliminate trend and seasonality</li>
<li>model remainder as dependent but identically distributed</li>
</ul></li>
</ul>
</div>
<div id="stationarity" class="section level3" number="10.2.5">
<h3><span class="header-section-number">10.2.5</span> Stationarity</h3>
<p>Let <span class="math inline">\(\{X_t\}\)</span> be a time series with <span class="math inline">\(E(X_t^2)&lt;\infty\)</span>.</p>
<ul>
<li>The <strong>mean function</strong> of <span class="math inline">\(\{X_t\}\)</span> is
<span class="math display">\[
\mu_X(t)=\mathrm{E}(X_t).
\]</span></li>
<li>The <strong>covariance function</strong> of <span class="math inline">\(\{X_t\}\)</span> is
<span class="math display">\[
\gamma_X(s,t)=\mathrm{Cov}(X_t,X_s) = \mathrm{E}[(X_s-\mu_X(s))(X_t-\mu_X(t))]
\]</span>
for all integers <span class="math inline">\(s\)</span> and <span class="math inline">\(t\)</span>.</li>
</ul>
<p><strong>Modeling Dependence</strong></p>
<ul>
<li>Hard to model dependence if dependence changes with time</li>
<li>Easiest to model dependence in stationary case</li>
</ul>
<p>Roughly speaking, stationary means <strong>probabilistic properties</strong> of series do not change with time. There are two versions of interest.</p>
<ol style="list-style-type: decimal">
<li><strong>Strict stationarity:</strong> joint probability distributions do not change with time.</li>
</ol>
<p>A time series <span class="math inline">\(\{X_t\}\)</span> is <strong>strictly stationary</strong> if for any positive integer <span class="math inline">\(k\)</span> and integers <span class="math inline">\(t_1, \ldots, t_k\)</span> and <span class="math inline">\(h\)</span>,
<span class="math display">\[
 (X_{t_1},X_{t_2},\ldots,X_{t_k}) \overset{d}{=} (X_{t_1+h},X_{t_2+h},\ldots,X_{t_k+h})
 \]</span>
where ``<span class="math inline">\(\overset{d}{=}\)</span>’’ denotes equality in probability distribution.</p>
<p>Remark: covariances make sense only if variances exist</p>
<ul>
<li>If <span class="math inline">\(\{X_t\}\)</span> is IID, then <span class="math inline">\(\{X_t\}\)</span> is strictly stationary</li>
<li>Strict stationarity is a very strong modeling assumption
<ul>
<li>hard to verify in practice</li>
<li>often stronger than necessary for useful results <span class="math inline">\(\Rightarrow\)</span> introduce next so-called weak stationarity</li>
</ul></li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li><strong>Weak stationarity:</strong> 1st and 2nd order moment properties (i.e., mean and covariance structures) do not change over time</li>
</ol>
<ul>
<li><p>A time series <span class="math inline">\(\{X_t\}\)</span> is <strong>weakly stationary</strong> if for all integers <span class="math inline">\(t\)</span> and <span class="math inline">\(h\)</span>:</p>
<ol style="list-style-type: lower-alpha">
<li><span class="math inline">\(\mathrm{Var}(X_t)&lt;\infty\)</span></li>
<li><span class="math inline">\(E[X_t]\)</span> does not depend on <span class="math inline">\(t\)</span></li>
<li><span class="math inline">\(\mathrm{Cov}(X_t,X_{t+h})\)</span> does not depend on <span class="math inline">\(t\)</span></li>
</ol></li>
<li><p>Notes</p>
<ol style="list-style-type: lower-alpha">
<li>implies all means, variances, and covariances exist</li>
<li>implies means are constant (rules out trend, seasonality)</li>
<li>with <span class="math inline">\(h = 0\)</span>, (c) implies variances are constant (rules out heteroskedasticity)</li>
</ol></li>
<li><p><strong>Weakly stationary</strong> also known as covariance stationary, second order stationary, or just stationary</p>
<pre><code>  * 1st and 2nd-order moments do not change with time
  * much weaker than strict stationarity </code></pre></li>
</ul>
</div>
<div id="autocorrelation" class="section level3" number="10.2.6">
<h3><span class="header-section-number">10.2.6</span> Autocorrelation</h3>
<ol style="list-style-type: decimal">
<li><strong>Autocovariance Function (ACVF)</strong></li>
</ol>
<p>For weakly stationary time series, <span class="math inline">\(\mathrm{Cov}(X_{t},X_{t+h})=\gamma(h)\)</span>, a function of <span class="math inline">\(h\)</span> only.</p>
<ol start="2" style="list-style-type: decimal">
<li><strong>Autocorrelation Function (ACF)</strong></li>
</ol>
<p>The autocorrelation function (ACF) of <span class="math inline">\(\{X_t\}\)</span> is defined by
<span class="math display">\[
\rho(h)=\frac{\gamma(h)}{\gamma(0)}=\frac{\mathrm{Cov}(X_{t},X_{t+h})}{\sqrt{\mathrm{Var}(X_{t})\mathrm{Var}(X_{t+h})}}
\]</span></p>
<ol start="3" style="list-style-type: decimal">
<li><strong>Sample ACVF</strong></li>
</ol>
<p>Let <span class="math inline">\(\{X_t\}_{t=1}^n\)</span> be a time series and <span class="math inline">\(\bar{X}_{n}=\frac{1}{n}\sum_{t=1}^{n}X_t\)</span> be its sample mean. The sample ACVF (based on <span class="math inline">\(\{X_t\}_{t=1}^n\)</span>):
<span class="math display">\[
\hat{\gamma}(h)\equiv \frac{1}{n}\sum_{t=1}^{n-|h|} (X_{t}-\bar{X}_{n})(X_{t+|h|}-\bar{X}_{n}), ~|h|&lt;n
\]</span>
which estimates <span class="math inline">\(\gamma(h)=E[(X_t-EX_t)(X_{t+|h|}-EX_t)]\)</span>.</p>
<ol start="4" style="list-style-type: decimal">
<li><strong>Sample ACF</strong></li>
</ol>
<p>The sample ACF based on <span class="math inline">\(\{X_t\}_{t=1}^n\)</span> is defined as
<span class="math display">\[
\hat{\rho}(h)\equiv \hat{\gamma}(h)/\hat{\gamma}(0), ~|h|&lt;n
\]</span>
which estimates <span class="math inline">\(\rho(h)=\gamma(h)/\gamma(0)\)</span>, <span class="math inline">\(|\hat{\rho}(h)|\leq 1\)</span>, <span class="math inline">\(\hat{\rho}(0)=1\)</span>.</p>
<p>The autocorrelation coefficients are plotted to show the autocorrelation function or ACF. Figure <a href="timeseries.html#fig:acf">10.8</a> shows the ACF plot of the daily new death count in Florida.</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="timeseries.html#cb253-1" aria-hidden="true" tabindex="-1"></a>Florida.ts <span class="sc">%&gt;%</span></span>
<span id="cb253-2"><a href="timeseries.html#cb253-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ACF</span>(Y.Death) <span class="sc">%&gt;%</span></span>
<span id="cb253-3"><a href="timeseries.html#cb253-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:acf"></span>
<img src="SLID_book_files/figure-html/acf-1.png" alt="The ACF plot of the daily new death count in Florida." width="672" />
<p class="caption">
Figure 10.8: The ACF plot of the daily new death count in Florida.
</p>
</div>
<p>The dashed blue lines in this graph indicate whether the correlations are significantly different from zero, and <span class="math inline">\(\hat{\rho}(4)\)</span> is higher than for the other lags. This is due to the weekly pattern in the data: the peaks tend to be four quarters apart, and the troughs tend to be four quarters apart.</p>
<p><strong>Remark:</strong></p>
<ol style="list-style-type: decimal">
<li><p>When data have a trend, the autocorrelations for small lags tend to be large and positive because observations nearby in time are also nearby in size. So the ACF of the time series with a trend tends to have positive values that slowly decrease as the lags increase.</p></li>
<li><p>When data are seasonal, the autocorrelations will be larger for the seasonal lags (at multiples of the seasonal frequency) than for other lags.</p></li>
</ol>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="timeseries.html#cb254-1" aria-hidden="true" tabindex="-1"></a>Florida.ts <span class="sc">%&gt;%</span> </span>
<span id="cb254-2"><a href="timeseries.html#cb254-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gg_tsdisplay</span>(<span class="fu">difference</span>(Y.Death, <span class="dv">7</span>), <span class="at">plot_type=</span><span class="st">&#39;partial&#39;</span>, <span class="at">lag=</span><span class="dv">36</span>) <span class="sc">+</span></span>
<span id="cb254-3"><a href="timeseries.html#cb254-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">&quot;Lag 7 differenced&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:acfpacf"></span>
<img src="SLID_book_files/figure-html/acfpacf-1.png" alt="Time plot, ACF plot and PACF plot of lag-7 differenced data." width="672" />
<p class="caption">
Figure 10.9: Time plot, ACF plot and PACF plot of lag-7 differenced data.
</p>
</div>
</div>
</div>
<div id="time-series-decomposition" class="section level2" number="10.3">
<h2><span class="header-section-number">10.3</span> Time Series Decomposition</h2>
<p>Time series data can exhibit various patterns, and it is often helpful to split a time series into several components, each representing an underlying pattern category. In the literature, a time series is usually decomposed into three components: a trend component, a seasonal component, and a remainder component. In the following, we consider the following classical decomposition:
<span class="math display">\[
    X_t=m_t+s_t+Y_t
    \]</span>
where <span class="math inline">\(m_t\)</span> is the <strong>trend</strong> at <span class="math inline">\(t\)</span> (non-random often), <span class="math inline">\(s_t\)</span>: a function with known period <span class="math inline">\(d\)</span> referred to as <strong>seasonality</strong> (non-random), and <span class="math inline">\(Y_t\)</span>: irregular and random noise that is stationary.</p>
<p>Our aims are the following:</p>
<ul>
<li>to estimate and extract <span class="math inline">\(m_t\)</span> and <span class="math inline">\(s_t\)</span> so that the residual <span class="math inline">\(Y_t\)</span> will turn out to be stationary;</li>
<li>to find a satisfactory probabilistic model for <span class="math inline">\(Y_t\)</span>;</li>
<li>use it in conjunction with <span class="math inline">\(m_t\)</span> and <span class="math inline">\(s_t\)</span> for prediction and simulation of <span class="math inline">\(\{X_t\}\)</span>.</li>
</ul>
<div id="box-cox-transformations" class="section level3" number="10.3.1">
<h3><span class="header-section-number">10.3.1</span> Box-Cox transformations</h3>
<p>When decomposing a time series, it is sometimes helpful to first transform or adjust the series in order to make the decomposition (and later analysis) as simple as possible. Transformations help to stabilize the variance. So we will begin by discussing transformations and adjustments.</p>
<p>Each of these transformations is close to a member of the family of Box-Cox transformations:
<span class="math display">\[
W_t =\left\{\begin{array}{ll}
\log(Y_t), &amp; \lambda=0;\\
(Y_t^{\lambda}-1)/\lambda, &amp; \lambda \neq 0.
\end{array}
\right.
\]</span></p>
<ul>
<li><span class="math inline">\(\lambda= 1\)</span>: (No substantive transformation);</li>
<li><span class="math inline">\(\lambda= 1/2\)</span>: (Square root plus linear transformation);</li>
<li><span class="math inline">\(\lambda= 0\)</span>: (Natural logarithm). This is a simple way to force forecasts to be positive;</li>
<li><span class="math inline">\(\lambda= -1\)</span>: (Inverse plus 1);</li>
<li><span class="math inline">\(Y_t^{\lambda}=1\)</span> for <span class="math inline">\(\lambda\)</span> close to zero behaves like logs;</li>
<li>If some <span class="math inline">\(Y_t = 0\)</span>, then must have <span class="math inline">\(\lambda &gt; 0\)</span>;</li>
<li>If some <span class="math inline">\(Y_t &lt; 0\)</span>, no power transformation is possible unless all <span class="math inline">\(Y_t\)</span> adjusted by adding a constant to all values;</li>
<li>Choose a simple value of <span class="math inline">\(\lambda\)</span>, which makes explanation easier;</li>
<li>Results are relatively insensitive to value of <span class="math inline">\(\lambda\)</span>.</li>
</ul>
<p>We must reverse the transformation (or back-transform) to obtain forecasts
on the original scale. The reverse Box-Cox transformations are given by
<span class="math display">\[
Y_t=\left\{\begin{array}{ll}
\exp(W_t), &amp; \lambda=0;\\
(\lambda W_t+1)^{1/\lambda}-1, &amp; \lambda \neq 0.
\end{array}
\right.
\]</span></p>
</div>
<div id="methods-for-estimating-the-trend" class="section level3" number="10.3.2">
<h3><span class="header-section-number">10.3.2</span> Methods for estimating the trend</h3>
<ol style="list-style-type: decimal">
<li>Polynomial regression</li>
</ol>
<p>Simplest curve fit or approximation model, where the number of cases is approximated locally with polynomials of degree <span class="math inline">\(d\)</span>.
<span class="math display">\[
Y_t = \beta_0 + \beta_1 t + \beta_2 t^2 + \cdots + \beta_d t^d + Z_t,
\]</span>
where <span class="math inline">\(\{Z_t\}\)</span> are IID gaussian noise.</p>
<p>Figure <a href="timeseries.html#fig:predlm">10.10</a> of the 14 days ahead forecast of the daily death count for Florida using the linear regression method.</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="timeseries.html#cb255-1" aria-hidden="true" tabindex="-1"></a>death_lmfit <span class="ot">&lt;-</span> Florida.ts <span class="sc">%&gt;%</span>  </span>
<span id="cb255-2"><a href="timeseries.html#cb255-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">TSLM</span>(Y.Death <span class="sc">~</span> DATE)) </span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:predlm"></span>
<img src="SLID_book_files/figure-html/predlm-1.png" alt="Two weeks ahead forecast of the daily death count for Florida using the linear regression method." width="672" />
<p class="caption">
Figure 10.10: Two weeks ahead forecast of the daily death count for Florida using the linear regression method.
</p>
</div>
<p>Figure <a href="timeseries.html#fig:predlm">10.10</a> shows the 14 days ahead forecast of the daily death count for Florida using the linear regression method with the seasonal component: <code>season(7)</code>.</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="timeseries.html#cb256-1" aria-hidden="true" tabindex="-1"></a>death_lmsfit <span class="ot">&lt;-</span> Florida.ts <span class="sc">%&gt;%</span>  </span>
<span id="cb256-2"><a href="timeseries.html#cb256-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">TSLM</span>(Y.Death  <span class="sc">~</span> DATE <span class="sc">+</span> <span class="fu">season</span>(<span class="dv">7</span>))) </span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:predlms"></span>
<img src="SLID_book_files/figure-html/predlms-1.png" alt="Two weeks ahead forecast of the daily death count for Florida using the linear regression method with the seasonal component." width="672" />
<p class="caption">
Figure 10.11: Two weeks ahead forecast of the daily death count for Florida using the linear regression method with the seasonal component.
</p>
</div>
<ol start="2" style="list-style-type: decimal">
<li>Moving average filtering</li>
</ol>
<p>For an integer <span class="math inline">\(q\geq 0\)</span>, and filtering parameters <span class="math inline">\(\{a_{-q},a_{-q+1},\ldots, a_0,a_1,\ldots,a_{q}\}\)</span>, we consider the following moving average filter:
<span class="math display">\[
\hat{m}_{t}=\sum_{k=-q}^{q}a_{k}X_{t-k}, ~ q+1 \leq t \leq n-q.
\]</span>
For example, if <span class="math inline">\(a_{k}=1/(1+2q)\)</span>, then
<span class="math display">\[
\hat{m}_{t}=\frac{1}{1+2q}\sum_{k=-q}^{q} m_{t-k}+\frac{1}{1+2q}\sum_{k=-q}^{q}Y_{t-k}
\]</span>
is the two-sided moving average. We call this an <span class="math inline">\(m\)</span>-MA smoothing, meaning a moving average of order <span class="math inline">\(m=1+2q\)</span>. This method allows linear trend function <span class="math inline">\(m_t=c_0+c_1t\)</span> to pass without distortion:
<span class="math display">\[
\sum_{k=-q}^{q}a_{k}m_{t-k}=m_t.
\]</span></p>
<p><strong>Remarks:</strong></p>
<p>The <span class="math inline">\(m\)</span>-MA can be easily done using <code>slide_dbl()</code> from the “slider” package which applies a function to “sliding” time windows. We can use the <code>mean()</code> function to specify the window size.</p>
<ul>
<li>For small <span class="math inline">\(q\)</span>, <span class="math inline">\(\hat{m}_{t}\)</span> is closer to <span class="math inline">\(m_t\)</span>, less bias, more variance;</li>
<li>For large <span class="math inline">\(q\)</span>, more bias, less variance;</li>
<li>This is so called <strong>variance-bias</strong> trade-off in filtering.</li>
</ul>
<p>For example, we consider <span class="math inline">\(q=2\)</span> and <span class="math inline">\(q=7\)</span> below to have a 5-MA smoothing and a 15-MA smoothing, respectively.</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="timeseries.html#cb257-1" aria-hidden="true" tabindex="-1"></a>Florida.ts.MA5 <span class="ot">&lt;-</span> Florida.ts <span class="sc">%&gt;%</span></span>
<span id="cb257-2"><a href="timeseries.html#cb257-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb257-3"><a href="timeseries.html#cb257-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">5-MA</span><span class="st">`</span> <span class="ot">=</span> slider<span class="sc">::</span><span class="fu">slide_dbl</span>(Y.Death, mean,</span>
<span id="cb257-4"><a href="timeseries.html#cb257-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">.before =</span> <span class="dv">2</span>, <span class="at">.after =</span> <span class="dv">2</span>, <span class="at">.complete =</span> <span class="cn">TRUE</span>)</span>
<span id="cb257-5"><a href="timeseries.html#cb257-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb257-6"><a href="timeseries.html#cb257-6" aria-hidden="true" tabindex="-1"></a>Florida.ts.MA15 <span class="ot">&lt;-</span> Florida.ts <span class="sc">%&gt;%</span></span>
<span id="cb257-7"><a href="timeseries.html#cb257-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb257-8"><a href="timeseries.html#cb257-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">15-MA</span><span class="st">`</span> <span class="ot">=</span> slider<span class="sc">::</span><span class="fu">slide_dbl</span>(Y.Death, mean,</span>
<span id="cb257-9"><a href="timeseries.html#cb257-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">.before =</span> <span class="dv">7</span>, <span class="at">.after =</span> <span class="dv">7</span>, <span class="at">.complete =</span> <span class="cn">TRUE</span>)</span>
<span id="cb257-10"><a href="timeseries.html#cb257-10" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>To see what the trend-cycle estimate looks like, we plot the above two moving average trends along with the original data in Figure <a href="timeseries.html#fig:MA15">10.12</a>.</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="timeseries.html#cb258-1" aria-hidden="true" tabindex="-1"></a>Florida.ts <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(Y.Death) <span class="sc">+</span></span>
<span id="cb258-2"><a href="timeseries.html#cb258-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(Florida.ts.MA5, <span class="st">`</span><span class="at">5-MA</span><span class="st">`</span>, <span class="at">color =</span> <span class="st">&quot;green&quot;</span>) <span class="sc">+</span></span>
<span id="cb258-3"><a href="timeseries.html#cb258-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(Florida.ts.MA15, <span class="st">`</span><span class="at">15-MA</span><span class="st">`</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb258-4"><a href="timeseries.html#cb258-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Death count&quot;</span>, </span>
<span id="cb258-5"><a href="timeseries.html#cb258-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">title =</span> <span class="st">&quot;Florida daily new death count with moving average trend&quot;</span>) <span class="sc">+</span></span>
<span id="cb258-6"><a href="timeseries.html#cb258-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">&quot;series&quot;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:MA15"></span>
<img src="SLID_book_files/figure-html/MA15-1.png" alt="Florida daily new death count with the 5-MA (green) and 15-MA (red) smoothing of the trend." width="672" />
<p class="caption">
Figure 10.12: Florida daily new death count with the 5-MA (green) and 15-MA (red) smoothing of the trend.
</p>
</div>
<ol start="3" style="list-style-type: decimal">
<li>Simple exponential smoothing</li>
</ol>
<p>Consider the following nonseasonal model with trend:
<span class="math display">\[
Y_t=m_t+Z_t,
\]</span>
where <span class="math inline">\(\mathrm{E}Z_t=0\)</span>.</p>
<p>We can estimate <span class="math inline">\(m_t\)</span> using simple exponential smoothing. For any fixed <span class="math inline">\(0&lt;\alpha&lt;1\)</span>, consider <span class="math inline">\(\hat{m}_t\)</span> defined by the following recursions:</p>
<p><span class="math display">\[\begin{eqnarray*}
\hat{m}_1 &amp;=&amp; Y_1, \mathrm{~~and}\\
\hat{m}_t &amp;=&amp; \alpha Y_t+(1-\alpha)\hat{m}_{t-1}\\
          &amp;=&amp; \alpha Y_t+(1-\alpha)\{\alpha Y_{t-1}+(1-\alpha)\hat{m}_{t-2}\}\\
          &amp;=&amp; \alpha Y_t+(1-\alpha)\alpha Y_{t-1}+(1-\alpha)^2\alpha X_{t-2}+(1-\alpha)^3\hat{m}_{t-3}\\
          &amp;=&amp; \ldots
\end{eqnarray*}\]</span></p>
<p>with exponentially decreasing weights on previous observations: <span class="math inline">\(\alpha(1-\alpha)^0\)</span> on <span class="math inline">\(Y_t\)</span>, <span class="math inline">\(\alpha(1-\alpha)^1\)</span> on <span class="math inline">\(Y_{t-1}\)</span>, <span class="math inline">\(\alpha(1-\alpha)^2\)</span> on <span class="math inline">\(Y_{t-2}\)</span>, <span class="math inline">\(\ldots\)</span></p>
<ul>
<li><span class="math inline">\(\alpha\rightarrow 1\)</span>, less bias, more variance;</li>
<li><span class="math inline">\(\alpha\rightarrow 0\)</span>, more bias, less variance.</li>
</ul>
<p>This method is suitable for forecasting data with no clear trend or seasonal pattern. The function <code>ETS</code> function returns forecasts and other information for the exponential smoothing forecasts. There are several versions of the ETS models; see <span class="citation"><a href="appendix-b.html#ref-Hyndman2018" role="doc-biblioref">Hyndman and Athanasopoulos</a> (<a href="appendix-b.html#ref-Hyndman2018" role="doc-biblioref">2018b</a>)</span>. You can specify the details of the ETS model by choosing different options in the <code>error</code>, <code>trend</code> and <code>season</code> specials.</p>
<ul>
<li>The form of the error term: either additive (“A”) or multiplicative (“M”). If the error is multiplicative, the data must be non-negative.</li>
<li>The form of the trend term: either none (“N”), additive (“A”), multiplicative (“M”) or damped variants (“Ad,” “Md”).</li>
<li>The form of the seasonal term: either none (“N”), additive (“A”) or multiplicative (“M”)</li>
</ul>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="timeseries.html#cb259-1" aria-hidden="true" tabindex="-1"></a>ets_fit <span class="ot">&lt;-</span> Florida.ts <span class="sc">%&gt;%</span> </span>
<span id="cb259-2"><a href="timeseries.html#cb259-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ETS</span>(Y.Death </span>
<span id="cb259-3"><a href="timeseries.html#cb259-3" aria-hidden="true" tabindex="-1"></a>            <span class="sc">~</span> <span class="fu">error</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">&quot;N&quot;</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">&quot;N&quot;</span>), </span>
<span id="cb259-4"><a href="timeseries.html#cb259-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">opt_crit =</span> <span class="st">&quot;mse&quot;</span>)) </span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:predses1"></span>
<img src="SLID_book_files/figure-html/predses1-1.png" alt="Two weeks ahead forecast of the daily death count for Florida using the simple exponential smoothing method." width="672" />
<p class="caption">
Figure 10.13: Two weeks ahead forecast of the daily death count for Florida using the simple exponential smoothing method.
</p>
</div>
<p>The <code>ETS()</code> also allows you to extend the simple exponential smoothing to allow the forecasting of data with a trend and seasonality.</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="timeseries.html#cb260-1" aria-hidden="true" tabindex="-1"></a>etss_fit <span class="ot">&lt;-</span> Florida.ts <span class="sc">%&gt;%</span> </span>
<span id="cb260-2"><a href="timeseries.html#cb260-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="st">`</span><span class="at">ETS</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ETS</span>(Y.Death </span>
<span id="cb260-3"><a href="timeseries.html#cb260-3" aria-hidden="true" tabindex="-1"></a>                       <span class="sc">~</span> <span class="fu">error</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">&quot;A&quot;</span>))) </span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:predses2"></span>
<img src="SLID_book_files/figure-html/predses2-1.png" alt="Two weeks ahead forecast of the daily death count for Florida using the extended exponential smoothing method with trend and seasonality components." width="672" />
<p class="caption">
Figure 10.14: Two weeks ahead forecast of the daily death count for Florida using the extended exponential smoothing method with trend and seasonality components.
</p>
</div>
<p>Figure <a href="timeseries.html#fig:etssobs">10.15</a> display the observed and fitted daily death count using the extended exponential smoothing method with trend and seasonality components.</p>
<div class="figure" style="text-align: center"><span id="fig:etssobs"></span>
<img src="SLID_book_files/figure-html/etssobs-1.png" alt="Time series plot of the observed and fitted daily death count." width="672" />
<p class="caption">
Figure 10.15: Time series plot of the observed and fitted daily death count.
</p>
</div>
</div>
<div id="seasonal-component" class="section level3" number="10.3.3">
<h3><span class="header-section-number">10.3.3</span> Seasonal component</h3>
<p>The methods described for the estimation and elimination of trend can be adapted in a natural way to eliminate both trend and seasonality in the general model, specified as follows.</p>
<p>Classical decomposition:
<span class="math display">\[
X_t=m_t+s_t+Y_t
\]</span>
where <span class="math inline">\(s_t\)</span> has cyclic behavior of known  <span class="math inline">\(d\)</span> (e.g., <span class="math inline">\(d=12\)</span> months), i.e.,
there is a perfect repetition in <span class="math inline">\(s_t\)</span>: <span class="math inline">\(s_{t}=s_{t+d}\)</span> (e.g., Jan 2010 <span class="math inline">\(=\)</span> Jan 2011 <span class="math inline">\(=\)</span> Jan 2012 <span class="math inline">\(=\)</span> ).
We assume that <span class="math inline">\(\sum_{j=0}^{d-1}s_{t-j}=0\)</span> for model identifiability. Note that if <span class="math inline">\(\sum_{j=0}^{d-1}s_{t-j}=c\)</span>, we can always have <span class="math inline">\(\sum_{j=0}^{d-1}(s_{t-j}-c/d)=0\)</span>.</p>
<p>We first need to identify the seasonal components (what is the  and/or ):</p>
<ul>
<li>Time series plot</li>
<li>Smooth the series</li>
<li>ACF plot</li>
</ul>
<p>Once we have identified the seasonal component we can model it:</p>
<ul>
<li><p>Simple differencing (e.g., <span class="math inline">\(X_t-X_{t-12}\)</span>)</p></li>
<li><p>Moving average</p></li>
<li><p>Dummy variables
<span class="math display">\[
s_{t}=\left\{\begin{array}{ll}
             r_1 &amp; t=1,1+d,1+2d,1+3d,\ldots \\
             r_2 &amp; t=2,2+d,2+2d,2+3d,\ldots \\
             \vdots &amp;  \\
             r_{d-1} &amp; t=d-1,2d-1,3d-1,\ldots \\
             -\sum_{k=1}^{d-1} r_k &amp; t=d,2d,3d,\ldots
           \end{array}
\right.
\]</span>
Regression of <span class="math inline">\(X_t\)</span>, dummy variables <span class="math inline">\(s_t\)</span> over <span class="math inline">\(t\)</span>
<span class="math display">\[
\min \sum_{t=1}^n (X_t-s_t)^2
\]</span>
for <span class="math inline">\(r_1,\ldots,r_{d-1}\)</span>.</p></li>
<li><p>Harmonic function (series of sin/cos functions)</p></li>
</ul>
</div>
<div id="trend-and-seasonal-estimation" class="section level3" number="10.3.4">
<h3><span class="header-section-number">10.3.4</span> Trend and seasonal estimation:</h3>
<p>Step 1. Form preliminary estimate <span class="math inline">\(\hat{m}_t\)</span> of trend by passing data through filter/smoothing that eliminates <span class="math inline">\(s_t\)</span> as much as possible.</p>
<p>Step 2. Subtract trend estimate from data: <span class="math inline">\(u_t = x_t - \hat{m}_t\)</span> .</p>
<p>Step 3. Obtain seasonal pattern estimate <span class="math inline">\(\{\hat{s}_j : j = 1,\ldots,d\}\)</span>.</p>
<p>Step 4. Replicate <span class="math inline">\(\{\hat{s}_j\}\)</span> as need be to form estimate <span class="math inline">\(\{\hat{s}_t\}\)</span> of <span class="math inline">\(\{s_t\}\)</span>.</p>
<p>Step 5. Form deseasonalized data: <span class="math inline">\(d_t = x_t -\hat{s}_t\)</span>.</p>
<p>Step 6. Use deseasonalized data to get final estimate <span class="math inline">\(\hat{m}_t\)</span> of trend.</p>
</div>
<div id="seasonal-and-trend-decomposition-using-loess-stl" class="section level3" number="10.3.5">
<h3><span class="header-section-number">10.3.5</span> Seasonal and trend decomposition using Loess (STL)</h3>
<p><code>STL</code> developed by <span class="citation"><a href="appendix-b.html#ref-Cleveland1990" role="doc-biblioref">Cleveland et al.</a> (<a href="appendix-b.html#ref-Cleveland1990" role="doc-biblioref">1990</a>)</span> is a versatile and robust method for decomposing time series. STL is an acronym for “Seasonal and Trend decomposition using Loess,” while Loess is a method for estimating nonlinear relationships.</p>
<p>The algorithm updates trend and seasonal components iteratively: The seasonal values are removed, and the remainder smoothed to find the trend. The overall level is removed from the seasonal component and added to the trend component. This process is iterated a few times. The remainder component is the residuals from the seasonal plus trend fit.</p>
<p>Below we will demonstrate how to use the <code>STL()</code> to decompose the time series of the daily new death count in Florida.</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="timeseries.html#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Time series decomposition</span></span>
<span id="cb261-2"><a href="timeseries.html#cb261-2" aria-hidden="true" tabindex="-1"></a>dcmp <span class="ot">&lt;-</span> Florida.ts <span class="sc">%&gt;%</span></span>
<span id="cb261-3"><a href="timeseries.html#cb261-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">STL</span>(Y.Death))</span>
<span id="cb261-4"><a href="timeseries.html#cb261-4" aria-hidden="true" tabindex="-1"></a><span class="fu">components</span>(dcmp)</span></code></pre></div>
<pre><code>## # A dable:           324 x 8 [1D]
## # Key:               State, .model [1]
## # STL Decomposition: Y.Death = trend + season_week +
## #   remainder
##    State .model DATE       Y.Death    trend season_week
##    &lt;fct&gt; &lt;chr&gt;  &lt;date&gt;       &lt;int&gt;    &lt;dbl&gt;       &lt;dbl&gt;
##  1 Flor… STL(Y… 2020-01-23       0 -0.0944       0.415 
##  2 Flor… STL(Y… 2020-01-24       0 -0.0748      -0.139 
##  3 Flor… STL(Y… 2020-01-25       0 -0.0553       0.182 
##  4 Flor… STL(Y… 2020-01-26       0 -0.0407      -0.0670
##  5 Flor… STL(Y… 2020-01-27       0 -0.0262      -0.364 
##  6 Flor… STL(Y… 2020-01-28       0 -0.0162       0.0220
##  7 Flor… STL(Y… 2020-01-29       0 -0.00616     -0.0895
##  8 Flor… STL(Y… 2020-01-30       0 -0.00120      0.497 
##  9 Flor… STL(Y… 2020-01-31       0  0.00376     -0.158 
## 10 Flor… STL(Y… 2020-02-01       0  0.00224      0.214 
## # … with 314 more rows, and 2 more variables:
## #   remainder &lt;dbl&gt;, season_adjust &lt;dbl&gt;</code></pre>
<p>We will decompose the time series of the daily new deaths in Florida as shown in Figure <a href="timeseries.html#fig:death1">10.1</a>. Figure <a href="timeseries.html#fig:dcmp1">10.16</a> shows the trend of the time series.</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="timeseries.html#cb263-1" aria-hidden="true" tabindex="-1"></a>Florida.ts <span class="sc">%&gt;%</span></span>
<span id="cb263-2"><a href="timeseries.html#cb263-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(Y.Death, <span class="at">color =</span> <span class="st">&quot;gray&quot;</span>) <span class="sc">+</span></span>
<span id="cb263-3"><a href="timeseries.html#cb263-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">components</span>(dcmp), trend, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb263-4"><a href="timeseries.html#cb263-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Death Count&quot;</span>, </span>
<span id="cb263-5"><a href="timeseries.html#cb263-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Daily New Death Count with Trend&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:dcmp1"></span>
<img src="SLID_book_files/figure-html/dcmp1-1.png" alt="Trend of the daily new death count time series in Florida." width="672" />
<p class="caption">
Figure 10.16: Trend of the daily new death count time series in Florida.
</p>
</div>
<p>Next, we can draw the STL decomposition: trend, days of week effect and remainder, using the <code>autoplot()</code> function.</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="timeseries.html#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="fu">components</span>(dcmp) <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>()</span></code></pre></div>
<p><img src="SLID_book_files/figure-html/unnamed-chunk-169-1.png" width="672" /></p>
<p>The <code>STL()</code> function also allows us to choose the trend window <code>trend(window = )</code> and the seasonal window <code>season(window = )</code>, which controls how rapidly the trend and seasonal components can change. The smaller the value, the more rapid the changes. The trend window is the number of consecutive observations to be used when estimating the trend-cycle; the season window is the number of consecutive days to estimate each value in the seasonal component. For example, Figure <a href="timeseries.html#fig:dcmp2">10.17</a> shows the trend, seasonality and residuals of the daily new death count time series in Florida based on <code>trend(window = 15)</code> and <code>season(window = 7)</code>. Both trend and seasonal windows should be odd numbers.</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="timeseries.html#cb265-1" aria-hidden="true" tabindex="-1"></a>Florida.ts <span class="sc">%&gt;%</span></span>
<span id="cb265-2"><a href="timeseries.html#cb265-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">STL</span>(Y.Death <span class="sc">~</span> <span class="fu">trend</span>(<span class="at">window =</span> <span class="dv">15</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="at">window =</span> <span class="dv">7</span>),</span>
<span id="cb265-3"><a href="timeseries.html#cb265-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">robust =</span> <span class="cn">TRUE</span></span>
<span id="cb265-4"><a href="timeseries.html#cb265-4" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb265-5"><a href="timeseries.html#cb265-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">components</span>() <span class="sc">%&gt;%</span></span>
<span id="cb265-6"><a href="timeseries.html#cb265-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:dcmp2"></span>
<img src="SLID_book_files/figure-html/dcmp2-1.png" alt="The trend, seasonality and residuals of the daily new death count time series in Florida based on trend window = 14 and seasonal window = 7." width="672" />
<p class="caption">
Figure 10.17: The trend, seasonality and residuals of the daily new death count time series in Florida based on trend window = 14 and seasonal window = 7.
</p>
</div>
</div>
</div>
<div id="simple-time-series-forecasting-approaches" class="section level2" number="10.4">
<h2><span class="header-section-number">10.4</span> Simple Time Series Forecasting Approaches</h2>
<p>We use data-driven prediction approaches without considering any other aspect, such as the disease spread mechanism. We describe each approach in detail in the following subsections. If <span class="math inline">\(\{Z_t\}\)</span> is a sequence of independent random variables that follow the same normal distribution with zero mean, we call <span class="math inline">\(\{Z_t\}\)</span> IID Gaussian noise.</p>
<div id="average-method" class="section level3" number="10.4.1">
<h3><span class="header-section-number">10.4.1</span> Average method</h3>
<p>Denote the time series data by <span class="math inline">\(\{Y_t\}\)</span>, and consider the following model:
<span class="math display">\[
Y_t=\mu+Z_t, 
\]</span>
where <span class="math inline">\(\{Z_t\}\)</span> are IID gaussian noise.</p>
<p>The average method assumes that forecasts of all future values are equal to the average (or “mean”) of the historical data. If we let the historical data be denoted by <span class="math inline">\(Y_1,\ldots,Y_n\)</span>, and let <span class="math inline">\(\hat{Y}_{n+h|n}\)</span> be the estimate of <span class="math inline">\(Y_{n+h}\)</span> based on the historical data, then we can write the forecasts as
<span class="math display">\[
\hat{Y}_{n+h|n}=\frac{1}{n}\sum_{t=1}^n Y_t.
\]</span></p>
<p>For a numeric vector or time series of class <code>ts</code> <span class="math inline">\(y\)</span>, the function <code>MEAN(y)</code> returns an i.i.d model applied to <code>y</code>. The <code>forecast(h = )</code> returns the forecasts and prediction intervals for <span class="math inline">\(Y_{n+h}\)</span> via the average method, and <span class="math inline">\(h\)</span> is the number of periods for forecasting. Figure <a href="timeseries.html#fig:predmean">10.18</a> shows the two weeks ahead forecast and 95% prediction intervals for the daily death count in Florida based on the average method.</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="timeseries.html#cb266-1" aria-hidden="true" tabindex="-1"></a>Florida.ts <span class="sc">%&gt;%</span> </span>
<span id="cb266-2"><a href="timeseries.html#cb266-2" aria-hidden="true" tabindex="-1"></a><span class="fu">model</span>(<span class="fu">MEAN</span>(Y.Death))<span class="sc">%&gt;%</span></span>
<span id="cb266-3"><a href="timeseries.html#cb266-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">14</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb266-4"><a href="timeseries.html#cb266-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(Florida.ts, <span class="at">level =</span> <span class="dv">95</span>, <span class="at">title =</span> <span class="st">&quot;Average Method&quot;</span>) <span class="sc">+</span></span>
<span id="cb266-5"><a href="timeseries.html#cb266-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Death count&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Average Method&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:predmean"></span>
<img src="SLID_book_files/figure-html/predmean-1.png" alt="Two weeks ahead forecast of the daily death count for Florida using the average method." width="672" />
<p class="caption">
Figure 10.18: Two weeks ahead forecast of the daily death count for Florida using the average method.
</p>
</div>
</div>
<div id="random-walk-forecasts" class="section level3" number="10.4.2">
<h3><span class="header-section-number">10.4.2</span> Random walk forecasts</h3>
<p>The random walk model assumes that
<span class="math display">\[
Y_t=Y_{t-1}+Z_t,
\]</span>
where <span class="math inline">\(\{Z_t\}\)</span> are IID gaussian noise.</p>
<p>The random walk approach simply sets all forecasts to be the value of the last observation. That is,
<span class="math display">\[
\hat{Y}_{n+h|n}=Y_n.
\]</span>
The function <code>RW(y)</code> or <code>NAIVE(y)</code> together with <code>forecast(h)</code> provide the random walk forecasts and prediction intervals for <span class="math inline">\(Y_{n+h}\)</span>.</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="timeseries.html#cb267-1" aria-hidden="true" tabindex="-1"></a>Florida.ts <span class="sc">%&gt;%</span> <span class="fu">model</span>(<span class="fu">RW</span>(Y.Death))<span class="sc">%&gt;%</span></span>
<span id="cb267-2"><a href="timeseries.html#cb267-2" aria-hidden="true" tabindex="-1"></a><span class="co"># NAIVE(Y.Death) is an equivalent alternative</span></span>
<span id="cb267-3"><a href="timeseries.html#cb267-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">14</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb267-4"><a href="timeseries.html#cb267-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(Florida.ts, <span class="at">level =</span> <span class="dv">95</span>) <span class="sc">+</span></span>
<span id="cb267-5"><a href="timeseries.html#cb267-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Death count&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Random Work Method&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:predrw"></span>
<img src="SLID_book_files/figure-html/predrw-1.png" alt="Two weeks ahead forecast of the daily death count for Florida using the random walk method." width="672" />
<p class="caption">
Figure 10.19: Two weeks ahead forecast of the daily death count for Florida using the random walk method.
</p>
</div>
</div>
<div id="seasonal-random-walk-forecasts" class="section level3" number="10.4.3">
<h3><span class="header-section-number">10.4.3</span> Seasonal random walk forecasts</h3>
<p>A similar method is useful for highly seasonal data. In this case, we set each forecast to be equal to the last observed value from the same time of the previous period. Formally, the forecast for time <span class="math inline">\(n+h\)</span> is written as
<span class="math display">\[
\hat{Y}_{n+h|n}=Y_{n+h-m(k+1)},
\]</span>
where <span class="math inline">\(d=\)</span> the seasonal period, and <span class="math inline">\(k=[(h-1)/d]\)</span>, that is, the integer part of <span class="math inline">\((h-1)/d\)</span>. For COVID-19 data, we often observe the seven day cycle; see <span class="citation"><a href="appendix-b.html#ref-wang:2020:comparing" role="doc-biblioref">Wang et al.</a> (<a href="appendix-b.html#ref-wang:2020:comparing" role="doc-biblioref">2020</a>)</span>. Then, <span class="math inline">\(d=7\)</span> and <span class="math inline">\(k\)</span> is the number of complete weeks in the forecast period prior to time <span class="math inline">\(n+h\)</span>.</p>
<p>The function <code>SNAIVE(y)</code> with <code>forecast(h)</code> provides the seasonal random walk forecasts and prediction intervals for <span class="math inline">\(Y_{n+h}\)</span>.</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="timeseries.html#cb268-1" aria-hidden="true" tabindex="-1"></a>Florida.ts <span class="sc">%&gt;%</span> <span class="fu">model</span>(<span class="fu">SNAIVE</span>(Y.Death))<span class="sc">%&gt;%</span></span>
<span id="cb268-2"><a href="timeseries.html#cb268-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">14</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb268-3"><a href="timeseries.html#cb268-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(Florida.ts, <span class="at">level =</span> <span class="dv">95</span>) <span class="sc">+</span></span>
<span id="cb268-4"><a href="timeseries.html#cb268-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Death count&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Seasonal Random Work Method&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:predsnaive"></span>
<img src="SLID_book_files/figure-html/predsnaive-1.png" alt="Two weeks ahead forecast of the daily death count for Florida using the seasonal random walk method." width="672" />
<p class="caption">
Figure 10.20: Two weeks ahead forecast of the daily death count for Florida using the seasonal random walk method.
</p>
</div>
</div>
<div id="random-walk-with-drift-method" class="section level3" number="10.4.4">
<h3><span class="header-section-number">10.4.4</span> Random walk with drift method</h3>
<p>The random walk with drift model is
<span class="math display">\[
Y_t=c+Y_{t-1}+Z_t
\]</span>
where <span class="math inline">\(\{Z_t\}\)</span> are i.i.d and follow a normal distribution.</p>
<p>A variation on the random walk method allows the forecasts to increase or decrease over time, where the amount of change over time (called the <strong>drift</strong>) is set to be the average change seen in the historical data. Forecasts are given by
<span class="math display">\[
\hat{Y}_{n+h|n}=\hat{c}h+Y_n=Y_n+h\left(\frac{Y_n-Y_1}{n-1}\right).
\]</span></p>
<p>We use the <code>RW( ~ drift())</code> with <code>forecast(h)</code> provide to make an <span class="math inline">\(h\)</span> step ahead forecast.</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="timeseries.html#cb269-1" aria-hidden="true" tabindex="-1"></a>Florida.ts <span class="sc">%&gt;%</span> </span>
<span id="cb269-2"><a href="timeseries.html#cb269-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">RW</span>(Y.Death <span class="sc">~</span> <span class="fu">drift</span>())) <span class="sc">%&gt;%</span> </span>
<span id="cb269-3"><a href="timeseries.html#cb269-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">14</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb269-4"><a href="timeseries.html#cb269-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(Florida.ts, <span class="at">level =</span> <span class="dv">95</span>)  <span class="sc">+</span></span>
<span id="cb269-5"><a href="timeseries.html#cb269-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Death count&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Random Work Method with Drift&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:predrwd"></span>
<img src="SLID_book_files/figure-html/predrwd-1.png" alt="Two weeks ahead forecast of the daily death count for Florida using the random walk with drift method." width="672" />
<p class="caption">
Figure 10.21: Two weeks ahead forecast of the daily death count for Florida using the random walk with drift method.
</p>
</div>
</div>
<div id="displaying-all-the-forecasting-results" class="section level3" number="10.4.5">
<h3><span class="header-section-number">10.4.5</span> Displaying all the forecasting results</h3>
<p>Now, let us display all the forecasting results based on the previous methods together. Figure <a href="timeseries.html#fig:pred4">10.22</a> shows the comparison among different methods.</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="timeseries.html#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the models using 4 different methods</span></span>
<span id="cb270-2"><a href="timeseries.html#cb270-2" aria-hidden="true" tabindex="-1"></a>death_fit <span class="ot">&lt;-</span> Florida.ts <span class="sc">%&gt;%</span></span>
<span id="cb270-3"><a href="timeseries.html#cb270-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(</span>
<span id="cb270-4"><a href="timeseries.html#cb270-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean =</span> <span class="fu">MEAN</span>(Y.Death),</span>
<span id="cb270-5"><a href="timeseries.html#cb270-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">RW</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">RW</span>(Y.Death),</span>
<span id="cb270-6"><a href="timeseries.html#cb270-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Seasonal naïve</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">SNAIVE</span>(Y.Death),</span>
<span id="cb270-7"><a href="timeseries.html#cb270-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">RW-Drift</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">RW</span>(Y.Death <span class="sc">~</span> <span class="fu">drift</span>())</span>
<span id="cb270-8"><a href="timeseries.html#cb270-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb270-9"><a href="timeseries.html#cb270-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate forecasts for the next 2 weeks</span></span>
<span id="cb270-10"><a href="timeseries.html#cb270-10" aria-hidden="true" tabindex="-1"></a>death_fc <span class="ot">&lt;-</span> death_fit <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">14</span>)</span>
<span id="cb270-11"><a href="timeseries.html#cb270-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the forecasts in one plot</span></span>
<span id="cb270-12"><a href="timeseries.html#cb270-12" aria-hidden="true" tabindex="-1"></a>death_fc <span class="sc">%&gt;%</span></span>
<span id="cb270-13"><a href="timeseries.html#cb270-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Show the point forecasts only without prediction intervals</span></span>
<span id="cb270-14"><a href="timeseries.html#cb270-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(Florida.ts, <span class="at">level =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb270-15"><a href="timeseries.html#cb270-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Death count&quot;</span>, </span>
<span id="cb270-16"><a href="timeseries.html#cb270-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Simple Time Series Forecasting Methods&quot;</span>) <span class="sc">+</span></span>
<span id="cb270-17"><a href="timeseries.html#cb270-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">&quot;Forecast&quot;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:pred4"></span>
<img src="SLID_book_files/figure-html/pred4-1.png" alt="Two weeks ahead forecast of the daily death count for Florida using four different methods." width="672" />
<p class="caption">
Figure 10.22: Two weeks ahead forecast of the daily death count for Florida using four different methods.
</p>
</div>
</div>
<div id="distributional-forecasts-and-prediction-intervals" class="section level3" number="10.4.6">
<h3><span class="header-section-number">10.4.6</span> Distributional forecasts and prediction intervals</h3>
<div id="forecast-distributions" class="section level4" number="10.4.6.1">
<h4><span class="header-section-number">10.4.6.1</span> Forecast distributions</h4>
<p>A forecast <span class="math inline">\(\hat{Y}_{n+h|n}\)</span> is (usually) the mean of the conditional distribution <span class="math inline">\(Y_{n+h} \mid Y_1, \dots, Y_{n}\)</span>. Most time series models produce normally distributed forecasts. The forecast distribution describes the probability of observing any future value.</p>
<p>Assuming residuals are normal, uncorrelated, with standard deviation <span class="math inline">\(\hat\sigma\)</span>:</p>
<ul>
<li><strong>Mean:</strong> <span class="math inline">\(\hat{Y}_{n+h|n} \sim N(\bar{Y}, (1 + 1/n)\hat{\sigma}^2)\)</span>;</li>
<li><strong>Random walk:</strong> <span class="math inline">\(\hat{Y}_{n+h|n} \sim N(Y_n, h\hat{\sigma}^2)\)</span>;</li>
<li><strong>Seasonal random walk:</strong> <span class="math inline">\(\hat{Y}_{n+h|n} \sim N(Y_{n+h-m(k+1)}, (k+1)\hat{\sigma}^2)\)</span>, where <span class="math inline">\(k\)</span> is the integer part of <span class="math inline">\((h-1)/m\)</span>;</li>
<li><strong>Drift:</strong> <span class="math inline">\(\hat{Y}_{n+h|n} \sim N(Y_n + \frac{h}{n-1}(Y_n - Y_1),h\frac{n+h}{n}\hat{\sigma}^2)\)</span>.</li>
</ul>
<p>Note that when <span class="math inline">\(h=1\)</span> and <span class="math inline">\(n\)</span> is large, these all give the same approximate forecast variance: <span class="math inline">\(\hat{\sigma}^2\)</span>.</p>
</div>
<div id="prediction-intervals" class="section level4" number="10.4.6.2">
<h4><span class="header-section-number">10.4.6.2</span> Prediction intervals</h4>
<p>A prediction interval gives a region within which we expect <span class="math inline">\(Y_{n+h}\)</span> to lie with a specified probability. Assuming forecast errors are normally distributed, then a 95% PI is
<span class="math display">\[
  \hat{Y}_{n+h|n} \pm 1.96 \hat\sigma_h
\]</span>
where <span class="math inline">\(\hat\sigma_h\)</span> is the standard deviation of the <span class="math inline">\(h\)</span>-step distribution. When <span class="math inline">\(h=1\)</span>, <span class="math inline">\(\hat\sigma_h\)</span> can be estimated from the residuals.</p>
<p>We can use the <code>hilo()</code> function to convert the forecast distributions into intervals. By default, 80% and 95% prediction intervals are returned. We can use <code>level</code> argument to control coverage. The function <code>unpack_hilo()</code> allows a hilo column to be unpacked into its component columns: “lower,” “upper,” and “level.”</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="timeseries.html#cb271-1" aria-hidden="true" tabindex="-1"></a>fc_result <span class="ot">&lt;-</span> Florida.ts <span class="sc">%&gt;%</span> </span>
<span id="cb271-2"><a href="timeseries.html#cb271-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">RW</span>(Y.Death <span class="sc">~</span> <span class="fu">drift</span>())) <span class="sc">%&gt;%</span> </span>
<span id="cb271-3"><a href="timeseries.html#cb271-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">14</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb271-4"><a href="timeseries.html#cb271-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hilo</span>(<span class="at">level =</span> <span class="dv">95</span>)</span>
<span id="cb271-5"><a href="timeseries.html#cb271-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-6"><a href="timeseries.html#cb271-6" aria-hidden="true" tabindex="-1"></a><span class="fu">unpack_hilo</span>(fc_result, <span class="st">`</span><span class="at">95%</span><span class="st">`</span>)</span></code></pre></div>
<pre><code>## # A tsibble: 14 x 7 [1D]
## # Key:       State, .model [1]
##    State .model DATE             Y.Death .mean `95%_lower`
##    &lt;fct&gt; &lt;chr&gt;  &lt;date&gt;            &lt;dist&gt; &lt;dbl&gt;       &lt;dbl&gt;
##  1 Flor… RW(Y.… 2020-12-12  N(123, 1810)  123.       40.0 
##  2 Flor… RW(Y.… 2020-12-13  N(124, 3631)  124.        5.66
##  3 Flor… RW(Y.… 2020-12-14  N(124, 5463)  124.      -20.7 
##  4 Flor… RW(Y.… 2020-12-15  N(125, 7307)  125.      -43.0 
##  5 Flor… RW(Y.… 2020-12-16  N(125, 9161)  125.      -62.7 
##  6 Flor… RW(Y.… 2020-12-17 N(125, 11027)  125.      -80.5 
##  7 Flor… RW(Y.… 2020-12-18 N(126, 12904)  126.      -97.0 
##  8 Flor… RW(Y.… 2020-12-19 N(126, 14792)  126.     -112.  
##  9 Flor… RW(Y.… 2020-12-20 N(126, 16692)  126.     -127.  
## 10 Flor… RW(Y.… 2020-12-21 N(127, 18603)  127.     -141.  
## 11 Flor… RW(Y.… 2020-12-22 N(127, 20524)  127.     -154.  
## 12 Flor… RW(Y.… 2020-12-23 N(128, 22458)  128.     -166.  
## 13 Flor… RW(Y.… 2020-12-24 N(128, 24402)  128.     -178.  
## 14 Flor… RW(Y.… 2020-12-25 N(128, 26357)  128.     -190.  
## # … with 1 more variable: `95%_upper` &lt;dbl&gt;</code></pre>
</div>
</div>
</div>
<div id="residual-diagnostics-and-accuracy-evaluation" class="section level2" number="10.5">
<h2><span class="header-section-number">10.5</span> Residual Diagnostics and Accuracy Evaluation</h2>
<div id="residual-diagnostics" class="section level3" number="10.5.1">
<h3><span class="header-section-number">10.5.1</span> Residual diagnostics</h3>
<p>The fitted values and residuals from a model can be obtained using the <code>augment()</code> function. In the above example, we saved the fitted models as beer_fit. So we can simply apply <code>augment()</code> to this object to compute the fitted values and residuals for all models.</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="timeseries.html#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="fu">augment</span>(death_lmfit)</span></code></pre></div>
<pre><code>## # A tsibble: 324 x 7 [1D]
## # Key:       State, .model [1]
##    State  .model    DATE       Y.Death .fitted .resid .innov
##    &lt;fct&gt;  &lt;chr&gt;     &lt;date&gt;       &lt;int&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
##  1 Flori… TSLM(Y.D… 2020-01-23       0    4.66  -4.66  -4.66
##  2 Flori… TSLM(Y.D… 2020-01-24       0    5.01  -5.01  -5.01
##  3 Flori… TSLM(Y.D… 2020-01-25       0    5.35  -5.35  -5.35
##  4 Flori… TSLM(Y.D… 2020-01-26       0    5.70  -5.70  -5.70
##  5 Flori… TSLM(Y.D… 2020-01-27       0    6.05  -6.05  -6.05
##  6 Flori… TSLM(Y.D… 2020-01-28       0    6.40  -6.40  -6.40
##  7 Flori… TSLM(Y.D… 2020-01-29       0    6.75  -6.75  -6.75
##  8 Flori… TSLM(Y.D… 2020-01-30       0    7.09  -7.09  -7.09
##  9 Flori… TSLM(Y.D… 2020-01-31       0    7.44  -7.44  -7.44
## 10 Flori… TSLM(Y.D… 2020-02-01       0    7.79  -7.79  -7.79
## # … with 314 more rows</code></pre>
<p>Residuals are useful in checking whether a model has adequately captured the information in the data. If patterns are observable in the residuals, the model can probably be improved.</p>
<p>A good forecasting method will yield residuals with the following properties:</p>
<ul>
<li>The residuals are uncorrelated. If there are correlations between residuals, then there is information left in the residuals that should be used in computing forecasts.</li>
<li>The residuals have zero mean. If the residuals have a mean other than zero, then the forecasts are biased.</li>
<li>The residuals have constant variance.</li>
<li>The residuals are normally distributed.</li>
</ul>
<p>Any forecasting method that does not satisfy these properties can be improved.</p>
<p>The residuals obtained from forecasting this series using the linear regression method with seasonal components are shown in Figure <a href="timeseries.html#fig:reslmsts">10.23</a>.</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="timeseries.html#cb275-1" aria-hidden="true" tabindex="-1"></a><span class="fu">augment</span>(death_lmsfit) <span class="sc">%&gt;%</span></span>
<span id="cb275-2"><a href="timeseries.html#cb275-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(.resid) <span class="sc">+</span></span>
<span id="cb275-3"><a href="timeseries.html#cb275-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Day&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Residual&quot;</span>, </span>
<span id="cb275-4"><a href="timeseries.html#cb275-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Residuals from linear regression with seasonal component.&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:reslmsts"></span>
<img src="SLID_book_files/figure-html/reslmsts-1.png" alt="Residual plot based on the linear regression method with seasonal components." width="672" />
<p class="caption">
Figure 10.23: Residual plot based on the linear regression method with seasonal components.
</p>
</div>
<p>A convenient shortcut for producing these residual diagnostic graphs is the <code>gg_tsresiduals()</code> function, which will produce a time plot, ACF plot and histogram of the residuals.</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="timeseries.html#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(death_lmsfit)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:reslms"></span>
<img src="SLID_book_files/figure-html/reslms-1.png" alt="Time plot, ACF plot and histogram of the residuals based on the linear regression method with seasonal components." width="672" />
<p class="caption">
Figure 10.24: Time plot, ACF plot and histogram of the residuals based on the linear regression method with seasonal components.
</p>
</div>
<p>The residuals plots obtained from forecasting this series using the extended exponential smoothing method with trend and seasonality components are shown in Figure <a href="timeseries.html#fig:resets">10.25</a>.</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="timeseries.html#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(etss_fit)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:resets"></span>
<img src="SLID_book_files/figure-html/resets-1.png" alt="Time plot, ACF plot and histogram of the residuals based on the extended ETS method with trend and seasonal components." width="672" />
<p class="caption">
Figure 10.25: Time plot, ACF plot and histogram of the residuals based on the extended ETS method with trend and seasonal components.
</p>
</div>
<p>These graphs show that the ETS method produces forecasts that appear to account for all available information. The residuals’ mean is close to zero, and there is no significant correlation in the residuals series. The time plot of the residuals shows that the variation of the residuals stays much the same across the historical data, apart from the one outlier. Therefore the residual variance can be treated as constant. This can also be seen on the histogram of the residuals. The histogram suggests that the residuals seem to be normal. Consequently, forecasts from this method will probably be quite good, but prediction intervals that are computed assuming a normal distribution seem to be reasonable.</p>
<p>Instead of checking to see whether each sample autocorrelation falls inside the bounds defined in Figure <a href="timeseries.html#fig:resets">10.25</a>, it is also possible to consider the portmanteau test such as the Ljung–Box test. The hypothesis of iid data is then rejected at level <span class="math inline">\(\alpha\)</span> if the p-value is smaller than <span class="math inline">\(\alpha\)</span>.</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="timeseries.html#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="fu">augment</span>(etss_fit) <span class="sc">%&gt;%</span></span>
<span id="cb278-2"><a href="timeseries.html#cb278-2" aria-hidden="true" tabindex="-1"></a><span class="fu">features</span>(.resid, ljung_box, <span class="at">lag=</span><span class="dv">10</span>, <span class="at">dof=</span><span class="dv">0</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 x 4
##   State   .model lb_stat lb_pvalue
##   &lt;fct&gt;   &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;
## 1 Florida ETS       16.9    0.0765</code></pre>
</div>
<div id="forecasting-accuracy" class="section level3" number="10.5.2">
<h3><span class="header-section-number">10.5.2</span> Forecasting accuracy</h3>
<p>Cross-validation (CV) is a popular technique for model comparison. First, we split the dataset into a subset called the training set, and another subset called the test set; see Figure <a href="timeseries.html#fig:training">10.26</a>. Then, we train the model on the training set, and record the forecast error on the test set.</p>
<div class="figure" style="text-align: center"><span id="fig:training"></span>
<img src="figures/training.png" alt="Training and test sets." width="75%" />
<p class="caption">
Figure 10.26: Training and test sets.
</p>
</div>
<p><strong>Forecast error</strong> is defined as the difference between an observed value and its forecast:
<span class="math display">\[
  e_{n+h} = Y_{n+h} - \hat{Y}_{n+h|n},
\]</span>
where the training data is given by <span class="math inline">\(\{Y_1,\ldots,Y_n\}\)</span>.</p>
<p>For any <span class="math inline">\(h=1,\dots,H\)</span>, let <span class="math inline">\(Y_{n+h}\)</span> be the <span class="math inline">\((n+h)\)</span>th observation. Next, let <span class="math inline">\(\hat{Y}_{n+h|n}\)</span> be its forecast based on data up to time <span class="math inline">\(n\)</span>. Denote <span class="math inline">\(e_{n+h}=Y_{n+h} - \hat{Y}_{n+h|n}\)</span>. For a continuous or discrete time series, a point forecast is usually preferred, such as the number of daily confirmed cases. To evaluate the quality of these point forecasts, several measures have been proposed:
<span class="math display">\[\begin{align*}
\text{Mean Absolute Error (MAE)}  &amp;= \text{mean}(|e_{n+h}|)\\
\text{Mean Squared Error (MSE)}  &amp;= \text{mean}(e_{n+h}^2) \\
\text{Root Mean Squared Error (RMSE)} &amp;= \sqrt{\text{mean}(e_{n+h}^2)} \\
\text{Mean Absolute Percentage Error (MAPE)} &amp;= 100\text{mean}(|e_{n+h}|/ |Y_{n+h}|)\\
\text{Mean Absolute Scaled Error (MASE)} &amp;= \text{mean}(|e_{n+h}|/Q),
\end{align*}\]</span></p>
<p>where <span class="math inline">\(Q = (n-1)^{-1}\sum_{t=2}^n |Y_t-Y_{t-1}|\)</span>.</p>
<p><strong>Remark:</strong> MAE, MSE, RMSE are all scale dependent. MAPE and MASE are scale independent, but MAPE is more sensible than MASE. MAPE can be infinite or undefined if <span class="math inline">\(Y_t=0\)</span> for any <span class="math inline">\(t\)</span> in the period of interest, and having extreme values if any <span class="math inline">\(Y_t\)</span> is close to zero.</p>
<!-- When choosing models, it is common practice to separate the available data into two portions, training and test data, where the training data is used to estimate any parameters of a forecasting method and the test data is used to evaluate its accuracy. Because the test data is not used in determining the forecasts, it should provide a reliable indication of how well the model is likely to forecast on new data. -->
<p>In the following, we divide the data <code>Florida.ts</code> into two parts: a training set (JAN 23 to NOV 27) and a validation set or test set (NOV 28 to DEC 11). The model is fit on the training set, and the fitted model is used to predict the responses for the observations in the test set. Figure <a href="timeseries.html#fig:validation">10.27</a> shows the forecasts of the daily death count for NOV 28–DEC 11 based on the training data.</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="timeseries.html#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tsibble)</span>
<span id="cb280-2"><a href="timeseries.html#cb280-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Set training data from JAN 23 to NOV 27</span></span>
<span id="cb280-3"><a href="timeseries.html#cb280-3" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> Florida.ts <span class="sc">%&gt;%</span> </span>
<span id="cb280-4"><a href="timeseries.html#cb280-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter_index</span>(<span class="st">&quot;2020-01-23&quot;</span> <span class="sc">~</span> <span class="st">&quot;2020-11-27&quot;</span>)</span>
<span id="cb280-5"><a href="timeseries.html#cb280-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-6"><a href="timeseries.html#cb280-6" aria-hidden="true" tabindex="-1"></a>Reg_fit <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span> </span>
<span id="cb280-7"><a href="timeseries.html#cb280-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="st">`</span><span class="at">LM</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">TSLM</span>(Y.Death  <span class="sc">~</span> DATE <span class="sc">+</span> <span class="fu">season</span>(<span class="dv">7</span>)),</span>
<span id="cb280-8"><a href="timeseries.html#cb280-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">ETS</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ETS</span>(Y.Death </span>
<span id="cb280-9"><a href="timeseries.html#cb280-9" aria-hidden="true" tabindex="-1"></a>                       <span class="sc">~</span> <span class="fu">error</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">&quot;A&quot;</span>))</span>
<span id="cb280-10"><a href="timeseries.html#cb280-10" aria-hidden="true" tabindex="-1"></a>        ) </span>
<span id="cb280-11"><a href="timeseries.html#cb280-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-12"><a href="timeseries.html#cb280-12" aria-hidden="true" tabindex="-1"></a>Reg_fc <span class="ot">&lt;-</span> Reg_fit <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">14</span>) </span>
<span id="cb280-13"><a href="timeseries.html#cb280-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-14"><a href="timeseries.html#cb280-14" aria-hidden="true" tabindex="-1"></a>Reg_fc <span class="sc">%&gt;%</span> </span>
<span id="cb280-15"><a href="timeseries.html#cb280-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(train, <span class="at">level =</span> <span class="dv">95</span>) <span class="sc">+</span> </span>
<span id="cb280-16"><a href="timeseries.html#cb280-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">filter_index</span>(dplyr<span class="sc">::</span><span class="fu">select</span>(Florida.ts, Y.Death), </span>
<span id="cb280-17"><a href="timeseries.html#cb280-17" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;2020-11-28&quot;</span> <span class="sc">~</span> .), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb280-18"><a href="timeseries.html#cb280-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Death count&quot;</span>, </span>
<span id="cb280-19"><a href="timeseries.html#cb280-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Exponential smoothing vs linear regression forecast&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:validation"></span>
<img src="SLID_book_files/figure-html/validation-1.png" alt="Forecasts of the daily death count for NOV 28--DEC 11 based on the training data." width="672" />
<p class="caption">
Figure 10.27: Forecasts of the daily death count for NOV 28–DEC 11 based on the training data.
</p>
</div>
<p>The <code>accuracy()</code> function can be used to obtain the accuracy of the forecast, which is able to automatically extract the relevant periods from the data (<code>Florida.ts</code> in this example) to match the forecasts when computing the various accuracy measures.</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="timeseries.html#cb281-1" aria-hidden="true" tabindex="-1"></a><span class="fu">accuracy</span>(Reg_fc, Florida.ts)</span></code></pre></div>
<pre><code>## # A tibble: 2 x 11
##   .model State   .type    ME  RMSE   MAE   MPE  MAPE  MASE
##   &lt;chr&gt;  &lt;fct&gt;   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 ETS    Florida Test   15.1  24.0  18.4  13.8  17.9 0.847
## 2 LM     Florida Test  -21.3  29.1  23.7 -25.2  27.7 1.09 
## # … with 2 more variables: RMSSE &lt;dbl&gt;, ACF1 &lt;dbl&gt;</code></pre>
<p>The Evaluating modelling accuracy chapter from the <a href="https://otexts.com/fpp3/">Forecasting: Principles and Practices</a> textbook provides more detail in how modeling and forecasting accuracy is evaluated.</p>
</div>
</div>
<div id="arima-models" class="section level2" number="10.6">
<h2><span class="header-section-number">10.6</span> ARIMA Models</h2>
<div id="differencing" class="section level3" number="10.6.1">
<h3><span class="header-section-number">10.6.1</span> Differencing</h3>
<p>When working with time series lags, it is useful to introduce the backward shift operator. Let <span class="math inline">\(B\)</span> be the backward shift operator such that <span class="math inline">\(B^{k}f(t)=f(t-k)\)</span>. For example,
<span class="math display">\[\begin{eqnarray*}
        B^{1}t &amp;=&amp; t-1,\\
        B^{2}t &amp;=&amp; t-2,\\
        B^{2}t^2 &amp;=&amp; (t-2)^2,\\
        Bc &amp;=&amp; c~~~~~~(c \mathrm{~is~a~constant})
\end{eqnarray*}\]</span></p>
<p>Next we define <span class="math inline">\(1-B\)</span> as the difference operator. Using the difference operator, is easier to describe the process of differencing, e.g.
<span class="math display">\[
(1-B)X_t=X_t-BX_t=X_t-X_{t-1}.
\]</span></p>
<p>Second-order differerence is denoted <span class="math inline">\((1-B)^2\)</span>, which is not the same as a second difference <span class="math inline">\(1-B^2\)</span>. In general, a <span class="math inline">\(d\)</span>th-order difference can be written as
<span class="math display">\[
(1-B)^d X_t.
\]</span></p>
<p>Here are two more examples:</p>
<ul>
<li>If <span class="math inline">\(m_t=\alpha+\beta t\)</span>, then the first-order difference of <span class="math inline">\(m_t\)</span> is <span class="math inline">\((1-B)m_t=\beta\)</span>.</li>
<li>If <span class="math inline">\(m_t=\alpha+\beta t+\gamma t^2\)</span>, then the second-order differences of <span class="math inline">\(m_t\)</span> is <span class="math inline">\((1-B)^2 m_t=2\gamma\)</span>.</li>
</ul>
<p>The backshift notation is particularly useful when combining differences, as the operator can be treated using ordinary algebraic rules. In particular, terms involving <span class="math inline">\(B\)</span> can be multiplied together.</p>
<p>Let <span class="math inline">\(1-B^k\)</span> be the lag-<span class="math inline">\(k\)</span> difference operator, that is,
<span class="math display">\[
   (1-B^k) X_t = X_t -X_{t-k}.
    \]</span>
Applying lag-<span class="math inline">\(d\)</span> differencing to remove seasonal, we have
<span class="math display">\[
    (1-B^d)s_t=s_{t}-B^{d}s_{t}=s_t-s_{t-d}=0.
    \]</span>
Remark: In fact,
<span class="math display">\[
        \underset{}{(1-B^d)=}\underset{\mathrm{difference~operator}}{\underbrace{(1-B)}}
        \underset{\mathrm{seasonal~summation~filter}}{\underbrace{[1+B+B^2+\cdots+B^{d-1}]}}
    \]</span>
Note: <span class="math inline">\((1+B+B^2+\cdots+B^{d-1})s_{t}=s_{t}+s_{t-1}+\cdots+s_{t-(d-1)}=\sum_{j=0}^{d-1}s_{t-j}=0\)</span>.</p>
<p>We can use the <code>difference()</code> function in the tsibble package, and two important arguments are:</p>
<ul>
<li><code>lag</code>: A positive integer indicating which lag to use.</li>
<li><code>differences</code>: A positive integer indicating the order of the difference.</li>
</ul>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="timeseries.html#cb283-1" aria-hidden="true" tabindex="-1"></a>Florida.ts <span class="sc">%&gt;%</span></span>
<span id="cb283-2"><a href="timeseries.html#cb283-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(Death)</span></code></pre></div>
<p><img src="SLID_book_files/figure-html/unnamed-chunk-174-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="timeseries.html#cb284-1" aria-hidden="true" tabindex="-1"></a>Florida.ts <span class="sc">%&gt;%</span></span>
<span id="cb284-2"><a href="timeseries.html#cb284-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(Death <span class="sc">%&gt;%</span> <span class="fu">difference</span>(<span class="dv">1</span>))</span></code></pre></div>
<p><img src="SLID_book_files/figure-html/unnamed-chunk-174-2.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="timeseries.html#cb285-1" aria-hidden="true" tabindex="-1"></a>Florida.ts <span class="sc">%&gt;%</span></span>
<span id="cb285-2"><a href="timeseries.html#cb285-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(Death <span class="sc">%&gt;%</span> <span class="fu">difference</span>(<span class="dv">7</span>))</span></code></pre></div>
<p><img src="SLID_book_files/figure-html/unnamed-chunk-174-3.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="timeseries.html#cb286-1" aria-hidden="true" tabindex="-1"></a>Florida.ts <span class="sc">%&gt;%</span></span>
<span id="cb286-2"><a href="timeseries.html#cb286-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(Death <span class="sc">%&gt;%</span> <span class="fu">difference</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">difference</span>(<span class="dv">7</span>))</span></code></pre></div>
<p><img src="SLID_book_files/figure-html/unnamed-chunk-174-4.png" width="672" style="display: block; margin: auto;" /></p>
<p>The following provides another method to eliminate the trend and seasonality using differencing.</p>
<p>Step 1. Apply a lag-<span class="math inline">\(d\)</span> differencing operator to <span class="math inline">\(X_t\)</span>, then</p>
<p><span class="math display">\[\begin{eqnarray*}
(1-B^d)X_t&amp;=&amp;m_t-m_{t-d}+s_t-s_{t-d}+Y_t-Y_{t-d}\\
&amp;=&amp;m_t-m_{t-d}+Y_t-Y_{t-d}.
\end{eqnarray*}\]</span></p>
<p>Step 2. Resulting model has a trend component defined by <span class="math inline">\(m_t-m_{t-d}\)</span> and a stochastic component given by <span class="math inline">\(Y_t-Y_{t-d}\)</span>.</p>
<p>Step 3. Trend component can be eliminated by applying an appropriate power of differencing operator, say <span class="math inline">\((1-B)^{d^{\prime}}\)</span>. Thus,
<span class="math display">\[
  \underbrace{(1-B)^{d^{\prime}}}{}\underbrace{(1-B^d)}{}X_t
  =\underbrace{(1-B)^{d^{\prime}}}{}\underbrace{(1-B^d)}{}m_t
  +\underbrace{(1-B)^{d^{\prime}}}{}\underbrace{(1-B^d)}{}Y_t
\]</span>
is a model for a series related to <span class="math inline">\(\{x_t\}\)</span> that is free of trend and
seasonal components.</p>
</div>
<div id="arma-models" class="section level3" number="10.6.2">
<h3><span class="header-section-number">10.6.2</span> ARMA models</h3>
<p>This sections introduce an important parametric family of stationary time series, the autoregressive moving-average, or ARMA, processes.</p>
<p>A process <span class="math inline">\(\{X_t\}\)</span> is said to be ARMA<span class="math inline">\((p,q)\)</span> (for integers <span class="math inline">\(p,q \geq 0\)</span>), or an AutoRegressive (AR) Moving Average (MA), with</p>
<p><span class="math display">\[\begin{eqnarray*}
\mathrm{AR~polynomial~} \phi(z) &amp;=&amp; 1 -\phi_1 z -\phi_2 z^2 - \cdots -\phi_p z^p \\
\mathrm{MA~polynomial~} \theta(z) &amp;=&amp; 1 + \theta_1 z +\theta_2 z^2 + \cdots +\theta_q z^q
\end{eqnarray*}\]</span></p>
<p>if <span class="math inline">\(\{X_t\}\)</span> satisfies</p>
<p><span class="math display">\[
\phi(B)X_t = \theta(B)Z_t \quad \mathrm{for~all~integers~} t,
\]</span></p>
<p>with respect to some <span class="math inline">\(\{Z_t\}\sim \mathrm{WN}(0,\sigma^2)\)</span>, where <span class="math inline">\(B\)</span> is the backward shift operator. That is,</p>
<p><span class="math display">\[\begin{eqnarray*}
\phi(B)X_t &amp;=&amp; X_t -\phi_1 X_{t-1} -\phi_2 X_{t-2} - \cdots -\phi_p X_{t-p}\\
&amp;=&amp;Z_t+\theta_1 Z_{t-1} +\theta_2 Z_{t-2} + \cdots +\theta_q Z_{t-q}=\theta(B)Z_t
\end{eqnarray*}\]</span></p>
<p>The time series <span class="math inline">\(\{X_t\}\)</span> is said to be an autoregressive process of order <span class="math inline">\(p\)</span> (or AR<span class="math inline">\((p)\)</span>) if <span class="math inline">\(\theta(z) \equiv 1\)</span>, and a moving-average process of order <span class="math inline">\(q\)</span> (or MA<span class="math inline">\((q)\)</span>) if <span class="math inline">\(\phi(z) \equiv 1\)</span>.</p>
</div>
<div id="simple-examples-of-arma-models" class="section level3" number="10.6.3">
<h3><span class="header-section-number">10.6.3</span> Simple examples of ARMA models</h3>
<ul>
<li><p>AR(1) or ARMA(1,0)
<span class="math display">\[
X_t=\phi X_{t-1}+Z_{t}
\]</span>
with AR polynomial: <span class="math inline">\(\phi(z)=1-\phi z\)</span> and MA polynomial: <span class="math inline">\(\theta(z)=1\)</span>.</p></li>
<li><p>MA(1) or ARMA(0,1)
<span class="math display">\[
X_t=Z_{t}+\theta Z_{t-1}
\]</span>
with AR polynomial: <span class="math inline">\(\phi(z)=1\)</span> and MA polynomial: <span class="math inline">\(\theta(z)=1 +\theta z\)</span>.</p></li>
</ul>
</div>
<div id="arima-models-1" class="section level3" number="10.6.4">
<h3><span class="header-section-number">10.6.4</span> ARIMA models</h3>
<p>We consider a generalization of the ARMA models to incorporate a wide range of nonstationary series.</p>
<p>A process <span class="math inline">\(\{Y_t\}\)</span> is said to be ARIMA<span class="math inline">\((p,d,q)\)</span> (for integers <span class="math inline">\(p,d,q \geq 0\)</span>), or an AutoRegressive (AR) Integrated (I) Moving Average (MA), if <span class="math inline">\(\{Y_t\}\)</span> satisfies</p>
<p><span class="math display">\[\begin{eqnarray*}
(1-B)^d Y_t = X_t \sim \mathrm{ARMA}(p,q) \mathrm{~for~all~integers~} t.
\end{eqnarray*}\]</span></p>
<p>Example: <span class="math inline">\(Y_t \sim\)</span> ARIMA<span class="math inline">\((p,1,q)\)</span>: suppose <span class="math inline">\(X_t \sim \mathrm{ARMA}(p,q)\)</span>
<span class="math display">\[
Y_t=Y_{t-1}+X_t=\cdots=Y_{0}+\sum_{j=1}^t X_j, ~ t=1,2, \ldots
\]</span></p>
<p><strong>Remarks:</strong></p>
<ul>
<li>For any positive integer <span class="math inline">\(d=1,2,\ldots\)</span>, <span class="math inline">\(\{Y_t\}\)</span> is not weakly stationary.</li>
<li>For <span class="math inline">\(d = 0\)</span>, <span class="math inline">\(\{Y_t\}\)</span> is just <span class="math inline">\(\mathrm{ARMA}(p, q)\)</span> [typically weakly stationary] with so-called <strong>short-memory</strong> dependence.</li>
<li>For <span class="math inline">\(0&lt;d&lt;1\)</span>, <span class="math inline">\(\{Y_t\}\)</span> is weakly stationary with so-called <strong>long-memory</strong> dependence.</li>
</ul>
<p><strong>Example 1:</strong> Suppose <span class="math inline">\(\{X_t\}\)</span> is an ARIMA(1,1,0):
<span class="math display">\[
(1-\phi B)(1-B)X_t=Z_t, ~ Z_t\sim \mathrm{WN}(0,\sigma^2)
\]</span>
One can solve this as
<span class="math display">\[
X_t=X_0+\sum_{j=1}^{t}Y_j, \mathrm{~with}
\]</span>
<span class="math display">\[
Y_t=(1-B)X_t=\sum_{j=0}^{\infty}\phi^jZ_{t-j}.
\]</span></p>
<p><strong>Example 2:</strong> Suppose <span class="math inline">\(\{X_t\}\)</span> is an ARIMA(0,1,1):
<span class="math display">\[
X_t=X_{t-1}+W_t-\theta_1W_{t-1}
\]</span>
If <span class="math inline">\(|\theta_1|&lt;1\)</span>, we can show
<span class="math display">\[
X_t=\sum_{j=1}^{\infty}(1-\theta_1)\theta_1^jX_{t-j}+W_t, \mathrm{~and~so}
\]</span></p>
<p><span class="math display">\[\begin{eqnarray*}
\tilde{X}_{n+1}&amp;=&amp;\sum_{j=1}^{\infty}(1-\theta_1)\theta_1^jX_{n+1-j}\\
&amp;=&amp; (1-\theta_1)X_n+\sum_{j=2}^{\infty}(1-\theta_1)\theta_1^jX_{n+1-j}\\
&amp;=&amp; (1-\theta_1)X_n+\theta_1\tilde{X}_{n},
\end{eqnarray*}\]</span></p>
<p>which behaves like exponentially weighted moving average.</p>
<p><strong>Building ARIMA models</strong></p>
<p>Step 1. Plot the time series. Look for trends, seasonal components, step changes, outliers.</p>
<p>Step 2. Nonlinearly transform data, if necessary.</p>
<p>Step 3. Identify preliminary values of <span class="math inline">\(d\)</span>, <span class="math inline">\(p\)</span>, and <span class="math inline">\(q\)</span>.</p>
<p>Step 4. Estimate parameters.</p>
<p>Step 5. Use diagnostics to confirm residuals are white noise/iid/normal.</p>
<p>Step 6. Model selection.</p>
<p><strong>Identifying <span class="math inline">\(d, p, q\)</span></strong></p>
<ul>
<li>For identifying preliminary values of <span class="math inline">\(d\)</span>, a time series plot can also help.</li>
<li>Too little differencing: not stationary.</li>
<li>Too much differencing: extra dependence introduced.</li>
<li>For identifying <span class="math inline">\(p, q\)</span>, look at sample ACF, PACF of <span class="math inline">\((1 - B)^dX_t\)</span>:</li>
</ul>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-175">Table 10.1: </span>ACF and PACF for ARMA models
</caption>
<thead>
<tr>
<th style="text-align:left;">
Model
</th>
<th style="text-align:left;">
ACF
</th>
<th style="text-align:left;">
PACF
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
AR(p)
</td>
<td style="text-align:left;">
decays
</td>
<td style="text-align:left;">
zero for h &gt; p
</td>
</tr>
<tr>
<td style="text-align:left;">
MA(q)
</td>
<td style="text-align:left;">
zero for h &gt; q
</td>
<td style="text-align:left;">
decays
</td>
</tr>
<tr>
<td style="text-align:left;">
ARMA(p,q)
</td>
<td style="text-align:left;">
decays
</td>
<td style="text-align:left;">
decays
</td>
</tr>
</tbody>
</table>
</div>
<div id="seasonal-arima-sarima-model" class="section level3" number="10.6.5">
<h3><span class="header-section-number">10.6.5</span> Seasonal ARIMA (SARIMA) model</h3>
<p>A SARIMA model is formed by including additional seasonal terms in the ARIMA models we have seen so far.</p>
<p>If <span class="math inline">\(d\)</span> and <span class="math inline">\(D\)</span> are nonnegative integers, then <span class="math inline">\(\{X_t\}\)</span> is a seasonal ARIMA<span class="math inline">\((p, d, q)\times (P, D, Q)_s\)</span> process with period <span class="math inline">\(s\)</span> if the differenced series
<span class="math display">\[
Y_t =(1-B)^d(1-B^s)^DX_t
\]</span>
is a causal ARMA process defined by
<span class="math display">\[
\phi(B)\Phi(B^s)Y_t=\theta(B)\Theta(B^s)Z_t, ~~Z_t\sim WN(0,\sigma^2),
\]</span>
where
<span class="math display">\[\begin{eqnarray*}
\phi(z) &amp;=&amp; 1 -\phi_1 z -\phi_2 z^2 - \cdots -\phi_p z^p, \\
\Phi(z) &amp;=&amp; 1 -\Phi_1 z -\Phi_2 z^2 - \cdots -\Phi_p z^P, \\
\theta(z) &amp;=&amp; 1 + \theta_1 z +\theta_2 z^2 + \cdots +\theta_q z^q,\\
\Theta(z) &amp;=&amp; 1 + \Theta_1 z +\Theta_2 z^2 + \cdots +\Theta_q z^Q.
\end{eqnarray*}\]</span></p>
<p><strong>Pure seasonal ARMA Models</strong></p>
<p>For <span class="math inline">\(P,Q \geq 0\)</span> and <span class="math inline">\(s &gt; 0\)</span>, we say that a time series <span class="math inline">\(\{X_t\}\)</span> is an
ARMA(P,Q)<span class="math inline">\(_s\)</span> process if <span class="math inline">\(\Phi(B^s)X_t = \Theta(B^s)Z_t\)</span>, where
<span class="math display">\[
\Phi(B^s) = 1 - \sum_{j=1}^{P}\Phi_jB^{js},
\]</span>
<span class="math display">\[
\Theta(B^s) = 1+ \sum_{j=1}^{Q}\Theta_jB^{js},
\]</span></p>
<p>Example: <span class="math inline">\(P=0\)</span>, <span class="math inline">\(Q=1\)</span>, <span class="math inline">\(s=12\)</span>. <span class="math inline">\(X_t=Z_t+\Theta_1Z_{t-12}\)</span>.</p>
<p><span class="math display">\[\begin{align*}
\gamma(0) &amp;= (1+\Theta_1^2)\sigma^2,\\
\gamma(12)&amp;= \Theta_1 \sigma^2,\\
\gamma(h) &amp;= 0, \mathrm{~for~} h = 1, 2,\ldots, 11, 13, 14, \ldots.
\end{align*}\]</span></p>
<p>Example: <span class="math inline">\(P=1\)</span>, <span class="math inline">\(Q=0\)</span>, <span class="math inline">\(s=12\)</span>. <span class="math inline">\(X_t=\Phi_1X_{t-12}+Z_{t}\)</span>.</p>
<p><span class="math display">\[\begin{align*}
\gamma(0) &amp;= \frac{\sigma^2}{1-\Phi_1^2},\\
\gamma(12i)&amp;= \frac{\sigma^2\Phi_1^i}{1-\Phi_1^2},\\
\gamma(h) &amp;= 0, \mathrm{~for~other~} h.
\end{align*}\]</span></p>
<p>The ACF and PACF for a seasonal ARMA<span class="math inline">\((P,Q)\)</span>s are zero for <span class="math inline">\(h \neq si\)</span>. For <span class="math inline">\(h = si\)</span>, they are analogous to the patterns for ARMA<span class="math inline">\((p,q)\)</span>:</p>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-176">Table 10.2: </span>My caption
</caption>
<thead>
<tr>
<th style="text-align:left;">
Model
</th>
<th style="text-align:left;">
ACF
</th>
<th style="text-align:left;">
PACF
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
AR(P)s
</td>
<td style="text-align:left;">
decays
</td>
<td style="text-align:left;">
zero for i &gt; P
</td>
</tr>
<tr>
<td style="text-align:left;">
MA(Q)s
</td>
<td style="text-align:left;">
zero for i &gt; Q
</td>
<td style="text-align:left;">
decays
</td>
</tr>
<tr>
<td style="text-align:left;">
ARMA(P,Q)s
</td>
<td style="text-align:left;">
decays
</td>
<td style="text-align:left;">
decays
</td>
</tr>
</tbody>
</table>
<p>We can estimate an ARIMA model using the <code>ARIMA</code> function, which searches through the model space specified in the specials to identify the best ARIMA model which has lowest AIC, AICc or BIC value. We can specify an ARIMA model via the <code>formula</code> argument.</p>
<ul>
<li><p>If the right hand side of the formula is left blank, the default search space is given by <code>pdq() + PDQ()</code>: that is, a model with candidate seasonal and nonseasonal terms, but no exogenous regressors.</p></li>
<li><p>To specify a model fully (avoid automatic selection), the intercept and <code>pdq()</code>, <code>PDQ()</code> values must be specified: for example,</p></li>
</ul>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="timeseries.html#cb287-1" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">=</span> response <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">pdq</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">PDQ</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span></code></pre></div>
<p>In the above, the <code>pdq</code> special is used to specify non-seasonal components of the model, and the <code>PDQ</code> special is used to specify seasonal components of the model. To force a nonseasonal fit, specify <code>PDQ(0, 0, 0)</code> in the right hand side of the model formula. The <code>period</code> argument is used in <code>PDQ</code> to specify the periodic nature of the seasonality.</p>
</div>
<div id="building-sarima-models" class="section level3" number="10.6.6">
<h3><span class="header-section-number">10.6.6</span> Building SARIMA Models</h3>
<p>The seasonal part of an AR or MA model can be seen in the seasonal lags of the PACF and ACF. For <code>Florida.ts</code>, after a lag 7 differencing, Figure <a href="timeseries.html#fig:acfpacf">10.9</a> shows the sample ACF and PACF plots. From Figure <a href="timeseries.html#fig:acfpacf">10.9</a>, we observe a spike at lag 7 in the ACF anda spike at lag 7 at the PACF but no other significant spikes. Therefore, we can specify <code>PDQ(1, 1, 1)</code> in the RHS of the model formula as below.</p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="timeseries.html#cb288-1" aria-hidden="true" tabindex="-1"></a>sarima111 <span class="ot">&lt;-</span> Florida.ts <span class="sc">%&gt;%</span></span>
<span id="cb288-2"><a href="timeseries.html#cb288-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ARIMA</span>(Y.Death <span class="sc">~</span> <span class="fu">PDQ</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)))</span></code></pre></div>
<p>We can use the function <code>report()</code> to obtain the formatted model-specific display.</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="timeseries.html#cb289-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">report</span>(sarima111)</span></code></pre></div>
<pre><code>## Series: Y.Death 
## Model: ARIMA(1,0,2)(1,1,1)[7] 
## 
## Coefficients:
##          ar1      ma1      ma2    sar1     sma1
##       0.9733  -0.7395  -0.0746  0.2611  -0.8071
## s.e.  0.0166   0.0631   0.0598  0.1197   0.0946
## 
## sigma^2 estimated as 873.1:  log likelihood=-1522.67
## AIC=3057.33   AICc=3057.6   BIC=3079.89</code></pre>
<p>Thus, the fitted SARIMA<span class="math inline">\((1,0,2)(1,1,1)_7\)</span> can be written as
<span class="math display">\[
(1-\phi_1B)(1-\Phi_1B^7)(1-B^7)X_t=(1+\theta_1B+\theta_2B^2)(1+\Theta_1B^7)Z_t,
\]</span>
where <span class="math inline">\(Z_t\sim WN(0,873.1)\)</span>, and <span class="math inline">\(\phi_1=0.9733\)</span>, <span class="math inline">\(\theta_1=-0.7395\)</span>, <span class="math inline">\(\theta_2=-0.0746\)</span>, <span class="math inline">\(\Phi_1=0.2611\)</span>, <span class="math inline">\(\Theta_1=-0.8071\)</span>.</p>
<p>Below, we try to fit more SARIMA models for <code>Florida.ts</code>, and conduct the two weeks ahead forecast.</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="timeseries.html#cb291-1" aria-hidden="true" tabindex="-1"></a>death_sarima <span class="ot">&lt;-</span> Florida.ts <span class="sc">%&gt;%</span></span>
<span id="cb291-2"><a href="timeseries.html#cb291-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(</span>
<span id="cb291-3"><a href="timeseries.html#cb291-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">sarima011 =</span> <span class="fu">ARIMA</span>(Y.Death <span class="sc">~</span> <span class="fu">PDQ</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>)),</span>
<span id="cb291-4"><a href="timeseries.html#cb291-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">sarima111 =</span> <span class="fu">ARIMA</span>(Y.Death <span class="sc">~</span> <span class="fu">PDQ</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)),</span>
<span id="cb291-5"><a href="timeseries.html#cb291-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">stepwise =</span> <span class="fu">ARIMA</span>(Y.Death),</span>
<span id="cb291-6"><a href="timeseries.html#cb291-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">search =</span> <span class="fu">ARIMA</span>(Y.Death, <span class="at">stepwise=</span><span class="cn">FALSE</span>)</span>
<span id="cb291-7"><a href="timeseries.html#cb291-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb291-8"><a href="timeseries.html#cb291-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate forecasts for the next 2 weeks</span></span>
<span id="cb291-9"><a href="timeseries.html#cb291-9" aria-hidden="true" tabindex="-1"></a>death_fc <span class="ot">&lt;-</span> death_sarima <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">14</span>)</span>
<span id="cb291-10"><a href="timeseries.html#cb291-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot forecasts against actual values</span></span>
<span id="cb291-11"><a href="timeseries.html#cb291-11" aria-hidden="true" tabindex="-1"></a>death_fc <span class="sc">%&gt;%</span></span>
<span id="cb291-12"><a href="timeseries.html#cb291-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(Florida.ts, <span class="at">level =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb291-13"><a href="timeseries.html#cb291-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Death count&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Different ARIMA Forecasts&quot;</span>) <span class="sc">+</span></span>
<span id="cb291-14"><a href="timeseries.html#cb291-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">&quot;Methods&quot;</span>)) <span class="sc">+</span></span>
<span id="cb291-15"><a href="timeseries.html#cb291-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:predarima"></span>
<img src="SLID_book_files/figure-html/predarima-1.png" alt="Two weeks ahead forecast of the daily death count for Florida using different ARIMA models." width="672" />
<p class="caption">
Figure 10.28: Two weeks ahead forecast of the daily death count for Florida using different ARIMA models.
</p>
</div>
<p>The <code>glance()</code> function provides a one-row summary of each model, and commonly includes descriptions of the model’s fit, such as the residual variance and information criteria. It is worth noticing that the information criteria (AIC, AICc, BIC) are only comparable between the same model class and only if those models share the same response (after transformations and differencing).</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="timeseries.html#cb292-1" aria-hidden="true" tabindex="-1"></a>death_sarima <span class="sc">%&gt;%</span></span>
<span id="cb292-2"><a href="timeseries.html#cb292-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glance</span>() <span class="sc">%&gt;%</span></span>
<span id="cb292-3"><a href="timeseries.html#cb292-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(AICc)</span></code></pre></div>
<pre><code>## # A tibble: 4 x 9
##   State .model sigma2 log_lik   AIC  AICc   BIC ar_roots
##   &lt;fct&gt; &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;list&gt;  
## 1 Flor… search   841.  -1517. 3047. 3048. 3074. &lt;cpl [3…
## 2 Flor… sarim…   873.  -1523. 3057. 3058. 3080. &lt;cpl [8…
## 3 Flor… sarim…   884.  -1525. 3058. 3058. 3073. &lt;cpl [1…
## 4 Flor… stepw…   884.  -1525. 3058. 3058. 3073. &lt;cpl [1…
## # … with 1 more variable: ma_roots &lt;list&gt;</code></pre>
</div>
</div>
<div id="model-comparison" class="section level2" number="10.7">
<h2><span class="header-section-number">10.7</span> Model Comparison</h2>
<div id="exponential-smoothing-and-arima-models" class="section level3" number="10.7.1">
<h3><span class="header-section-number">10.7.1</span> Exponential smoothing and ARIMA models</h3>
<p>Exponential smoothing and ARIMA models are the two most widely used approaches to time series forecasting, and provide complementary approaches to the problem. While exponential smoothing models are based on a description of the trend and seasonality in the data, ARIMA models aim to describe the autocorrelations in the data. As discussed in <span class="citation"><a href="appendix-b.html#ref-Hyndman2018" role="doc-biblioref">Hyndman and Athanasopoulos</a> (<a href="appendix-b.html#ref-Hyndman2018" role="doc-biblioref">2018b</a>)</span>, the ETS model describes how unobserved components of the data (error, trend, and seasonality) change over time, while ARIMA focuses on the autocorrelations in the data. Furthermore, the additive ETS models are all special cases of ARIMA models, while the non-additive ETS models do not have any equivalent ARIMA counterparts. On the other hand, many ARIMA models have no exponential smoothing counterparts. Thirdly, all ETS models are non-stationary, but some ARIMA models are stationary.</p>
<p>Note that we can not use AIC or AICc to compare ETS and ARIMA because they are in different model classes, and the likelihood is computed in different ways. Instead, we can use the validation comparison by dividing the data into two parts: a training set (JAN 23 to NOV 27) and a validation set or test set (NOV 28 to DEC 11). To compare how well the models fit the data, we can consider some common accuracy measures.</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="timeseries.html#cb294-1" aria-hidden="true" tabindex="-1"></a>death_fit <span class="ot">&lt;-</span>  train <span class="sc">%&gt;%</span></span>
<span id="cb294-2"><a href="timeseries.html#cb294-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(</span>
<span id="cb294-3"><a href="timeseries.html#cb294-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">ETS</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ETS</span>(Y.Death </span>
<span id="cb294-4"><a href="timeseries.html#cb294-4" aria-hidden="true" tabindex="-1"></a>                <span class="sc">~</span> <span class="fu">error</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">&quot;A&quot;</span>)),  </span>
<span id="cb294-5"><a href="timeseries.html#cb294-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">ARIMA</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ARIMA</span>(Y.Death, <span class="at">stepwise=</span><span class="cn">FALSE</span>)</span>
<span id="cb294-6"><a href="timeseries.html#cb294-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb294-7"><a href="timeseries.html#cb294-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-8"><a href="timeseries.html#cb294-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Model fitting results of ARIMA</span></span>
<span id="cb294-9"><a href="timeseries.html#cb294-9" aria-hidden="true" tabindex="-1"></a>death_fit <span class="sc">%&gt;%</span></span>
<span id="cb294-10"><a href="timeseries.html#cb294-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(ARIMA) <span class="sc">%&gt;%</span></span>
<span id="cb294-11"><a href="timeseries.html#cb294-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">report</span>()</span></code></pre></div>
<pre><code>## Series: Y.Death 
## Model: ARIMA(3,0,2)(0,1,1)[7] 
## 
## Coefficients:
##          ar1      ar2     ar3      ma1     ma2     sma1
##       2.0725  -1.3305  0.2443  -1.8798  0.9449  -0.6705
## s.e.  0.0671   0.1278  0.0657   0.0341  0.0377   0.0648
## 
## sigma^2 estimated as 858.6:  log likelihood=-1452.72
## AIC=2919.44   AICc=2919.82   BIC=2945.43</code></pre>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="timeseries.html#cb296-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the modeling and forecasting accuracy</span></span>
<span id="cb296-2"><a href="timeseries.html#cb296-2" aria-hidden="true" tabindex="-1"></a>death_fit <span class="sc">%&gt;%</span> </span>
<span id="cb296-3"><a href="timeseries.html#cb296-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>() <span class="sc">%&gt;%</span></span>
<span id="cb296-4"><a href="timeseries.html#cb296-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(MASE)</span></code></pre></div>
<pre><code>## # A tibble: 2 x 11
##   State   .model .type      ME  RMSE   MAE   MPE  MAPE  MASE
##   &lt;fct&gt;   &lt;chr&gt;  &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 Florida ARIMA  Traini… 1.00   28.7  17.7   NaN   Inf 0.813
## 2 Florida ETS    Traini… 0.138  29.9  18.2   NaN   Inf 0.835
## # … with 2 more variables: RMSSE &lt;dbl&gt;, ACF1 &lt;dbl&gt;</code></pre>
<p>It seems that the ARIMA model slightly out-performs the ETS for the series based on the MASE of the training set.</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="timeseries.html#cb298-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate forecasts for the next 2 weeks</span></span>
<span id="cb298-2"><a href="timeseries.html#cb298-2" aria-hidden="true" tabindex="-1"></a>death_fc <span class="ot">&lt;-</span> death_fit <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">14</span>)</span>
<span id="cb298-3"><a href="timeseries.html#cb298-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-4"><a href="timeseries.html#cb298-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot forecasts against actual values</span></span>
<span id="cb298-5"><a href="timeseries.html#cb298-5" aria-hidden="true" tabindex="-1"></a>death_fc <span class="sc">%&gt;%</span></span>
<span id="cb298-6"><a href="timeseries.html#cb298-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(train, <span class="at">level =</span> <span class="dv">95</span>) <span class="sc">+</span></span>
<span id="cb298-7"><a href="timeseries.html#cb298-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">filter_index</span>(</span>
<span id="cb298-8"><a href="timeseries.html#cb298-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(Florida.ts, Y.Death), </span>
<span id="cb298-9"><a href="timeseries.html#cb298-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;2020-11-28&quot;</span> <span class="sc">~</span> .), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb298-10"><a href="timeseries.html#cb298-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Death count&quot;</span>, </span>
<span id="cb298-11"><a href="timeseries.html#cb298-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;ETS vs ARIMA Forecasts&quot;</span>) <span class="sc">+</span></span>
<span id="cb298-12"><a href="timeseries.html#cb298-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">&quot;Forecasts&quot;</span>)) <span class="sc">+</span></span>
<span id="cb298-13"><a href="timeseries.html#cb298-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:predetsarima"></span>
<img src="SLID_book_files/figure-html/predetsarima-1.png" alt="Two weeks ahead forecast of the daily death count for Florida using ETS and ARIMA models." width="672" />
<p class="caption">
Figure 10.29: Two weeks ahead forecast of the daily death count for Florida using ETS and ARIMA models.
</p>
</div>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="timeseries.html#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the forecasting accuracy based on test set</span></span>
<span id="cb299-2"><a href="timeseries.html#cb299-2" aria-hidden="true" tabindex="-1"></a>death_fc <span class="sc">%&gt;%</span> </span>
<span id="cb299-3"><a href="timeseries.html#cb299-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>(Florida.ts) <span class="sc">%&gt;%</span></span>
<span id="cb299-4"><a href="timeseries.html#cb299-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(MASE)</span></code></pre></div>
<pre><code>## # A tibble: 2 x 11
##   .model State   .type    ME  RMSE   MAE   MPE  MAPE  MASE
##   &lt;chr&gt;  &lt;fct&gt;   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 ETS    Florida Test   15.1  24.0  18.4  13.8  17.9 0.847
## 2 ARIMA  Florida Test   26.5  32.8  26.8  25.7  26.1 1.23 
## # … with 2 more variables: RMSSE &lt;dbl&gt;, ACF1 &lt;dbl&gt;</code></pre>
<p>Based on the MASE of the test set and Figure <a href="timeseries.html#fig:predetsarima">10.29</a>, it seems that the ETS model slightly out-performs the ARIMA.</p>
</div>
<div id="cross-validation-for-time-series-analysis" class="section level3" number="10.7.2">
<h3><span class="header-section-number">10.7.2</span> Cross-validation for Time series analysis</h3>
<p>As described in the previous sections, we can use the validation approach for model comparison. If any parameters need to be tuned, we split the training set into a training subset and a validation set. The model is trained on the training subset and the parameters that minimize error on the validation set are chosen. Finally, the model is trained on the full training set using the chosen parameters, and the error on the test set is recorded.</p>
<div class="figure" style="text-align: center"><span id="fig:valid"></span>
<img src="figures/validation.png" alt="An illustration of traditional time series validation." width="75%" />
<p class="caption">
Figure 10.30: An illustration of traditional time series validation.
</p>
</div>
<p>However, you may notice that the choice of the test set in Figure <a href="timeseries.html#fig:kfoldCV">10.31</a> is fairly arbitrary, and that choice may mean that our test set error is a poor estimate of error on an independent test set.</p>
<p>Cross-validation (CV) is a popular technique for tuning hyperparameters and producing robust measurements of model performance. Two of the most common types of cross-validation are leave-one out cross-validation and <span class="math inline">\(k\)</span>-fold cross-validation.</p>
<p>Figure <a href="timeseries.html#fig:kfoldCV">10.31</a> illustrates the idea of <span class="math inline">\(k\)</span>-fold cross-validation. First, we split randomly data into <span class="math inline">\(k\)</span> folds, a subset called the training set, and another subset called the test set based on one fold. Focus on train set, which contains <span class="math inline">\(k-1\)</span> folds, to train the model and test on the <span class="math inline">\(k\)</span>th fold. Repeat the above <span class="math inline">\(k\)</span> times to get <span class="math inline">\(k\)</span> accuracy measures on 10 different and separate folds. Compute the average of the <span class="math inline">\(k\)</span> accuracies which is the final reliable number telling us how the model is performing.</p>
<div class="figure" style="text-align: center"><span id="fig:kfoldCV"></span>
<img src="figures/kfold-CV.png" alt="An illustration of k-fold cross-validation." width="75%" />
<p class="caption">
Figure 10.31: An illustration of k-fold cross-validation.
</p>
</div>
<p>When dealing with time series data, traditional cross-validation (like <span class="math inline">\(k\)</span>-fold) should not be used because of the temporal dependencies.</p>
<p>In the case of time series, the cross-validation is not trivial. We cannot choose random samples and assign them to either the test set or the train set because it makes no sense to use the values from the future to forecast values in the past. In order to accurately simulate the “real world forecasting environment, in which we stand in the present and forecast the future” <span class="citation">(<a href="appendix-b.html#ref-tashman2000out" role="doc-biblioref">Tashman 2000</a>)</span>, the forecaster must withhold all data about events that occur chronologically after the events used for fitting the model.</p>
<p>So, rather than use <span class="math inline">\(k\)</span>-fold cross-validation, for time series data we utilize hold-out cross-validation where a subset of the data (split temporally) is reserved for validating the model performance. For example, see Figure <a href="timeseries.html#fig:stretchCV">10.32</a> where the test set data comes chronologically after the training set. Similarly, the validation set comes chronologically after the training subset. The inner loop works exactly as discussed before: the training set is split into a training subset and a validation set, the model is trained on the training subset, and the parameters that minimize error on the validation set are chosen. However, in the outer loop which splits the dataset into multiple different training and test sets chronologically, and the forecast accuracy is computed by averaging over the test sets.</p>
<div class="figure" style="text-align: center"><span id="fig:stretchCV"></span>
<img src="figures/stretchcv.png" alt="An illustration of strech rolling cross-validation for time series." width="75%" />
<p class="caption">
Figure 10.32: An illustration of strech rolling cross-validation for time series.
</p>
</div>
<p>There are three main rolling types which can be used.</p>
<ul>
<li>Stretch: extends a growing length window with new data; see Figure <a href="timeseries.html#fig:stretchCV">10.32</a>.</li>
<li>Slide: shifts a fixed length window through the data; see Figure <a href="timeseries.html#fig:slideCV">10.33</a>.</li>
<li>Tile: moves a fixed length window without overlap; see Figure <a href="timeseries.html#fig:tileCV">10.34</a>.</li>
</ul>
<p>and we can apply the following functions to roll a “tsibble”:</p>
<ul>
<li><code>stretch_tsibble()</code></li>
<li><code>slide_tsibble()</code></li>
<li><code>tile_tsibble()</code></li>
</ul>
<div class="figure" style="text-align: center"><span id="fig:slideCV"></span>
<img src="figures/slidecv.png" alt="An illustration of slide rolling cross-validation for time series." width="75%" />
<p class="caption">
Figure 10.33: An illustration of slide rolling cross-validation for time series.
</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:tileCV"></span>
<img src="figures/slidecv.png" alt="An illustration of tile rolling cross-validation for time series." width="75%" />
<p class="caption">
Figure 10.34: An illustration of tile rolling cross-validation for time series.
</p>
</div>
<p>These functions provide fast and shorthand for rolling over a tsibble by observations. They all return a tsibble including a new column <code>.id</code> as part of the key. The output dimension will increase considerably with <code>slide_tsibble()</code> and <code>stretch_tsibble()</code>, which is likely to run out of memory when the data is large.</p>
<p>For time series cross-validation, stretching windows are most commonly used.</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="timeseries.html#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Split training and test using stretching window</span></span>
<span id="cb301-2"><a href="timeseries.html#cb301-2" aria-hidden="true" tabindex="-1"></a>Florida.train <span class="ot">&lt;-</span> Florida.ts <span class="sc">%&gt;%</span></span>
<span id="cb301-3"><a href="timeseries.html#cb301-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter_index</span>(<span class="st">&quot;2020-04-01&quot;</span> <span class="sc">~</span> <span class="st">&quot;2020-11-27&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb301-4"><a href="timeseries.html#cb301-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Stretch with a minimum length of 60</span></span>
<span id="cb301-5"><a href="timeseries.html#cb301-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># growing by 7 each step  </span></span>
<span id="cb301-6"><a href="timeseries.html#cb301-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stretch_tsibble</span>(<span class="at">.init =</span> <span class="dv">60</span>, <span class="at">.step =</span> <span class="dv">7</span>) <span class="sc">%&gt;%</span></span>
<span id="cb301-7"><a href="timeseries.html#cb301-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(DATE, State, .id)</span>
<span id="cb301-8"><a href="timeseries.html#cb301-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-9"><a href="timeseries.html#cb301-9" aria-hidden="true" tabindex="-1"></a>Florida.train</span></code></pre></div>
<pre><code>## # A tsibble: 3,835 x 7 [1D]
## # Key:       State, .id [26]
## # Groups:    State [1]
##    DATE       State    .id Infected Death Y.Infected Y.Death
##    &lt;date&gt;     &lt;fct&gt;  &lt;int&gt;    &lt;dbl&gt; &lt;int&gt;      &lt;dbl&gt;   &lt;int&gt;
##  1 2020-04-01 Flori…     1     6.95    85      0.214       0
##  2 2020-04-02 Flori…     1     9.00   144      2.05       59
##  3 2020-04-03 Flori…     1    10.3    163      1.26       19
##  4 2020-04-04 Flori…     1    11.5    194      1.28       31
##  5 2020-04-05 Flori…     1    12.3    221      0.81       27
##  6 2020-04-06 Flori…     1    13.3    235      0.971      14
##  7 2020-04-07 Flori…     1    14.5    254      1.23       19
##  8 2020-04-08 Flori…     1    15.5    309      0.908      55
##  9 2020-04-09 Flori…     1    16.4    353      0.911      44
## 10 2020-04-10 Flori…     1    17.5    390      1.17       37
## # … with 3,825 more rows</code></pre>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="timeseries.html#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Training set model fit</span></span>
<span id="cb303-2"><a href="timeseries.html#cb303-2" aria-hidden="true" tabindex="-1"></a>FL.fit <span class="ot">&lt;-</span> Florida.train <span class="sc">%&gt;%</span></span>
<span id="cb303-3"><a href="timeseries.html#cb303-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(</span>
<span id="cb303-4"><a href="timeseries.html#cb303-4" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">ETS</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ETS</span>(Y.Death </span>
<span id="cb303-5"><a href="timeseries.html#cb303-5" aria-hidden="true" tabindex="-1"></a>                  <span class="sc">~</span> <span class="fu">error</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">&quot;A&quot;</span>)),  </span>
<span id="cb303-6"><a href="timeseries.html#cb303-6" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">ARIMA</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ARIMA</span>(Y.Death <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">pdq</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span> <span class="fu">PDQ</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb303-7"><a href="timeseries.html#cb303-7" aria-hidden="true" tabindex="-1"></a>    )  </span>
<span id="cb303-8"><a href="timeseries.html#cb303-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb303-9"><a href="timeseries.html#cb303-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Training set accuracy</span></span>
<span id="cb303-10"><a href="timeseries.html#cb303-10" aria-hidden="true" tabindex="-1"></a>FL.fit <span class="sc">%&gt;%</span> <span class="fu">accuracy</span>()</span></code></pre></div>
<pre><code>## # A tibble: 52 x 12
##    State    .id .model .type      ME  RMSE   MAE   MPE  MAPE
##    &lt;fct&gt;  &lt;int&gt; &lt;chr&gt;  &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 Flori…     1 ETS    Train… -2.25   15.7  12.4  -Inf   Inf
##  2 Flori…     1 ARIMA  Train…  0.984  17.5  13.1  -Inf   Inf
##  3 Flori…     2 ETS    Train… -1.55   15.8  12.2  -Inf   Inf
##  4 Flori…     2 ARIMA  Train…  1.28   16.9  12.8  -Inf   Inf
##  5 Flori…     3 ETS    Train… -1.16   15.5  11.9  -Inf   Inf
##  6 Flori…     3 ARIMA  Train…  1.33   16.2  12.4  -Inf   Inf
##  7 Flori…     4 ETS    Train… -1.33   14.9  11.4  -Inf   Inf
##  8 Flori…     4 ARIMA  Train…  1.14   16.0  12.0   Inf   Inf
##  9 Flori…     5 ETS    Train… -1.26   14.5  10.8  -Inf   Inf
## 10 Flori…     5 ARIMA  Train…  1.19   15.5  11.7   Inf   Inf
## # … with 42 more rows, and 3 more variables: MASE &lt;dbl&gt;,
## #   RMSSE &lt;dbl&gt;, ACF1 &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="timeseries.html#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 7-day forecast accuracy</span></span>
<span id="cb305-2"><a href="timeseries.html#cb305-2" aria-hidden="true" tabindex="-1"></a>period.fc <span class="ot">&lt;-</span> <span class="dv">7</span></span>
<span id="cb305-3"><a href="timeseries.html#cb305-3" aria-hidden="true" tabindex="-1"></a>FL.fc <span class="ot">&lt;-</span> FL.fit <span class="sc">%&gt;%</span></span>
<span id="cb305-4"><a href="timeseries.html#cb305-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> period.fc) <span class="sc">%&gt;%</span></span>
<span id="cb305-5"><a href="timeseries.html#cb305-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(.id) <span class="sc">%&gt;%</span></span>
<span id="cb305-6"><a href="timeseries.html#cb305-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">h =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb305-7"><a href="timeseries.html#cb305-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb305-8"><a href="timeseries.html#cb305-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-9"><a href="timeseries.html#cb305-9" aria-hidden="true" tabindex="-1"></a>FL.accuracy <span class="ot">&lt;-</span> FL.fc <span class="sc">%&gt;%</span></span>
<span id="cb305-10"><a href="timeseries.html#cb305-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>(Florida.ts, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;h&quot;</span>, <span class="st">&quot;.model&quot;</span>)) </span>
<span id="cb305-11"><a href="timeseries.html#cb305-11" aria-hidden="true" tabindex="-1"></a>FL.accuracy<span class="sc">$</span>h <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>period.fc, <span class="dv">2</span>)</span></code></pre></div>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="timeseries.html#cb306-1" aria-hidden="true" tabindex="-1"></a>FL.accuracy <span class="sc">%&gt;%</span></span>
<span id="cb306-2"><a href="timeseries.html#cb306-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> h, <span class="at">y =</span> RMSE)) <span class="sc">+</span></span>
<span id="cb306-3"><a href="timeseries.html#cb306-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> .model)) <span class="sc">+</span></span>
<span id="cb306-4"><a href="timeseries.html#cb306-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> .model))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:cvetsarima"></span>
<img src="SLID_book_files/figure-html/cvetsarima-1.png" alt="Two weeks ahead forecast of the daily death count for Florida using ETS and ARIMA models." width="672" />
<p class="caption">
Figure 10.35: Two weeks ahead forecast of the daily death count for Florida using ETS and ARIMA models.
</p>
</div>
</div>
</div>
<div id="ensuring-forecasts-stay-within-limits" class="section level2" number="10.8">
<h2><span class="header-section-number">10.8</span> Ensuring Forecasts Stay Within Limits</h2>
<p>In epidemic forecasting, it is common to set forecasts to be positive, especially when forecasting count time series, or to require them to be within some specified range <span class="math inline">\([a,b]\)</span>. Both of these situations are relatively easy to handle using transformations.</p>
<div id="positive-forecasts" class="section level3" number="10.8.1">
<h3><span class="header-section-number">10.8.1</span> Positive forecasts</h3>
<p>To impose a positivity constraint, we can simply work on the log scale. The following is an example using ETS models applied to the daily new death count time series for Florida.</p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="timeseries.html#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain the ETS fit with/without log transformation</span></span>
<span id="cb307-2"><a href="timeseries.html#cb307-2" aria-hidden="true" tabindex="-1"></a>ETS.fit <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span> </span>
<span id="cb307-3"><a href="timeseries.html#cb307-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(</span>
<span id="cb307-4"><a href="timeseries.html#cb307-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">ETS</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ETS</span>(Y.Death <span class="sc">~</span> <span class="fu">error</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">&quot;A&quot;</span>)),</span>
<span id="cb307-5"><a href="timeseries.html#cb307-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">logETS</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ETS</span>(<span class="fu">log</span>(Y.Death<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span> <span class="fu">error</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">&quot;A&quot;</span>))</span>
<span id="cb307-6"><a href="timeseries.html#cb307-6" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb307-7"><a href="timeseries.html#cb307-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-8"><a href="timeseries.html#cb307-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate forecasts for the next 2 weeks</span></span>
<span id="cb307-9"><a href="timeseries.html#cb307-9" aria-hidden="true" tabindex="-1"></a>ETS_fc <span class="ot">&lt;-</span> ETS.fit <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">14</span>)</span>
<span id="cb307-10"><a href="timeseries.html#cb307-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb307-11"><a href="timeseries.html#cb307-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot forecasts against actual values</span></span>
<span id="cb307-12"><a href="timeseries.html#cb307-12" aria-hidden="true" tabindex="-1"></a>ETS_fc <span class="sc">%&gt;%</span></span>
<span id="cb307-13"><a href="timeseries.html#cb307-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(train, <span class="at">level =</span> <span class="dv">95</span>) <span class="sc">+</span></span>
<span id="cb307-14"><a href="timeseries.html#cb307-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(</span>
<span id="cb307-15"><a href="timeseries.html#cb307-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter_index</span>(dplyr<span class="sc">::</span><span class="fu">select</span>(Florida.ts, Y.Death), </span>
<span id="cb307-16"><a href="timeseries.html#cb307-16" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;2020-11-28&quot;</span> <span class="sc">~</span> .), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb307-17"><a href="timeseries.html#cb307-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Death count&quot;</span>, </span>
<span id="cb307-18"><a href="timeseries.html#cb307-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;ETS Forecasts with/without log transformation&quot;</span>) <span class="sc">+</span></span>
<span id="cb307-19"><a href="timeseries.html#cb307-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">&quot;Forecasts&quot;</span>)) <span class="sc">+</span></span>
<span id="cb307-20"><a href="timeseries.html#cb307-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:predetslog"></span>
<img src="SLID_book_files/figure-html/predetslog-1.png" alt="Two weeks ahead forecast of the daily death count for Florida using ETS with/without log transformation." width="672" />
<p class="caption">
Figure 10.36: Two weeks ahead forecast of the daily death count for Florida using ETS with/without log transformation.
</p>
</div>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="timeseries.html#cb308-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Residual plot for the ETS without the log transformation</span></span>
<span id="cb308-2"><a href="timeseries.html#cb308-2" aria-hidden="true" tabindex="-1"></a>ETS.fit <span class="sc">%&gt;%</span></span>
<span id="cb308-3"><a href="timeseries.html#cb308-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ETS) <span class="sc">%&gt;%</span> <span class="fu">gg_tsresiduals</span>(<span class="at">lag=</span><span class="dv">36</span>)</span></code></pre></div>
<p><img src="SLID_book_files/figure-html/unnamed-chunk-183-1.png" width="672" /></p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="timeseries.html#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Residual plot for the log transformed EST method</span></span>
<span id="cb309-2"><a href="timeseries.html#cb309-2" aria-hidden="true" tabindex="-1"></a>ETS.fit <span class="sc">%&gt;%</span></span>
<span id="cb309-3"><a href="timeseries.html#cb309-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(logETS) <span class="sc">%&gt;%</span> <span class="fu">gg_tsresiduals</span>(<span class="at">lag=</span><span class="dv">36</span>)</span></code></pre></div>
<p><img src="SLID_book_files/figure-html/unnamed-chunk-183-2.png" width="672" /></p>
</div>
<div id="forecasts-constrained-to-an-interval" class="section level3" number="10.8.2">
<h3><span class="header-section-number">10.8.2</span> Forecasts constrained to an interval</h3>
<p>Sometimes it makes sense to assume that the number of deaths are constrained to lie within <span class="math inline">\([a,b]\)</span>. To handle data constrained to an interval, we can transform the data using a scaled logit transform as follows:<br />
<span class="math display">\[
y=\log\left(\frac{x-a}{b-x}\right),
\]</span>
where <span class="math inline">\(x\)</span> is on the original scale and <span class="math inline">\(y\)</span> is the transformed data. To reverse the transformation, we will use
<span class="math display">\[
x=\frac{(b-a)e^y}{1+e^y}+a.
\]</span>
This is not a built-in transformation, so we will need to first setup the transformation functions.</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="timeseries.html#cb310-1" aria-hidden="true" tabindex="-1"></a>scaled_logit <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> <span class="dv">1</span>){</span>
<span id="cb310-2"><a href="timeseries.html#cb310-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">log</span>((x <span class="sc">-</span> lower) <span class="sc">/</span> (upper <span class="sc">-</span> x))</span>
<span id="cb310-3"><a href="timeseries.html#cb310-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb310-4"><a href="timeseries.html#cb310-4" aria-hidden="true" tabindex="-1"></a>inv_scaled_logit <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> <span class="dv">1</span>){</span>
<span id="cb310-5"><a href="timeseries.html#cb310-5" aria-hidden="true" tabindex="-1"></a>  (upper <span class="sc">-</span> lower) <span class="sc">*</span> <span class="fu">exp</span>(x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(x)) <span class="sc">+</span> lower</span>
<span id="cb310-6"><a href="timeseries.html#cb310-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb310-7"><a href="timeseries.html#cb310-7" aria-hidden="true" tabindex="-1"></a>my_scaled_logit <span class="ot">&lt;-</span> <span class="fu">new_transformation</span>(scaled_logit, </span>
<span id="cb310-8"><a href="timeseries.html#cb310-8" aria-hidden="true" tabindex="-1"></a>                                      inv_scaled_logit)</span></code></pre></div>
<p>Now, we can make the prediction based on the transfromed time series. Let us consider the forecast within <span class="math inline">\([0,300]\)</span>.</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="timeseries.html#cb311-1" aria-hidden="true" tabindex="-1"></a>train <span class="sc">%&gt;%</span></span>
<span id="cb311-2"><a href="timeseries.html#cb311-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ETS</span>(<span class="fu">my_scaled_logit</span>(Y.Death <span class="sc">+</span> <span class="dv">1</span>, <span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> <span class="dv">300</span>) <span class="sc">~</span> </span>
<span id="cb311-3"><a href="timeseries.html#cb311-3" aria-hidden="true" tabindex="-1"></a>              <span class="fu">error</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">&quot;A&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb311-4"><a href="timeseries.html#cb311-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">14</span>) <span class="sc">%&gt;%</span></span>
<span id="cb311-5"><a href="timeseries.html#cb311-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(train, <span class="at">level =</span> <span class="dv">95</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:predetslog2"></span>
<img src="SLID_book_files/figure-html/predetslog2-1.png" alt="Two weeks ahead forecast of the daily death count for Florida using ETS, constrained to be within [0,300]." width="672" />
<p class="caption">
Figure 10.37: Two weeks ahead forecast of the daily death count for Florida using ETS, constrained to be within [0,300].
</p>
</div>
</div>
</div>
<div id="prediction-and-prediction-intervals-for-aggregates" class="section level2" number="10.9">
<h2><span class="header-section-number">10.9</span> Prediction and Prediction Intervals for Aggregates</h2>
<p>We considered the daily new death count in the above sections, but we may want to forecast the cumulative count. If the point forecasts are means, then adding them up will give a reasonable estimate of the cumulative count. However, prediction intervals are more tricky due to the correlations between forecast errors. A general solution is to use simulations. For example, we consider the forecast of the cumulative death count in the next two weeks.</p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="timeseries.html#cb312-1" aria-hidden="true" tabindex="-1"></a>d_ets_fit <span class="ot">&lt;-</span>  train <span class="sc">%&gt;%</span> <span class="fu">model</span>(</span>
<span id="cb312-2"><a href="timeseries.html#cb312-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">ETS</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ETS</span>(Y.Death </span>
<span id="cb312-3"><a href="timeseries.html#cb312-3" aria-hidden="true" tabindex="-1"></a>                <span class="sc">~</span> <span class="fu">error</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">&quot;A&quot;</span>)) </span>
<span id="cb312-4"><a href="timeseries.html#cb312-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb312-5"><a href="timeseries.html#cb312-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb312-6"><a href="timeseries.html#cb312-6" aria-hidden="true" tabindex="-1"></a>d.pred.paths <span class="ot">&lt;-</span> d_ets_fit <span class="sc">%&gt;%</span></span>
<span id="cb312-7"><a href="timeseries.html#cb312-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Simulate 10000 future sample paths, each of length 14</span></span>
<span id="cb312-8"><a href="timeseries.html#cb312-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">times =</span> <span class="dv">10000</span>, <span class="at">h =</span> <span class="dv">14</span>) <span class="sc">%&gt;%</span></span>
<span id="cb312-9"><a href="timeseries.html#cb312-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sum the results for each sample path</span></span>
<span id="cb312-10"><a href="timeseries.html#cb312-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb312-11"><a href="timeseries.html#cb312-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(.rep) <span class="sc">%&gt;%</span></span>
<span id="cb312-12"><a href="timeseries.html#cb312-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.sim =</span> <span class="fu">as.integer</span>(.sim)) <span class="sc">%&gt;%</span></span>
<span id="cb312-13"><a href="timeseries.html#cb312-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.sim =</span> <span class="fu">replace</span>(.sim, <span class="fu">which</span>(.sim <span class="sc">&lt;</span> <span class="dv">0</span>), <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb312-14"><a href="timeseries.html#cb312-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.csum =</span> <span class="fu">cumsum</span>(.sim))</span></code></pre></div>
<p>We can compute the mean of the simulations, and extract a specified prediction interval at a particular level. For example,</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="timeseries.html#cb313-1" aria-hidden="true" tabindex="-1"></a>d.pred.report <span class="ot">&lt;-</span> d.pred.paths <span class="sc">%&gt;%</span> </span>
<span id="cb313-2"><a href="timeseries.html#cb313-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(DATE) <span class="sc">%&gt;%</span></span>
<span id="cb313-3"><a href="timeseries.html#cb313-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">.mean =</span> <span class="fu">mean</span>(.csum),</span>
<span id="cb313-4"><a href="timeseries.html#cb313-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">.lpi95 =</span> <span class="fu">quantile</span>(.csum, .<span class="dv">025</span>), </span>
<span id="cb313-5"><a href="timeseries.html#cb313-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">.upi95 =</span> <span class="fu">quantile</span>(.csum, .<span class="dv">975</span>),</span>
<span id="cb313-6"><a href="timeseries.html#cb313-6" aria-hidden="true" tabindex="-1"></a>            ) <span class="sc">%&gt;%</span></span>
<span id="cb313-7"><a href="timeseries.html#cb313-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.mean =</span> .mean <span class="sc">+</span> <span class="fu">tail</span>(train<span class="sc">$</span>Death,<span class="dv">1</span>),</span>
<span id="cb313-8"><a href="timeseries.html#cb313-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">.lpi95 =</span> .lpi95 <span class="sc">+</span> <span class="fu">tail</span>(train<span class="sc">$</span>Death,<span class="dv">1</span>),</span>
<span id="cb313-9"><a href="timeseries.html#cb313-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">.upi95 =</span> .upi95 <span class="sc">+</span> <span class="fu">tail</span>(train<span class="sc">$</span>Death,<span class="dv">1</span>)</span>
<span id="cb313-10"><a href="timeseries.html#cb313-10" aria-hidden="true" tabindex="-1"></a>         )</span></code></pre></div>
<p>Figure <a href="timeseries.html#fig:predcum">10.38</a> shows the two weeks ahead forecast of the cumulative death count for Florida using ETS.</p>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="timeseries.html#cb314-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(train, <span class="fu">aes</span>(DATE, Death)) <span class="sc">+</span> </span>
<span id="cb314-2"><a href="timeseries.html#cb314-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb314-3"><a href="timeseries.html#cb314-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Days&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Count&quot;</span>, </span>
<span id="cb314-4"><a href="timeseries.html#cb314-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&#39;Cumulative deaths and prediction&#39;</span>) <span class="sc">+</span> </span>
<span id="cb314-5"><a href="timeseries.html#cb314-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add prediction intervals</span></span>
<span id="cb314-6"><a href="timeseries.html#cb314-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> DATE, </span>
<span id="cb314-7"><a href="timeseries.html#cb314-7" aria-hidden="true" tabindex="-1"></a>                            <span class="at">y =</span> .mean, </span>
<span id="cb314-8"><a href="timeseries.html#cb314-8" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ymin =</span> .lpi95, </span>
<span id="cb314-9"><a href="timeseries.html#cb314-9" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ymax =</span> .upi95,</span>
<span id="cb314-10"><a href="timeseries.html#cb314-10" aria-hidden="true" tabindex="-1"></a>                            <span class="at">fill =</span> <span class="st">&#39;95% Prediction intervals&#39;</span>), </span>
<span id="cb314-11"><a href="timeseries.html#cb314-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> d.pred.report, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb314-12"><a href="timeseries.html#cb314-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add line for predicted values</span></span>
<span id="cb314-13"><a href="timeseries.html#cb314-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> DATE, </span>
<span id="cb314-14"><a href="timeseries.html#cb314-14" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y =</span> .mean,</span>
<span id="cb314-15"><a href="timeseries.html#cb314-15" aria-hidden="true" tabindex="-1"></a>                          <span class="at">colour =</span> <span class="st">&#39;Predicted Value&#39;</span>),</span>
<span id="cb314-16"><a href="timeseries.html#cb314-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">data =</span> d.pred.report,</span>
<span id="cb314-17"><a href="timeseries.html#cb314-17" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Set the line type in legend</span></span>
<span id="cb314-18"><a href="timeseries.html#cb314-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">key_glyph =</span> <span class="st">&quot;timeseries&quot;</span>) <span class="sc">+</span> </span>
<span id="cb314-19"><a href="timeseries.html#cb314-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="st">&quot;&quot;</span>, <span class="at">values =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb314-20"><a href="timeseries.html#cb314-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">&quot;&quot;</span>, <span class="at">values =</span> <span class="st">&quot;pink&quot;</span>) <span class="sc">+</span> </span>
<span id="cb314-21"><a href="timeseries.html#cb314-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:predcum"></span>
<img src="SLID_book_files/figure-html/predcum-1.png" alt="Two weeks ahead forecast of the cumulative death count for Florida using ETS." width="672" />
<p class="caption">
Figure 10.38: Two weeks ahead forecast of the cumulative death count for Florida using ETS.
</p>
</div>
</div>
<div id="exercises-5" class="section level2" number="10.10">
<h2><span class="header-section-number">10.10</span> Exercises</h2>
<ol style="list-style-type: decimal">
<li>From <code>state.long</code> in the R package <code>slid</code>, choose a state and convert the data to time series.</li>
</ol>
<ol style="list-style-type: lower-alpha">
<li><p>Construct time series plots for the daily new death, daily new infection, cumulative deaths and cumulative infection.</p></li>
<li><p>For the daily new death series and daily new infection series, use the following graphics functions: <code>autoplot()</code>, <code>gg_season()</code>, <code>gg_subseries()</code>, <code>gg_lag()</code>, <code>ACF()</code> and explore features from the following time series:</p></li>
</ol>
<pre><code>+ Can you spot any seasonality and trend?
+ What do you learn about the series?
+ What can you say about the seasonal patterns?
+ Can you identify any unusual pattern?</code></pre>
<ol start="3" style="list-style-type: lower-alpha">
<li><p>Conduct an STL decomposition for the daily new death series.</p></li>
<li><p>For the daily new death series, create a training dataset consisting of observations from JAN 23 to NOV 27. Calculate 14-day ahead forecasts using <code>SNAIVE()</code> and <code>ETS</code> applied to your training data.</p></li>
<li><p>Compare the accuracy of your forecasts against the actual values.</p></li>
<li><p>Check the residuals. Do the residuals appear to be uncorrelated and normally distributed?</p></li>
</ol>
<ol start="2" style="list-style-type: decimal">
<li>Let <span class="math inline">\(\{Z_t\}\)</span> be a sequence of independent normal random variables, each with
mean 0 and variance <span class="math inline">\(\sigma^2\)</span>, and let <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>, and <span class="math inline">\(c\)</span> be constants. Which, if any, of the following processes are stationary? For each stationary process specify the mean and autocovariance function.</li>
</ol>
<ol style="list-style-type: lower-alpha">
<li><span class="math inline">\(Y_t = a + bZ_t + cZ_{t-2}\)</span></li>
<li><span class="math inline">\(Y_t = Z_1 \cos(ct) + Z_2 \sin(ct)\)</span></li>
<li><span class="math inline">\(Y_t = Z_t \cos(ct) + Z_{t−1} \sin(ct)\)</span></li>
<li><span class="math inline">\(Y_t = a + bZ_0\)</span></li>
<li><span class="math inline">\(Y_t = Z_0 \cos(ct)\)</span></li>
<li><span class="math inline">\(Y_t = Z_tZ_{t−1}\)</span></li>
</ol>
<ol start="3" style="list-style-type: decimal">
<li>Use the <code>tsibble()</code> function to generate a time series of length 200 of the following simple ARIMA models. Produce a time plot for each simulated series, and draw the sample ACF and PACF for the simulated time series.</li>
</ol>
<ol style="list-style-type: lower-alpha">
<li><p>AR(1) model with <span class="math inline">\(\phi_1=0.9\)</span> and <span class="math inline">\(\sigma^2=1\)</span>.</p></li>
<li><p>MA(1) model with <span class="math inline">\(\theta_1=0.8\)</span> and and <span class="math inline">\(\sigma^2=1\)</span>.</p></li>
<li><p>MA(2) model with <span class="math inline">\(\theta_1=0.3\)</span>, <span class="math inline">\(\theta_2=-0.4\)</span> and <span class="math inline">\(\sigma^2=1\)</span>.</p></li>
</ol>
<ol start="4" style="list-style-type: decimal">
<li><p>From <code>state.long</code> in the R package <code>slid</code>, choose a state. Hold out the last seven days as test data and use all the data except the last seven days as your training data. Use the automatic search in <code>ARIMA()</code> to find an ARIMA model for the daily new death count based on your training data. What model was selected? Write the model in terms of the backshift operator.</p></li>
<li><p>For the state you choose in Problem 4, consider a logarithm transformation, then use the automatic search in <code>ARIMA()</code> to find an ARIMA model for the daily new death count based on your training data. Make a 7-day ahead forecast using the selected ARIMA model, and provide a 95% prediction intervals.</p></li>
<li><p>Compare the forecasting performance of the selected ARIMA model in Problem 4 and Problem 5 without and with logarithm transform.</p></li>
<li><p>For the state you choose in Problem 4, and the ARIMA model for the daily new death count with log transformation, aggregate them to make a 7-day ahead forecast for the cumulative death count and provide the corresponding 95% prediction intervals.</p></li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="compartment.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["SLID_book.pdf", "SLID_book.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
