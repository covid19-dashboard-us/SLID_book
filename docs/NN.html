<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 12 Neural Networks | Statistical Learning of Infectious Disease Data Analytics</title>
  <meta name="description" content="The use of statistical models to understand infectious disease dynamics has a very rich history in epidemiology. This book introduces modern statistical models and state-of-the-art learning methods to analyze infectious disease data. Many of the key approaches, examples and case studies will be presented. The primary emphasis will be interpretation, inference and hands-on data analyses. This course also provides practical concepts and R computing skills to perform infectious disease data analysis and visualization." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 12 Neural Networks | Statistical Learning of Infectious Disease Data Analytics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="The use of statistical models to understand infectious disease dynamics has a very rich history in epidemiology. This book introduces modern statistical models and state-of-the-art learning methods to analyze infectious disease data. Many of the key approaches, examples and case studies will be presented. The primary emphasis will be interpretation, inference and hands-on data analyses. This course also provides practical concepts and R computing skills to perform infectious disease data analysis and visualization." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 12 Neural Networks | Statistical Learning of Infectious Disease Data Analytics" />
  
  <meta name="twitter:description" content="The use of statistical models to understand infectious disease dynamics has a very rich history in epidemiology. This book introduces modern statistical models and state-of-the-art learning methods to analyze infectious disease data. Many of the key approaches, examples and case studies will be presented. The primary emphasis will be interpretation, inference and hands-on data analyses. This course also provides practical concepts and R computing skills to perform infectious disease data analysis and visualization." />
  

<meta name="author" content="Lily Wang" />


<meta name="date" content="2021-04-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="regression.html"/>
<link rel="next" href="ensemble.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.3.9000/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#data-sets-used-in-labs-and-exercises"><i class="fa fa-check"></i><b>1.1</b> Data Sets Used in Labs and Exercises</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>1.2</b> Acknowledgements</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#about-the-author"><i class="fa fa-check"></i><b>1.3</b> About the Author</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#aims-and-scope-of-this-book"><i class="fa fa-check"></i><b>2.1</b> Aims and Scope of This Book</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#the-structure-of-this-book"><i class="fa fa-check"></i><b>2.2</b> The Structure of This Book</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="intro.html"><a href="intro.html#infectious-disease-data"><i class="fa fa-check"></i><b>2.2.1</b> Infectious disease data</a></li>
<li class="chapter" data-level="2.2.2" data-path="intro.html"><a href="intro.html#basic-characteristics-of-the-infection-process"><i class="fa fa-check"></i><b>2.2.2</b> Basic characteristics of the infection process</a></li>
<li class="chapter" data-level="2.2.3" data-path="intro.html"><a href="intro.html#data-visualization"><i class="fa fa-check"></i><b>2.2.3</b> Data visualization</a></li>
<li class="chapter" data-level="2.2.4" data-path="intro.html"><a href="intro.html#modeling-and-forecasting"><i class="fa fa-check"></i><b>2.2.4</b> Modeling and Forecasting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="dplyr.html"><a href="dplyr.html"><i class="fa fa-check"></i><b>3</b> Data Wrangling with <code>dplyr</code> and <code>tidyr</code></a>
<ul>
<li class="chapter" data-level="3.1" data-path="dplyr.html"><a href="dplyr.html#learning-dplyr"><i class="fa fa-check"></i><b>3.1</b> Learning <code>dplyr</code></a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="dplyr.html"><a href="dplyr.html#tibbles"><i class="fa fa-check"></i><b>3.1.1</b> Tibbles</a></li>
<li class="chapter" data-level="3.1.2" data-path="dplyr.html"><a href="dplyr.html#import-data"><i class="fa fa-check"></i><b>3.1.2</b> Import data</a></li>
<li class="chapter" data-level="3.1.3" data-path="dplyr.html"><a href="dplyr.html#common-dplyr-functions"><i class="fa fa-check"></i><b>3.1.3</b> Common <code>dplyr</code> functions</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="dplyr.html"><a href="dplyr.html#selecting-columns-and-filtering-rows"><i class="fa fa-check"></i><b>3.2</b> Selecting Columns and Filtering Rows</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="dplyr.html"><a href="dplyr.html#subset-variables-columns"><i class="fa fa-check"></i><b>3.2.1</b> Subset Variables (Columns)</a></li>
<li class="chapter" data-level="3.2.2" data-path="dplyr.html"><a href="dplyr.html#subset-observations-rows"><i class="fa fa-check"></i><b>3.2.2</b> Subset Observations (Rows)</a></li>
<li class="chapter" data-level="3.2.3" data-path="dplyr.html"><a href="dplyr.html#pipes"><i class="fa fa-check"></i><b>3.2.3</b> Pipes</a></li>
<li class="chapter" data-level="3.2.4" data-path="dplyr.html"><a href="dplyr.html#select-and-order-top-n-entries-by-group-if-grouped-data."><i class="fa fa-check"></i><b>3.2.4</b> Select and order top n entries (by group if grouped data).</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="dplyr.html"><a href="dplyr.html#make-new-variables-mutate"><i class="fa fa-check"></i><b>3.3</b> Make New Variables: Mutate</a></li>
<li class="chapter" data-level="3.4" data-path="dplyr.html"><a href="dplyr.html#summarize-data"><i class="fa fa-check"></i><b>3.4</b> Summarize Data</a></li>
<li class="chapter" data-level="3.5" data-path="dplyr.html"><a href="dplyr.html#combine-data-sets"><i class="fa fa-check"></i><b>3.5</b> Combine Data Sets</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="dplyr.html"><a href="dplyr.html#the-join-family"><i class="fa fa-check"></i><b>3.5.1</b> The join family</a></li>
<li class="chapter" data-level="3.5.2" data-path="dplyr.html"><a href="dplyr.html#toy-examples-with-joins"><i class="fa fa-check"></i><b>3.5.2</b> Toy examples with joins</a></li>
<li class="chapter" data-level="3.5.3" data-path="dplyr.html"><a href="dplyr.html#practice-with-joins-for-real-data"><i class="fa fa-check"></i><b>3.5.3</b> Practice with joins for real data</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="dplyr.html"><a href="dplyr.html#reshaping-data"><i class="fa fa-check"></i><b>3.6</b> Reshaping Data</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="dplyr.html"><a href="dplyr.html#from-wide-to-long"><i class="fa fa-check"></i><b>3.6.1</b> From wide to long</a></li>
<li class="chapter" data-level="3.6.2" data-path="dplyr.html"><a href="dplyr.html#from-long-to-wide"><i class="fa fa-check"></i><b>3.6.2</b> From long to wide</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="dplyr.html"><a href="dplyr.html#exercises"><i class="fa fa-check"></i><b>3.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>4</b> Data Visualization with ggplot2</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ggplot2.html"><a href="ggplot2.html#introduction"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="ggplot2.html"><a href="ggplot2.html#types-of-variables-and-preparation"><i class="fa fa-check"></i><b>4.2</b> Types of Variables and Preparation</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="ggplot2.html"><a href="ggplot2.html#types-of-variables"><i class="fa fa-check"></i><b>4.2.1</b> Types of Variables</a></li>
<li class="chapter" data-level="4.2.2" data-path="ggplot2.html"><a href="ggplot2.html#rules-for-graph-designing"><i class="fa fa-check"></i><b>4.2.2</b> Rules for Graph Designing</a></li>
<li class="chapter" data-level="4.2.3" data-path="ggplot2.html"><a href="ggplot2.html#installing-packages-and-loading-data"><i class="fa fa-check"></i><b>4.2.3</b> Installing packages and loading data</a></li>
<li class="chapter" data-level="4.2.4" data-path="ggplot2.html"><a href="ggplot2.html#your-first-scatterplot"><i class="fa fa-check"></i><b>4.2.4</b> Your first scatterplot</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="ggplot2.html"><a href="ggplot2.html#position-scales-and-axes"><i class="fa fa-check"></i><b>4.3</b> Position Scales and Axes</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="ggplot2.html"><a href="ggplot2.html#change-the-labels-of-the-axis-using-xlab-and-ylab"><i class="fa fa-check"></i><b>4.3.1</b> Change the labels of the axis using <code>xlab()</code> and <code>ylab()</code></a></li>
<li class="chapter" data-level="4.3.2" data-path="ggplot2.html"><a href="ggplot2.html#change-the-range-of-the-axis-using-xlim-and-ylim"><i class="fa fa-check"></i><b>4.3.2</b> Change the range of the axis using <code>xlim()</code> and <code>ylim()</code></a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="ggplot2.html"><a href="ggplot2.html#color-scales-and-size-of-geom_points"><i class="fa fa-check"></i><b>4.4</b> Color Scales and Size of <code>geom_points()</code></a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="ggplot2.html"><a href="ggplot2.html#change-the-color-of-all-points"><i class="fa fa-check"></i><b>4.4.1</b> Change the color of all points</a></li>
<li class="chapter" data-level="4.4.2" data-path="ggplot2.html"><a href="ggplot2.html#color-the-observations-by-the-value-of-a-feature"><i class="fa fa-check"></i><b>4.4.2</b> Color the observations by the value of a feature</a></li>
<li class="chapter" data-level="4.4.3" data-path="ggplot2.html"><a href="ggplot2.html#change-the-color-palette"><i class="fa fa-check"></i><b>4.4.3</b> Change the color palette</a></li>
<li class="chapter" data-level="4.4.4" data-path="ggplot2.html"><a href="ggplot2.html#change-the-size-by-the-value-of-a-feature"><i class="fa fa-check"></i><b>4.4.4</b> Change the size by the value of a feature</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="ggplot2.html"><a href="ggplot2.html#individual-geoms"><i class="fa fa-check"></i><b>4.5</b> Individual geoms</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="ggplot2.html"><a href="ggplot2.html#histogram"><i class="fa fa-check"></i><b>4.5.1</b> Histogram</a></li>
<li class="chapter" data-level="4.5.2" data-path="ggplot2.html"><a href="ggplot2.html#bar-chart"><i class="fa fa-check"></i><b>4.5.2</b> Bar chart</a></li>
<li class="chapter" data-level="4.5.3" data-path="ggplot2.html"><a href="ggplot2.html#default-bar-chart"><i class="fa fa-check"></i><b>4.5.3</b> Default bar chart</a></li>
<li class="chapter" data-level="4.5.4" data-path="ggplot2.html"><a href="ggplot2.html#bar-chart-with-assigned-value"><i class="fa fa-check"></i><b>4.5.4</b> Bar chart with assigned value</a></li>
<li class="chapter" data-level="4.5.5" data-path="ggplot2.html"><a href="ggplot2.html#legend"><i class="fa fa-check"></i><b>4.5.5</b> Legend</a></li>
<li class="chapter" data-level="4.5.6" data-path="ggplot2.html"><a href="ggplot2.html#boxplots-jittering-and-violin-plots"><i class="fa fa-check"></i><b>4.5.6</b> Boxplots, jittering and violin plots</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="ggplot2.html"><a href="ggplot2.html#collective-geoms"><i class="fa fa-check"></i><b>4.6</b> Collective geoms</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="ggplot2.html"><a href="ggplot2.html#smoother"><i class="fa fa-check"></i><b>4.6.1</b> Smoother</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="ggplot2.html"><a href="ggplot2.html#time-series"><i class="fa fa-check"></i><b>4.7</b> Time Series</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="ggplot2.html"><a href="ggplot2.html#basic-line-plots"><i class="fa fa-check"></i><b>4.7.1</b> Basic line plots</a></li>
<li class="chapter" data-level="4.7.2" data-path="ggplot2.html"><a href="ggplot2.html#add-a-second-line"><i class="fa fa-check"></i><b>4.7.2</b> Add a second line</a></li>
<li class="chapter" data-level="4.7.3" data-path="ggplot2.html"><a href="ggplot2.html#add-ribbons"><i class="fa fa-check"></i><b>4.7.3</b> Add ribbons</a></li>
<li class="chapter" data-level="4.7.4" data-path="ggplot2.html"><a href="ggplot2.html#adjust-the-scale-of-time-axis"><i class="fa fa-check"></i><b>4.7.4</b> Adjust the scale of time axis</a></li>
<li class="chapter" data-level="4.7.5" data-path="ggplot2.html"><a href="ggplot2.html#add-annotations"><i class="fa fa-check"></i><b>4.7.5</b> Add annotations</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="ggplot2.html"><a href="ggplot2.html#maps"><i class="fa fa-check"></i><b>4.8</b> Maps</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="ggplot2.html"><a href="ggplot2.html#making-a-base-map"><i class="fa fa-check"></i><b>4.8.1</b> Making a base map</a></li>
<li class="chapter" data-level="4.8.2" data-path="ggplot2.html"><a href="ggplot2.html#customizing-choropleth-map"><i class="fa fa-check"></i><b>4.8.2</b> Customizing <code>choropleth</code> map</a></li>
<li class="chapter" data-level="4.8.3" data-path="ggplot2.html"><a href="ggplot2.html#overlay-polygon-maps"><i class="fa fa-check"></i><b>4.8.3</b> Overlay polygon maps</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="ggplot2.html"><a href="ggplot2.html#arranging-plots"><i class="fa fa-check"></i><b>4.9</b> Arranging Plots</a>
<ul>
<li class="chapter" data-level="4.9.1" data-path="ggplot2.html"><a href="ggplot2.html#facet"><i class="fa fa-check"></i><b>4.9.1</b> Facet</a></li>
<li class="chapter" data-level="4.9.2" data-path="ggplot2.html"><a href="ggplot2.html#combining-plots-using-patchwork-package"><i class="fa fa-check"></i><b>4.9.2</b> Combining plots using <code>patchwork</code> package</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="ggplot2.html"><a href="ggplot2.html#output"><i class="fa fa-check"></i><b>4.10</b> Output</a>
<ul>
<li class="chapter" data-level="4.10.1" data-path="ggplot2.html"><a href="ggplot2.html#save-in-figure-format"><i class="fa fa-check"></i><b>4.10.1</b> Save in figure format</a></li>
<li class="chapter" data-level="4.10.2" data-path="ggplot2.html"><a href="ggplot2.html#save-in-rds-format"><i class="fa fa-check"></i><b>4.10.2</b> Save in RDS format</a></li>
</ul></li>
<li class="chapter" data-level="4.11" data-path="ggplot2.html"><a href="ggplot2.html#exercises-1"><i class="fa fa-check"></i><b>4.11</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="plotly.html"><a href="plotly.html"><i class="fa fa-check"></i><b>5</b> Interactive Visualization</a>
<ul>
<li class="chapter" data-level="5.1" data-path="plotly.html"><a href="plotly.html#an-introduction"><i class="fa fa-check"></i><b>5.1</b> An Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="plotly.html"><a href="plotly.html#creating-plotly-objects"><i class="fa fa-check"></i><b>5.2</b> Creating Plotly Objects</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="plotly.html"><a href="plotly.html#using-plot_ly-to-create-a-plotly-object"><i class="fa fa-check"></i><b>5.2.1</b> Using <code>plot_ly()</code> to create a plotly object</a></li>
<li class="chapter" data-level="5.2.2" data-path="plotly.html"><a href="plotly.html#use-dplyr-verbs-to-modify-data"><i class="fa fa-check"></i><b>5.2.2</b> Use <code>dplyr</code> verbs to modify data</a></li>
<li class="chapter" data-level="5.2.3" data-path="plotly.html"><a href="plotly.html#using-ggplotly-to-create-a-plotly-object"><i class="fa fa-check"></i><b>5.2.3</b> Using <code>ggplotly()</code> to create a <code>plotly</code> object</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="plotly.html"><a href="plotly.html#scatterplots-and-line-plots"><i class="fa fa-check"></i><b>5.3</b> Scatterplots and Line Plots</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="plotly.html"><a href="plotly.html#make-a-scatterplot"><i class="fa fa-check"></i><b>5.3.1</b> Make a scatterplot</a></li>
<li class="chapter" data-level="5.3.2" data-path="plotly.html"><a href="plotly.html#markers"><i class="fa fa-check"></i><b>5.3.2</b> Markers</a></li>
<li class="chapter" data-level="5.3.3" data-path="plotly.html"><a href="plotly.html#a-single-time-series-plot"><i class="fa fa-check"></i><b>5.3.3</b> A single time series plot</a></li>
<li class="chapter" data-level="5.3.4" data-path="plotly.html"><a href="plotly.html#hover-text-and-template"><i class="fa fa-check"></i><b>5.3.4</b> Hover text and template</a></li>
<li class="chapter" data-level="5.3.5" data-path="plotly.html"><a href="plotly.html#multiple-time-series-plots"><i class="fa fa-check"></i><b>5.3.5</b> Multiple time series plots</a></li>
<li class="chapter" data-level="5.3.6" data-path="plotly.html"><a href="plotly.html#more-features-about-the-lines"><i class="fa fa-check"></i><b>5.3.6</b> More features about the lines</a></li>
<li class="chapter" data-level="5.3.7" data-path="plotly.html"><a href="plotly.html#add-ribbons-1"><i class="fa fa-check"></i><b>5.3.7</b> Add ribbons</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="plotly.html"><a href="plotly.html#pie-charts"><i class="fa fa-check"></i><b>5.4</b> Pie Charts</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="plotly.html"><a href="plotly.html#draw-static-pie-charts-using-ggplot2"><i class="fa fa-check"></i><b>5.4.1</b> Draw static pie charts using ggplot2</a></li>
<li class="chapter" data-level="5.4.2" data-path="plotly.html"><a href="plotly.html#draw-interactive-pie-charts"><i class="fa fa-check"></i><b>5.4.2</b> Draw interactive pie charts</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="plotly.html"><a href="plotly.html#animation"><i class="fa fa-check"></i><b>5.5</b> Animation</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="plotly.html"><a href="plotly.html#an-animation-of-the-evolution-of-infected-vs.-death-count"><i class="fa fa-check"></i><b>5.5.1</b> An animation of the evolution of infected vs. death count</a></li>
<li class="chapter" data-level="5.5.2" data-path="plotly.html"><a href="plotly.html#an-animation-of-the-state-level-time-series-plot-of-infected-count"><i class="fa fa-check"></i><b>5.5.2</b> An animation of the state-level time series plot of infected count</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="plotly.html"><a href="plotly.html#saving-html"><i class="fa fa-check"></i><b>5.6</b> Saving HTML</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="plotly.html"><a href="plotly.html#save-as-a-standalone-html-file"><i class="fa fa-check"></i><b>5.6.1</b> Save as a standalone HTML file</a></li>
<li class="chapter" data-level="5.6.2" data-path="plotly.html"><a href="plotly.html#save-as-non-selfcontained-html-file"><i class="fa fa-check"></i><b>5.6.2</b> Save as non-selfcontained HTML file</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="plotly.html"><a href="plotly.html#exercises-2"><i class="fa fa-check"></i><b>5.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="shiny.html"><a href="shiny.html"><i class="fa fa-check"></i><b>6</b> R Shiny</a>
<ul>
<li class="chapter" data-level="6.1" data-path="shiny.html"><a href="shiny.html#an-introduction-to-shiny"><i class="fa fa-check"></i><b>6.1</b> An Introduction to Shiny</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="shiny.html"><a href="shiny.html#your-first-shiny-app"><i class="fa fa-check"></i><b>6.1.1</b> Your first shiny app</a></li>
<li class="chapter" data-level="6.1.2" data-path="shiny.html"><a href="shiny.html#create-a-new-shiny-app-in-rstudio"><i class="fa fa-check"></i><b>6.1.2</b> Create a new shiny app in RStudio</a></li>
<li class="chapter" data-level="6.1.3" data-path="shiny.html"><a href="shiny.html#share-your-app"><i class="fa fa-check"></i><b>6.1.3</b> Share your app</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="shiny.html"><a href="shiny.html#useful-input-widgets"><i class="fa fa-check"></i><b>6.2</b> Useful Input Widgets</a></li>
<li class="chapter" data-level="6.3" data-path="shiny.html"><a href="shiny.html#displaying-reactive-output"><i class="fa fa-check"></i><b>6.3</b> Displaying Reactive Output</a></li>
<li class="chapter" data-level="6.4" data-path="shiny.html"><a href="shiny.html#rendering-plotly-inside-shiny"><i class="fa fa-check"></i><b>6.4</b> Rendering Plotly Inside Shiny</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="map.html"><a href="map.html"><i class="fa fa-check"></i><b>7</b> Interactive Geospatial Visualization</a>
<ul>
<li class="chapter" data-level="7.1" data-path="map.html"><a href="map.html#an-introduction-to-leaflet"><i class="fa fa-check"></i><b>7.1</b> An Introduction to Leaflet</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="map.html"><a href="map.html#more-references"><i class="fa fa-check"></i><b>7.1.1</b> More References</a></li>
<li class="chapter" data-level="7.1.2" data-path="map.html"><a href="map.html#features-and-installation"><i class="fa fa-check"></i><b>7.1.2</b> Features and installation</a></li>
<li class="chapter" data-level="7.1.3" data-path="map.html"><a href="map.html#basic-usage"><i class="fa fa-check"></i><b>7.1.3</b> Basic Usage</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="map.html"><a href="map.html#the-data-object"><i class="fa fa-check"></i><b>7.2</b> The Data Object</a></li>
<li class="chapter" data-level="7.3" data-path="map.html"><a href="map.html#choropleth-map"><i class="fa fa-check"></i><b>7.3</b> Choropleth map</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="map.html"><a href="map.html#create-a-base-map"><i class="fa fa-check"></i><b>7.3.1</b> Create a base map</a></li>
<li class="chapter" data-level="7.3.2" data-path="map.html"><a href="map.html#color-the-map"><i class="fa fa-check"></i><b>7.3.2</b> Color the map</a></li>
<li class="chapter" data-level="7.3.3" data-path="map.html"><a href="map.html#interactive-map"><i class="fa fa-check"></i><b>7.3.3</b> Interactive map</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="map.html"><a href="map.html#legend-1"><i class="fa fa-check"></i><b>7.4</b> Legend</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="map.html"><a href="map.html#classification-schemes"><i class="fa fa-check"></i><b>7.4.1</b> Classification schemes</a></li>
<li class="chapter" data-level="7.4.2" data-path="map.html"><a href="map.html#mapping-variables-to-colors"><i class="fa fa-check"></i><b>7.4.2</b> Mapping variables to colors</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="map.html"><a href="map.html#an-example-of-county-level-map"><i class="fa fa-check"></i><b>7.5</b> An Example of County-level Map</a></li>
<li class="chapter" data-level="7.6" data-path="map.html"><a href="map.html#spot-maps"><i class="fa fa-check"></i><b>7.6</b> Spot Maps</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="map.html"><a href="map.html#adding-circles"><i class="fa fa-check"></i><b>7.6.1</b> Adding circles</a></li>
<li class="chapter" data-level="7.6.2" data-path="map.html"><a href="map.html#add-popups"><i class="fa fa-check"></i><b>7.6.2</b> Add popups</a></li>
<li class="chapter" data-level="7.6.3" data-path="map.html"><a href="map.html#add-labels"><i class="fa fa-check"></i><b>7.6.3</b> Add labels</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="map.html"><a href="map.html#integrating-leaflet-with-r-shiny"><i class="fa fa-check"></i><b>7.7</b> Integrating Leaflet with R Shiny</a></li>
<li class="chapter" data-level="7.8" data-path="map.html"><a href="map.html#exercises-3"><i class="fa fa-check"></i><b>7.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="modeling.html"><a href="modeling.html"><i class="fa fa-check"></i><b>8</b> Epidemic Modeling</a>
<ul>
<li class="chapter" data-level="8.1" data-path="modeling.html"><a href="modeling.html#an-introduction-to-epidemic-modeling"><i class="fa fa-check"></i><b>8.1</b> An Introduction to Epidemic Modeling</a></li>
<li class="chapter" data-level="8.2" data-path="modeling.html"><a href="modeling.html#mechanistic-models"><i class="fa fa-check"></i><b>8.2</b> Mechanistic Models</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="modeling.html"><a href="modeling.html#compartment-modeling"><i class="fa fa-check"></i><b>8.2.1</b> Compartment Modeling</a></li>
<li class="chapter" data-level="8.2.2" data-path="modeling.html"><a href="modeling.html#agent-based-methods"><i class="fa fa-check"></i><b>8.2.2</b> Agent-based Methods</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="modeling.html"><a href="modeling.html#phenomenological-models"><i class="fa fa-check"></i><b>8.3</b> Phenomenological Models</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="modeling.html"><a href="modeling.html#time-series-analysis"><i class="fa fa-check"></i><b>8.3.1</b> Time Series Analysis</a></li>
<li class="chapter" data-level="8.3.2" data-path="modeling.html"><a href="modeling.html#regression-methods"><i class="fa fa-check"></i><b>8.3.2</b> Regression methods</a></li>
<li class="chapter" data-level="8.3.3" data-path="modeling.html"><a href="modeling.html#machine-learning-methods"><i class="fa fa-check"></i><b>8.3.3</b> Machine learning methods</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="modeling.html"><a href="modeling.html#hybrid-models-and-ensemble-methods"><i class="fa fa-check"></i><b>8.4</b> Hybrid Models and Ensemble Methods</a></li>
<li class="chapter" data-level="8.5" data-path="modeling.html"><a href="modeling.html#epidemic-modeling-mathematical-and-statistical-perspectives"><i class="fa fa-check"></i><b>8.5</b> Epidemic Modeling: Mathematical and Statistical Perspectives</a></li>
<li class="chapter" data-level="8.6" data-path="modeling.html"><a href="modeling.html#some-terminologies-in-epidemic-modeling"><i class="fa fa-check"></i><b>8.6</b> Some Terminologies in Epidemic Modeling</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="compartment.html"><a href="compartment.html"><i class="fa fa-check"></i><b>9</b> Compartment Models</a>
<ul>
<li class="chapter" data-level="9.1" data-path="compartment.html"><a href="compartment.html#a-simple-sis-model-a-model-for-diseases-with-no-immunity"><i class="fa fa-check"></i><b>9.1</b> A Simple SIS Model (A Model for Diseases with No Immunity)</a></li>
<li class="chapter" data-level="9.2" data-path="compartment.html"><a href="compartment.html#an-sir-model"><i class="fa fa-check"></i><b>9.2</b> An SIR Model</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="compartment.html"><a href="compartment.html#an-sir-model-with-births-and-deaths"><i class="fa fa-check"></i><b>9.2.1</b> An SIR model with births and deaths</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="compartment.html"><a href="compartment.html#sir-parameter-estimation"><i class="fa fa-check"></i><b>9.3</b> SIR parameter estimation</a></li>
<li class="chapter" data-level="9.4" data-path="compartment.html"><a href="compartment.html#implementation-of-parameter-estimation-in-r"><i class="fa fa-check"></i><b>9.4</b> Implementation of parameter estimation in R</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="compartment.html"><a href="compartment.html#example-1.-outbreak-of-measles-in-niamey"><i class="fa fa-check"></i><b>9.4.1</b> Example 1. Outbreak of measles in Niamey</a></li>
<li class="chapter" data-level="9.4.2" data-path="compartment.html"><a href="compartment.html#example-2.-covid-19"><i class="fa fa-check"></i><b>9.4.2</b> Example 2. COVID-19</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="compartment.html"><a href="compartment.html#basic-reproduction-number"><i class="fa fa-check"></i><b>9.5</b> Basic Reproduction Number</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="compartment.html"><a href="compartment.html#seir-model"><i class="fa fa-check"></i><b>9.5.1</b> SEIR Model</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="compartment.html"><a href="compartment.html#herd-immunity"><i class="fa fa-check"></i><b>9.6</b> Herd Immunity</a></li>
<li class="chapter" data-level="9.7" data-path="compartment.html"><a href="compartment.html#exercises-4"><i class="fa fa-check"></i><b>9.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="timeseries.html"><a href="timeseries.html"><i class="fa fa-check"></i><b>10</b> Time Series Analysis of Infectious Disease Data</a>
<ul>
<li class="chapter" data-level="10.1" data-path="timeseries.html"><a href="timeseries.html#datasets-and-r-packages"><i class="fa fa-check"></i><b>10.1</b> Datasets and R Packages</a></li>
<li class="chapter" data-level="10.2" data-path="timeseries.html"><a href="timeseries.html#an-introduction-to-time-series-analysis"><i class="fa fa-check"></i><b>10.2</b> An Introduction to Time Series Analysis</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="timeseries.html"><a href="timeseries.html#tsibble-objects"><i class="fa fa-check"></i><b>10.2.1</b> “tsibble” objects</a></li>
<li class="chapter" data-level="10.2.2" data-path="timeseries.html"><a href="timeseries.html#working-with-tsibble-objects"><i class="fa fa-check"></i><b>10.2.2</b> Working with “tsibble” objects</a></li>
<li class="chapter" data-level="10.2.3" data-path="timeseries.html"><a href="timeseries.html#drawing-time-series-plots"><i class="fa fa-check"></i><b>10.2.3</b> Drawing time series plots</a></li>
<li class="chapter" data-level="10.2.4" data-path="timeseries.html"><a href="timeseries.html#objectives-of-time-series-analysis"><i class="fa fa-check"></i><b>10.2.4</b> Objectives of Time Series Analysis</a></li>
<li class="chapter" data-level="10.2.5" data-path="timeseries.html"><a href="timeseries.html#stationarity"><i class="fa fa-check"></i><b>10.2.5</b> Stationarity</a></li>
<li class="chapter" data-level="10.2.6" data-path="timeseries.html"><a href="timeseries.html#autocorrelation"><i class="fa fa-check"></i><b>10.2.6</b> Autocorrelation</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="timeseries.html"><a href="timeseries.html#time-series-decomposition"><i class="fa fa-check"></i><b>10.3</b> Time Series Decomposition</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="timeseries.html"><a href="timeseries.html#box-cox-transformations"><i class="fa fa-check"></i><b>10.3.1</b> Box-Cox transformations</a></li>
<li class="chapter" data-level="10.3.2" data-path="timeseries.html"><a href="timeseries.html#methods-for-estimating-the-trend"><i class="fa fa-check"></i><b>10.3.2</b> Methods for estimating the trend</a></li>
<li class="chapter" data-level="10.3.3" data-path="timeseries.html"><a href="timeseries.html#seasonal-component"><i class="fa fa-check"></i><b>10.3.3</b> Seasonal component</a></li>
<li class="chapter" data-level="10.3.4" data-path="timeseries.html"><a href="timeseries.html#trend-and-seasonal-estimation"><i class="fa fa-check"></i><b>10.3.4</b> Trend and seasonal estimation:</a></li>
<li class="chapter" data-level="10.3.5" data-path="timeseries.html"><a href="timeseries.html#seasonal-and-trend-decomposition-using-loess-stl"><i class="fa fa-check"></i><b>10.3.5</b> Seasonal and trend decomposition using Loess (STL)</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="timeseries.html"><a href="timeseries.html#simple-time-series-forecasting-approaches"><i class="fa fa-check"></i><b>10.4</b> Simple Time Series Forecasting Approaches</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="timeseries.html"><a href="timeseries.html#average-method"><i class="fa fa-check"></i><b>10.4.1</b> Average method</a></li>
<li class="chapter" data-level="10.4.2" data-path="timeseries.html"><a href="timeseries.html#random-walk-forecasts"><i class="fa fa-check"></i><b>10.4.2</b> Random walk forecasts</a></li>
<li class="chapter" data-level="10.4.3" data-path="timeseries.html"><a href="timeseries.html#seasonal-random-walk-forecasts"><i class="fa fa-check"></i><b>10.4.3</b> Seasonal random walk forecasts</a></li>
<li class="chapter" data-level="10.4.4" data-path="timeseries.html"><a href="timeseries.html#random-walk-with-drift-method"><i class="fa fa-check"></i><b>10.4.4</b> Random walk with drift method</a></li>
<li class="chapter" data-level="10.4.5" data-path="timeseries.html"><a href="timeseries.html#displaying-all-the-forecasting-results"><i class="fa fa-check"></i><b>10.4.5</b> Displaying all the forecasting results</a></li>
<li class="chapter" data-level="10.4.6" data-path="timeseries.html"><a href="timeseries.html#distributional-forecasts-and-prediction-intervals"><i class="fa fa-check"></i><b>10.4.6</b> Distributional forecasts and prediction intervals</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="timeseries.html"><a href="timeseries.html#residual-diagnostics-and-accuracy-evaluation"><i class="fa fa-check"></i><b>10.5</b> Residual Diagnostics and Accuracy Evaluation</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="timeseries.html"><a href="timeseries.html#residual-diagnostics"><i class="fa fa-check"></i><b>10.5.1</b> Residual diagnostics</a></li>
<li class="chapter" data-level="10.5.2" data-path="timeseries.html"><a href="timeseries.html#forecasting-accuracy"><i class="fa fa-check"></i><b>10.5.2</b> Forecasting accuracy</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="timeseries.html"><a href="timeseries.html#arima-models"><i class="fa fa-check"></i><b>10.6</b> ARIMA Models</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="timeseries.html"><a href="timeseries.html#differencing"><i class="fa fa-check"></i><b>10.6.1</b> Differencing</a></li>
<li class="chapter" data-level="10.6.2" data-path="timeseries.html"><a href="timeseries.html#arma-models"><i class="fa fa-check"></i><b>10.6.2</b> ARMA models</a></li>
<li class="chapter" data-level="10.6.3" data-path="timeseries.html"><a href="timeseries.html#simple-examples-of-arma-models"><i class="fa fa-check"></i><b>10.6.3</b> Simple examples of ARMA models</a></li>
<li class="chapter" data-level="10.6.4" data-path="timeseries.html"><a href="timeseries.html#arima-models-1"><i class="fa fa-check"></i><b>10.6.4</b> ARIMA models</a></li>
<li class="chapter" data-level="10.6.5" data-path="timeseries.html"><a href="timeseries.html#seasonal-arima-sarima-model"><i class="fa fa-check"></i><b>10.6.5</b> Seasonal ARIMA (SARIMA) model</a></li>
<li class="chapter" data-level="10.6.6" data-path="timeseries.html"><a href="timeseries.html#building-sarima-models"><i class="fa fa-check"></i><b>10.6.6</b> Building SARIMA Models</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="timeseries.html"><a href="timeseries.html#model-comparison"><i class="fa fa-check"></i><b>10.7</b> Model Comparison</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="timeseries.html"><a href="timeseries.html#exponential-smoothing-and-arima-models"><i class="fa fa-check"></i><b>10.7.1</b> Exponential smoothing and ARIMA models</a></li>
<li class="chapter" data-level="10.7.2" data-path="timeseries.html"><a href="timeseries.html#cross-validation-for-time-series-analysis"><i class="fa fa-check"></i><b>10.7.2</b> Cross-validation for Time series analysis</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="timeseries.html"><a href="timeseries.html#ensuring-forecasts-stay-within-limits"><i class="fa fa-check"></i><b>10.8</b> Ensuring Forecasts Stay Within Limits</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="timeseries.html"><a href="timeseries.html#positive-forecasts"><i class="fa fa-check"></i><b>10.8.1</b> Positive forecasts</a></li>
<li class="chapter" data-level="10.8.2" data-path="timeseries.html"><a href="timeseries.html#forecasts-constrained-to-an-interval"><i class="fa fa-check"></i><b>10.8.2</b> Forecasts constrained to an interval</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="timeseries.html"><a href="timeseries.html#prediction-and-prediction-intervals-for-aggregates"><i class="fa fa-check"></i><b>10.9</b> Prediction and Prediction Intervals for Aggregates</a></li>
<li class="chapter" data-level="10.10" data-path="timeseries.html"><a href="timeseries.html#exercises-5"><i class="fa fa-check"></i><b>10.10</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>11</b> Regression Methods</a>
<ul>
<li class="chapter" data-level="11.1" data-path="regression.html"><a href="regression.html#parametric-regression-methods"><i class="fa fa-check"></i><b>11.1</b> Parametric Regression Methods</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="regression.html"><a href="regression.html#examples"><i class="fa fa-check"></i><b>11.1.1</b> Examples</a></li>
<li class="chapter" data-level="11.1.2" data-path="regression.html"><a href="regression.html#model-adequacy-checking"><i class="fa fa-check"></i><b>11.1.2</b> Model adequacy checking</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="regression.html"><a href="regression.html#nonparametric-regression-methods"><i class="fa fa-check"></i><b>11.2</b> Nonparametric Regression Methods</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="regression.html"><a href="regression.html#piecewise-constant-splines"><i class="fa fa-check"></i><b>11.2.1</b> Piecewise constant splines</a></li>
<li class="chapter" data-level="11.2.2" data-path="regression.html"><a href="regression.html#truncated-power-splines"><i class="fa fa-check"></i><b>11.2.2</b> Truncated power splines</a></li>
<li class="chapter" data-level="11.2.3" data-path="regression.html"><a href="regression.html#b-splines-and-natural-splines"><i class="fa fa-check"></i><b>11.2.3</b> B-splines and natural splines</a></li>
<li class="chapter" data-level="11.2.4" data-path="regression.html"><a href="regression.html#smoothing-splines"><i class="fa fa-check"></i><b>11.2.4</b> Smoothing splines</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="regression.html"><a href="regression.html#example-cdc-fluview-portal-data"><i class="fa fa-check"></i><b>11.3</b> Example: CDC FluView Portal Data</a></li>
<li class="chapter" data-level="11.4" data-path="regression.html"><a href="regression.html#poisson-regression"><i class="fa fa-check"></i><b>11.4</b> Poisson regression</a></li>
<li class="chapter" data-level="11.5" data-path="regression.html"><a href="regression.html#logistic-regression"><i class="fa fa-check"></i><b>11.5</b> Logistic regression</a></li>
<li class="chapter" data-level="11.6" data-path="regression.html"><a href="regression.html#exercises-6"><i class="fa fa-check"></i><b>11.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="NN.html"><a href="NN.html"><i class="fa fa-check"></i><b>12</b> Neural Networks</a>
<ul>
<li class="chapter" data-level="12.1" data-path="NN.html"><a href="NN.html#a-single-neuron"><i class="fa fa-check"></i><b>12.1</b> A Single Neuron</a></li>
<li class="chapter" data-level="12.2" data-path="NN.html"><a href="NN.html#neural-network-structure"><i class="fa fa-check"></i><b>12.2</b> Neural Network Structure</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="NN.html"><a href="NN.html#forward-propagation"><i class="fa fa-check"></i><b>12.2.1</b> Forward propagation</a></li>
<li class="chapter" data-level="12.2.2" data-path="NN.html"><a href="NN.html#back-propagation"><i class="fa fa-check"></i><b>12.2.2</b> Back-propagation</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="NN.html"><a href="NN.html#overfitting"><i class="fa fa-check"></i><b>12.3</b> Overfitting</a></li>
<li class="chapter" data-level="12.4" data-path="NN.html"><a href="NN.html#neural-network-auto-regressive-nnar-models"><i class="fa fa-check"></i><b>12.4</b> Neural Network Auto-Regressive (NNAR) models</a></li>
<li class="chapter" data-level="12.5" data-path="NN.html"><a href="NN.html#covid-19-forecasting"><i class="fa fa-check"></i><b>12.5</b> COVID-19 Forecasting</a></li>
<li class="chapter" data-level="12.6" data-path="NN.html"><a href="NN.html#exercises-7"><i class="fa fa-check"></i><b>12.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="ensemble.html"><a href="ensemble.html"><i class="fa fa-check"></i><b>13</b> Hybrid Mdels</a>
<ul>
<li class="chapter" data-level="13.1" data-path="ensemble.html"><a href="ensemble.html#ensembling-time-series-models"><i class="fa fa-check"></i><b>13.1</b> Ensembling Time Series Models</a></li>
<li class="chapter" data-level="13.2" data-path="ensemble.html"><a href="ensemble.html#model-diagnostics"><i class="fa fa-check"></i><b>13.2</b> Model Diagnostics</a></li>
<li class="chapter" data-level="13.3" data-path="ensemble.html"><a href="ensemble.html#forecasting"><i class="fa fa-check"></i><b>13.3</b> Forecasting</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="ensemble.html"><a href="ensemble.html#perform-cross-validation-on-a-time-series"><i class="fa fa-check"></i><b>13.3.1</b> Perform cross validation on a time series</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="ensemble.html"><a href="ensemble.html#weights-selection-using-cross-validation"><i class="fa fa-check"></i><b>13.4</b> Weights Selection Using Cross Validation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i>Appendix</a></li>
<li class="chapter" data-level="14" data-path="appendix-a.html"><a href="appendix-a.html"><i class="fa fa-check"></i><b>14</b> Appendix A</a>
<ul>
<li class="chapter" data-level="14.1" data-path="appendix-a.html"><a href="appendix-a.html#r-introduction-and-preliminaries"><i class="fa fa-check"></i><b>14.1</b> R Introduction and Preliminaries</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="appendix-a.html"><a href="appendix-a.html#the-r-environment-and-language"><i class="fa fa-check"></i><b>14.1.1</b> The R Environment and Language</a></li>
<li class="chapter" data-level="14.1.2" data-path="appendix-a.html"><a href="appendix-a.html#r-and-statistics"><i class="fa fa-check"></i><b>14.1.2</b> R and Statistics</a></li>
<li class="chapter" data-level="14.1.3" data-path="appendix-a.html"><a href="appendix-a.html#obtaining-r-and-installation"><i class="fa fa-check"></i><b>14.1.3</b> Obtaining R and installation</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="appendix-a.html"><a href="appendix-a.html#starting-r"><i class="fa fa-check"></i><b>14.2</b> Starting R</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="appendix-a.html"><a href="appendix-a.html#description-of-three-panels-in-user-interface"><i class="fa fa-check"></i><b>14.2.1</b> Description of three panels in user interface</a></li>
<li class="chapter" data-level="14.2.2" data-path="appendix-a.html"><a href="appendix-a.html#r-help"><i class="fa fa-check"></i><b>14.2.2</b> R help</a></li>
<li class="chapter" data-level="14.2.3" data-path="appendix-a.html"><a href="appendix-a.html#some-mathematical-expressions"><i class="fa fa-check"></i><b>14.2.3</b> Some mathematical expressions</a></li>
<li class="chapter" data-level="14.2.4" data-path="appendix-a.html"><a href="appendix-a.html#r-packages"><i class="fa fa-check"></i><b>14.2.4</b> R Packages</a></li>
<li class="chapter" data-level="14.2.5" data-path="appendix-a.html"><a href="appendix-a.html#creating-a-project-and-setting-working-directory"><i class="fa fa-check"></i><b>14.2.5</b> Creating a project and setting working directory</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="appendix-a.html"><a href="appendix-a.html#exportimport-data"><i class="fa fa-check"></i><b>14.3</b> Export/Import Data</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="appendix-a.html"><a href="appendix-a.html#data-export"><i class="fa fa-check"></i><b>14.3.1</b> Data Export</a></li>
<li class="chapter" data-level="14.3.2" data-path="appendix-a.html"><a href="appendix-a.html#data-import"><i class="fa fa-check"></i><b>14.3.2</b> Data Import</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="appendix-b.html"><a href="appendix-b.html"><i class="fa fa-check"></i><b>15</b> Appendix B</a>
<ul>
<li class="chapter" data-level="15.1" data-path="appendix-b.html"><a href="appendix-b.html#epidemic-data"><i class="fa fa-check"></i><b>15.1</b> Epidemic Data</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="appendix-b.html"><a href="appendix-b.html#state-level"><i class="fa fa-check"></i><b>15.1.1</b> State level</a></li>
<li class="chapter" data-level="15.1.2" data-path="appendix-b.html"><a href="appendix-b.html#county-level"><i class="fa fa-check"></i><b>15.1.2</b> County level</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="appendix-b.html"><a href="appendix-b.html#other-factors"><i class="fa fa-check"></i><b>15.2</b> Other Factors</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="appendix-b.html"><a href="appendix-b.html#policy-data"><i class="fa fa-check"></i><b>15.2.1</b> Policy Data</a></li>
<li class="chapter" data-level="15.2.2" data-path="appendix-b.html"><a href="appendix-b.html#demographic-characteristics"><i class="fa fa-check"></i><b>15.2.2</b> Demographic Characteristics</a></li>
<li class="chapter" data-level="15.2.3" data-path="appendix-b.html"><a href="appendix-b.html#healthcare-infrastructure"><i class="fa fa-check"></i><b>15.2.3</b> Healthcare Infrastructure</a></li>
<li class="chapter" data-level="15.2.4" data-path="appendix-b.html"><a href="appendix-b.html#socioeconomic-status"><i class="fa fa-check"></i><b>15.2.4</b> Socioeconomic Status</a></li>
<li class="chapter" data-level="15.2.5" data-path="appendix-b.html"><a href="appendix-b.html#environmental-factor"><i class="fa fa-check"></i><b>15.2.5</b> Environmental Factor</a></li>
<li class="chapter" data-level="15.2.6" data-path="appendix-b.html"><a href="appendix-b.html#mobility"><i class="fa fa-check"></i><b>15.2.6</b> Mobility</a></li>
<li class="chapter" data-level="15.2.7" data-path="appendix-b.html"><a href="appendix-b.html#geographic-information"><i class="fa fa-check"></i><b>15.2.7</b> Geographic Information</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="appendix-b.html"><a href="appendix-b.html#data-sets"><i class="fa fa-check"></i><b>15.3</b> Data Sets</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="appendix-b.html"><a href="appendix-b.html#chapter-2"><i class="fa fa-check"></i><b>15.3.1</b> Chapter 2</a></li>
<li class="chapter" data-level="15.3.2" data-path="appendix-b.html"><a href="appendix-b.html#chapter-3"><i class="fa fa-check"></i><b>15.3.2</b> Chapter 3</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Learning of Infectious Disease Data Analytics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="NN" class="section level1" number="12">
<h1><span class="header-section-number">Chapter 12</span> Neural Networks</h1>
<p>Machine learning methods are attractive in epidemiological modeling and projection with their great flexibility to capture disease spread patterns. In this chapter, we describe a popular machine learning method for epi-forecasting called neural networks.</p>
<p>Artificial Neural Network is a computing system inspired by a biological neural network that constitutes the animal brain. Such systems “learn” to perform tasks by considering examples, generally without being programmed with any task-specific rules.</p>
<div id="a-single-neuron" class="section level2" number="12.1">
<h2><span class="header-section-number">12.1</span> A Single Neuron</h2>
<p>The basic unit of computation in a neural network is the neuron, often called a node or unit. It receives input from some other nodes or an external source and computes an output. Each input has an associated weight (<span class="math inline">\(w\)</span>), which is assigned on the basis of its relative importance to other inputs. The node applies a function <span class="math inline">\(f\)</span> (defined below) to the weighted sum of its inputs as shown in Figure <a href="NN.html#fig:NN1">12.1</a> below:</p>
<div class="figure" style="text-align: center"><span id="fig:NN1"></span>
<img src="figures/NN1.png" alt="An illustration of a single neuron." width="40%" />
<p class="caption">
Figure 12.1: An illustration of a single neuron.
</p>
</div>
<p>The above network takes numerical inputs <span class="math inline">\(X_0,X_1,X_2,X_3\)</span> and has weights <span class="math inline">\(\beta_0,\beta_1,\beta_2,\beta_3\)</span> associated with those inputs. The output <span class="math inline">\(a_1^{(2)}\)</span> from the neuron shown in Figure <a href="NN.html#fig:NN1">12.1</a> is computed using <span class="math inline">\(g(\sum_{k=0}^{3}\beta_kX_k)\)</span>, where <span class="math inline">\(g(\cdot)\)</span> is non-linear and is called the <strong>Activation Function</strong>. The purpose of the activation function is to introduce non-linearity into the output of a neuron. This is important because most real data is non linear and we want neurons to learn these non linear representations.</p>
<p>Every activation function (or non-linearity) takes a single number and performs a certain fixed mathematical operation on it. There are several activation functions you may encounter in practice:</p>
<p><strong>Sigmoid:</strong> takes a real-valued input and squashes it to range between 0 and 1
<span class="math display">\[
  g(x) = 1 / (1 + \exp(-x))
\]</span></p>
<p><strong>tanh:</strong> takes a real-valued input and squashes it to the range <span class="math inline">\([-1, 1]\)</span>
<span class="math display">\[
  \tanh(x) = 2g(2x) - 1
\]</span></p>
<p><strong>ReLU (Rectified Linear Unit):</strong> it takes a real-valued input and thresholds it at zero (replaces negative values with zero)
<span class="math display">\[
  f(x) = \max(0, x)
\]</span></p>
<p>Figure <a href="NN.html#fig:active">12.2</a> show each of the above activation functions.</p>
<div class="figure" style="text-align: center"><span id="fig:active"></span>
<img src="figures/sigmoid.pdf" alt="An illustration of activation functions." width="30%" /><img src="figures/tanh.pdf" alt="An illustration of activation functions." width="30%" /><img src="figures/relu.pdf" alt="An illustration of activation functions." width="30%" />
<p class="caption">
Figure 12.2: An illustration of activation functions.
</p>
</div>
<p>As the number of training data for each country is limited, we use a single-layer neural network called the extreme learning machine (ELM) to avoid over-fitting. Due to the non-stationary nature of the time series, a sliding window approach is used to provide a more accurate prediction.</p>
</div>
<div id="neural-network-structure" class="section level2" number="12.2">
<h2><span class="header-section-number">12.2</span> Neural Network Structure</h2>
<p>Figure <a href="NN.html#fig:NN2">12.3</a> shows a neural network constructed from three types of layers:</p>
<p><strong>Input Layer:</strong> The Input layer has four nodes. The other three nodes take <span class="math inline">\(X_1\)</span>, <span class="math inline">\(X_2\)</span> and <span class="math inline">\(X_3\)</span> as external inputs (which are numerical values depending upon the input dataset). As discussed above, no computation is performed in the input layer, so the outputs from nodes in the input layer are <span class="math inline">\(X_0\)</span>, <span class="math inline">\(X_1\)</span>, <span class="math inline">\(X_2\)</span> and <span class="math inline">\(X_3\)</span>, respectively, which are fed into the hidden Layer.</p>
<p><strong>Hidden Layer:</strong> The Hidden layer also has four nodes with the bias node <span class="math inline">\(a_0^{(2)}\)</span>. The output of the other two nodes in the Hidden layer depends on the outputs from the Input layer <span class="math inline">\((X_0, X_1, X_2, X_3)\)</span> as well as the weights associated with the connections (edges). Figure <a href="NN.html#fig:NN2coef">12.4</a> shows the output calculation for one of the hidden nodes (highlighted red). Let <span class="math inline">\(a^{(2)}_i\)</span> be the activation of unit <span class="math inline">\(i\)</span> in the hidden layer. For the hidden neuron <span class="math inline">\(i\)</span>, we have
<span class="math display">\[
\alpha_i^{(2)}=g\left(\sum_{j=0}^3\beta_{j,i}^{(1)}X_j\right),
\]</span>
where <span class="math inline">\(g\)</span> refers to the activation function.</p>
<p><strong>Output Layer:</strong> These outputs are then fed to the nodes in the output layer. In this simple example, the Output layer has one node which takes inputs from the hidden layer. Similarly, the output <span class="math inline">\(a_1^{(3)}\)</span> can be calculated using
<span class="math display">\[
\alpha_1^{(3)}=g\left(\sum_{j=0}^3\beta_{j,1}^{(2)}\alpha_{j}^{(2)}\right).
\]</span></p>
<div class="figure" style="text-align: center"><span id="fig:NN2"></span>
<img src="figures/NN2.png" alt="A neural network with one hidden layer." width="50%" />
<p class="caption">
Figure 12.3: A neural network with one hidden layer.
</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:NN2coef"></span>
<img src="figures/NN2_coef.png" alt="A neural network with one hidden layer." width="50%" />
<p class="caption">
Figure 12.4: A neural network with one hidden layer.
</p>
</div>
<p>Let’s make it more general for a neureal network with muliple hidden layers. Let <span class="math inline">\(a^{(j)}_i\)</span> be the activation of unit <span class="math inline">\(i\)</span> in layer <span class="math inline">\(j\)</span>, and let <span class="math inline">\(\boldsymbol{\beta}^{(j)}\)</span> be a weight matrix which stores parameters from layer <span class="math inline">\(j\)</span> to layer <span class="math inline">\(j+1\)</span>. If network has <span class="math inline">\(s_j\)</span> units in layer <span class="math inline">\(j\)</span> and <span class="math inline">\(s_{j+1}\)</span> units in layer <span class="math inline">\(j+1\)</span>, then <span class="math inline">\(\boldsymbol{\beta}^{(j)}\)</span> has dimension <span class="math inline">\(s_{j+1} \times (s_j+1)\)</span>.
<!-- Next, we denote -->
<!-- \[ -->
<!-- \mathbf{X}= \begin{bmatrix} -->
<!-- X_0 \\  -->
<!-- X_1 \\ -->
<!-- X_2 \\  -->
<!-- X_3 \\  -->
<!-- \end{bmatrix},~ -->
<!-- \mathbf{A}= \begin{bmatrix} -->
<!-- a_0^{(2)} \\  -->
<!-- a_1^{(2)} \\ -->
<!-- a_2^{(2)} \\  -->
<!-- a_3^{(2)} \\  -->
<!-- \end{bmatrix}, -->
<!-- \] --></p>
<p>The neural network model has unknown parameters (weights), and we seek values for them that make the model fit the training data well. For regression, we use sum-of-squared errors as our measure of fit (error function). Thus, our objective function is
<span class="math display">\[
\ell(\boldsymbol{\beta}^{(1)}, \ldots, \boldsymbol{\beta}^{(L)})= \sum_{i=1}^{N}(Y_i - \hat{Y}_i)^2.
\]</span></p>
<p>Typically we don’t want the global minimizer of <span class="math inline">\(\ell(\cdot)\)</span>, as this is likely to be an overfit solution. Instead, some regularization is needed: this is achieved directly through a penalty term, or indirectly by early stopping.</p>
<p>The generic approach to minimizing <span class="math inline">\(\ell(\cdot)\)</span> is by gradient descent, called <strong>back-propagation</strong>; see details below. Because of the model’s compositional form, the gradient can be easily derived using the chain rule for differentiation. This can be computed by a forward and backward sweep over the network, keeping track only of quantities local to each unit.</p>
<p>For any <span class="math inline">\(j\)</span>, a gradient descent update at the <span class="math inline">\(j\)</span>th iteration has the form
<span class="math display">\[
\boldsymbol{\beta}^{(j)} \leftarrow \boldsymbol{\beta}^{(j)} - \alpha \nabla_{\boldsymbol{\beta}^{(j)}} \ell(\boldsymbol{\beta}^{(1)}, \ldots, \boldsymbol{\beta}^{(L)}),
\]</span>
where <span class="math inline">\(\nabla_{\boldsymbol{\beta}^{(j)}} \ell(\boldsymbol{\beta}^{(1)}, \ldots, \boldsymbol{\beta}^{(L)})\)</span> is the partial derivative of <span class="math inline">\(\ell(\boldsymbol{\beta}^{(1)}, \ldots, \boldsymbol{\beta}^{(L)})\)</span> w.r.t <span class="math inline">\(\boldsymbol{\beta}^{(j)}\)</span>, and <span class="math inline">\(\alpha\)</span> is the learning rate. When <span class="math inline">\(\alpha\)</span> is too big, gradient descent may jump across the valley and end up on the other side. This will lead to the error function diverge. When <span class="math inline">\(\alpha\)</span> is too small, it will take the algorithm long time to converge. Therefore, we need to have a proper learning rate before starting the gradient descent.</p>
<div id="forward-propagation" class="section level3" number="12.2.1">
<h3><span class="header-section-number">12.2.1</span> Forward propagation</h3>
<div class="figure" style="text-align: center"><span id="fig:NN3"></span>
<img src="figures/NN3.png" alt="A neural network with three hidden layer." width="60%" />
<p class="caption">
Figure 12.5: A neural network with three hidden layer.
</p>
</div>
<p>We start with one single observation point <span class="math inline">\((Y_i, \mathbf{X}_i)\)</span>. As shown in Figure <a href="NN.html#fig:NN3">12.5</a>, we can use the following equations to form network’s forward propagation.</p>
<p><span class="math display">\[\begin{eqnarray*}
\mathbf{a}^{(1)} &amp;=&amp; \mathbf{X}_i,\\
\mathbf{z}^{(2)} &amp;=&amp; \boldsymbol{\beta}^{(1)\top}\mathbf{a}^{(1)},\\
\mathbf{a}^{(2)} &amp;=&amp; g(\mathbf{z}^{(2)}), ~(\mathrm{add~} a^{(2)}_0),\\
\mathbf{z}^{(3)} &amp;=&amp; \boldsymbol{\beta}^{(2)\top}\mathbf{a}^{(2)},\\
\mathbf{a}^{(3)} &amp;=&amp; g(\mathbf{z}^{(3)}), ~(\mathrm{add~} a^{(3)}_0),\\
\mathbf{z}^{(4)} &amp;=&amp; \boldsymbol{\beta}^{(3)\top}\mathbf{a}^{(3)},\\
\mathbf{a}^{(4)} &amp;=&amp; g(\mathbf{z}^{(4)}).
\end{eqnarray*}\]</span></p>
<p>The final step in a forward pass is to evaluate the predicted output <span class="math inline">\(\hat{Y}_i\)</span> against an observed output <span class="math inline">\(Y_i\)</span>. Evaluation between <span class="math inline">\(\hat{Y}_i\)</span> and <span class="math inline">\(Y_i\)</span> happens through an error function, which can be the mean squared error in the regression case.</p>
</div>
<div id="back-propagation" class="section level3" number="12.2.2">
<h3><span class="header-section-number">12.2.2</span> Back-propagation</h3>
<p>Back-propagation is an efficient method for computing gradients needed to perform gradient-based optimization of the weights in a multi-layer network.</p>
<p><strong>Backpropagation: top layer</strong></p>
<div class="figure" style="text-align: center"><span id="fig:back1"></span>
<img src="figures/back1.png" alt="A neural network with one hidden layer." width="50%" />
<p class="caption">
Figure 12.6: A neural network with one hidden layer.
</p>
</div>
<p>To minize the error function <span class="math inline">\(\ell\)</span>, we want to find partial derivatives:
<span class="math display">\[
\frac{\partial \ell}{\partial \beta_{01}^{(2)}}, \ldots, \frac{\partial \ell}{\partial \beta_{31}^{(2)}},
\]</span>
and we can show, for example,
<span class="math display">\[\begin{align*}
\frac{\partial \ell}{\partial \beta_{01}^{(2)}} &amp; = \frac{\partial \ell}{\partial a_1^{(3)}}
\frac{\partial a_1^{(3)}}{\partial z_1^{(3)}} \frac{\partial z_1^{(3)}}{\partial \beta_{01}^{(2)}}\\
&amp; = 2(Y-a_1^{(3)})g&#39;_0(z_1^{(3)})a_0^{(2)},
\end{align*}\]</span>
where <span class="math inline">\(g&#39;_0\)</span> is the derivative of the activation function <span class="math inline">\(g\)</span> in the output layer.</p>
<p>Then, we update <span class="math inline">\(\beta_{0,1}^{(2)}\)</span> by
<span class="math display">\[
\beta_{0,1}^{(2)} = \beta_{0,1}^{(2)} - \alpha \frac{\partial \ell}{\partial \beta_{0,1}^{(2)}}.
\]</span></p>
<p><strong>Backpropagation: next layer</strong></p>
<div class="figure" style="text-align: center"><span id="fig:back2"></span>
<img src="figures/back2.png" alt="a neural network with one hidden layer." width="50%" />
<p class="caption">
Figure 12.7: a neural network with one hidden layer.
</p>
</div>
<p>Next, we want to find the following partial derivatives:
<span class="math display">\[
\frac{\partial \ell}{\partial \beta_{0,1}^{(1)}}, \cdots, \frac{\partial \ell}{\partial \beta_{0,3}^{(1)}},
\]</span>
and for example, we have
<span class="math display">\[\begin{align*}
\frac{\partial \ell}{\partial \beta_{01}^{(2)}} &amp; = \frac{\partial \ell}{\partial a_1^{(3)}}
\frac{\partial a_1^{(3)}}{\partial z_1^{(3)}} \frac{\partial z_1^{(3)}}{\partial \partial a_1^{(2)}} \frac{\partial a_1^{(2)}}{\partial z_1^{(2)}} \frac{\partial z_1^{(2)}}{\partial \beta_{01}^{(2)}}\\
&amp; = 2(Y-a_1^{(3)})g&#39;_0(z_1^{(3)}) \beta^{(2)}_{11} g&#39;_1(z_1^{(2)}) X_0,
\end{align*}\]</span>
where <span class="math inline">\(g&#39;_0\)</span> is the derivative of the activation function in the output layer and <span class="math inline">\(g&#39;_1\)</span> is the derivative fo the activation function in Layer 2.</p>
<p>Then, we update <span class="math inline">\(\beta_{01}^{(1)}\)</span> by
<span class="math display">\[
\beta_{0,1}^{(1)} = \beta_{0,1}^{(1)} - \alpha \frac{\partial \ell}{\partial \beta_{0,1}^{(1)}}.
\]</span></p>
<p>Initial values of the weights and biases <span class="math inline">\(\boldsymbol{\beta}\)</span> are randomly chosen. Derivative of <span class="math inline">\(\ell\)</span> can be calculated using the partial derivatives described above. Termination condition is met once the error function is minimized.</p>
<p><strong>Back Propagation: Jacobian Matrix</strong></p>
<p>The Jacobian matrix of a vector-valued function in several variables is the matrix of all its first-order partial derivatives. Suppose <span class="math inline">\(\boldsymbol{f}: R^{n} \to R^{m}\)</span>, the Jacobian matrix of function <span class="math inline">\(\boldsymbol{f}\)</span> is
<span class="math display">\[
\boldsymbol{J} = \frac{\partial \boldsymbol{f}}{\partial \boldsymbol{x}}
 = \begin{bmatrix}
\frac{\partial f_1}{\partial x_1}  &amp; \ldots  &amp;  \frac{\partial f_1}{\partial x_n} \\
\vdots  &amp; \ddots &amp; \vdots \\
\frac{\partial f_m}{\partial x_1}  &amp; \ldots  &amp;  \frac{\partial f_m}{\partial x_n} 
\end{bmatrix}.
\]</span></p>
<p>We have the following chain rule:
<span class="math display">\[
\frac{\partial \boldsymbol{f}\{{\boldsymbol{g}(\boldsymbol{x})\}}}{\partial \boldsymbol{x}} = \frac{\partial \boldsymbol{f}\{{\boldsymbol{g}(\boldsymbol{x})\}}}{\partial \boldsymbol{g}(\boldsymbol{x})}  \times 
\frac{\boldsymbol{g}(\boldsymbol{x}) }{\partial \boldsymbol{x}}. 
\]</span></p>
</div>
</div>
<div id="overfitting" class="section level2" number="12.3">
<h2><span class="header-section-number">12.3</span> Overfitting</h2>
<p>Often neural networks have too many weights and will overfit the data, so we add a penalty to the error function:
<span class="math display">\[
\sum_{j = 1}^{L} \|\boldsymbol{\beta}^{(j)}\|_F,~\|\boldsymbol{\beta}^{(j)}\|_F= \sum_{k=1}^{s_j} \sum_{k&#39;=1}^{s_{j+1}}(\beta^{(j)}_{k,k&#39;})^2,
\]</span>
where <span class="math inline">\(\|\boldsymbol{\beta}^{(j)}\|_F\)</span> is the Frobenius norm of matrix <span class="math inline">\(\boldsymbol{\beta}^{(j)}\)</span>.</p>
<p>We minimize the following objective function
<span class="math display">\[
\ell(\boldsymbol{\beta}^{(1)}, \ldots, \boldsymbol{\beta}^{(L)}) + \lambda \sum_{j = 1}^{L} \|\boldsymbol{\beta}^{(j)}\|_F,
\]</span>
where <span class="math inline">\(\|\cdot\|_F\)</span> denotes the Frobenius norm.</p>
</div>
<div id="neural-network-auto-regressive-nnar-models" class="section level2" number="12.4">
<h2><span class="header-section-number">12.4</span> Neural Network Auto-Regressive (NNAR) models</h2>
<p>Lagged values of the time series can be used as inputs to a neural network. In this section, we only consider feed-forward networks with one hidden layer, and we use the notation NNAR<span class="math inline">\((p,k)\)</span> to indicate there are <span class="math inline">\(p\)</span> lagged inputs and <span class="math inline">\(k\)</span> nodes in the hidden layer. For example, a NNAR(9,5) model is a neural network with the last nine observations <span class="math inline">\((y_{t-1}, y_{t-2}, \ldots, y_{t-9})\)</span> used as inputs for forecasting the output <span class="math inline">\(y_t\)</span>, and with five neurons in the hidden layer.</p>
<p>NNAR<span class="math inline">\((p,0)\)</span> model is equivalent to an ARIMA<span class="math inline">\((p,0,0)\)</span> model but without stationarity restrictions, but without the restrictions on the parameters to ensure stationarity.</p>
<p>For seasonal data, we can consider seasonal NNAR<span class="math inline">\((p,P,k)\)</span>, which use inputs <span class="math inline">\((Y_{t-1},Y_{t-2},\ldots, Y_{t-p}, Y_{t-m}, Y_{t-2m},\ldots, Y_{t-Pm})\)</span> and <span class="math inline">\(k\)</span> neurons in the hidden layer. For example, an NNAR<span class="math inline">\((3,1,2)_{7}\)</span> model has inputs <span class="math inline">\((Y_{t-1},Y_{t-2}, Y_{t-3}, Y_{t-7})\)</span>, and two neurons in the hidden layer. An NNAR<span class="math inline">\((p,P,0)_m\)</span> model is equivalent to an ARIMA<span class="math inline">\((p,0,0)(P,0,0)_m\)</span> model but without stationarity restrictions.</p>
<p><strong>NNAR models in R</strong></p>
<p>The <code>nnetar()</code> function fits an NNAR<span class="math inline">\((p,P,k)_m\)</span> model. If <span class="math inline">\(p\)</span> and <span class="math inline">\(P\)</span> are not specified, they are automatically selected. For non-seasonal time series, default <span class="math inline">\(p =\)</span> optimal number of lags (according to the AIC) for a linear AR<span class="math inline">\((p)\)</span> model. For seasonal time series, defaults are <span class="math inline">\(P = 1\)</span> and <span class="math inline">\(P\)</span> is chosen from the optimal linear model fitted to the seasonally adjusted data. Default <span class="math inline">\(k = (p+P+1)=2\)</span> (rounded to the nearest integer).</p>
<p>When it comes to forecasting, the network is applied iteratively. For forecasting one step ahead, we simply use the available historical inputs. For forecasting two steps ahead, we use the one-step forecast as an input, along with the historical data. This process proceeds until we have computed all the required forecasts.</p>
</div>
<div id="covid-19-forecasting" class="section level2" number="12.5">
<h2><span class="header-section-number">12.5</span> COVID-19 Forecasting</h2>
<p>To forecast the future number of cases, we define <span class="math inline">\(\mathbf{y} = (y_{n-w+1}, \ldots, y_{n-1}, y_n)^{\top}\in R^{w}\)</span>. We are interested in predict <span class="math inline">\(y_{n+h}\in R\)</span>. We use cross-validation to find the proper window size <span class="math inline">\(w\)</span>, number of hidden neurons <span class="math inline">\(L\)</span>, and the regularization hyperparameter <span class="math inline">\(\lambda\)</span>.</p>
<p>The <code>nnetar</code> function in the <code>forecast</code> package for R fits a feed-forward neural networks model with a single hidden layer and lagged inputs for forecasting univariate time series. It uses lagged values of the time series as inputs (and possibly some other exogenous inputs).</p>
<p>To use the <code>forecast</code> package, it is better to store the time series as a <code>ts</code> object in R. Let us consider the time series of daily new death counts for Florida, and we first turn this into a <code>ts</code> object using the <code>ts</code> function. There is a “frequency” argument in the <code>ts()</code> function, which needs to be set appropriately for your data. Here the “frequency” is the number of observations per “cycle.” For annual data, frequency <span class="math inline">\(=1\)</span>; for quarterly data, frequency <span class="math inline">\(=4\)</span>; for monthly data, frequency <span class="math inline">\(=12\)</span>, and for weekly data, frequency <span class="math inline">\(=52\)</span>. If the frequency of observations is greater than once per week, then there is usually more than one way of handling the frequency. For example, data with daily observations might have a weekly seasonality (frequency <span class="math inline">\(=7\)</span>) or an annual seasonality (frequency <span class="math inline">\(=365.25\)</span>). Read the online materials of <a href="https://robjhyndman.com/hyndsight/seasonal-periods/">Seasonal Periods</a> for an explanation about how to set the frequency for the seasonal period in <code>ts</code> objects. Since we have observed the 7-day cycle for this data, we can simply add a <code>frequency = 7</code> argument.</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="NN.html#cb334-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb334-2"><a href="NN.html#cb334-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(slid)</span>
<span id="cb334-3"><a href="NN.html#cb334-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(state.ts)</span>
<span id="cb334-4"><a href="NN.html#cb334-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb334-5"><a href="NN.html#cb334-5" aria-hidden="true" tabindex="-1"></a>Florida.ts <span class="ot">&lt;-</span> state.ts <span class="sc">%&gt;%</span></span>
<span id="cb334-6"><a href="NN.html#cb334-6" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(State <span class="sc">==</span> <span class="st">&quot;Florida&quot;</span>)  </span>
<span id="cb334-7"><a href="NN.html#cb334-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb334-8"><a href="NN.html#cb334-8" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">ts</span>(Florida.ts<span class="sc">$</span>Y.Death, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2020</span>,<span class="dv">1</span>), <span class="at">frequency =</span> <span class="dv">7</span>)</span></code></pre></div>
<p>Simply applying the default <code>nnetar()</code> function, we obtain feed-forward neural networks model NNAR<span class="math inline">\((21,1,11)_7\)</span>. It is based on an average of 20 networks, each of which is NNAR<span class="math inline">\((21,1,11)_7\)</span> with 254 weights.</p>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="NN.html#cb335-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb335-2"><a href="NN.html#cb335-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2020</span>)</span>
<span id="cb335-3"><a href="NN.html#cb335-3" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">nnetar</span>(y)</span>
<span id="cb335-4"><a href="NN.html#cb335-4" aria-hidden="true" tabindex="-1"></a>fit</span></code></pre></div>
<pre><code>## Series: y 
## Model:  NNAR(21,1,11)[7] 
## Call:   nnetar(y = y)
## 
## Average of 20 networks, each of which is
## a 21-11-1 network with 254 weights
## options were - linear output units 
## 
## sigma^2 estimated as 6.598</code></pre>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="NN.html#cb337-1" aria-hidden="true" tabindex="-1"></a>nnar.fc.report <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">forecast</span>(fit, <span class="at">h =</span> <span class="dv">14</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb337-2"><a href="NN.html#cb337-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DATE =</span> <span class="fu">as.Date</span>(<span class="st">&quot;2020-12-11&quot;</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">14</span>)</span>
<span id="cb337-3"><a href="NN.html#cb337-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(nnar.fc.report) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Y.Death&quot;</span>, <span class="st">&quot;DATE&quot;</span>)</span>
<span id="cb337-4"><a href="NN.html#cb337-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-5"><a href="NN.html#cb337-5" aria-hidden="true" tabindex="-1"></a><span class="co"># plot of reported vs NNAR predictions</span></span>
<span id="cb337-6"><a href="NN.html#cb337-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb337-7"><a href="NN.html#cb337-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> DATE, <span class="at">y =</span> Y.Death, <span class="at">color =</span> <span class="st">&quot;Reported&quot;</span>), </span>
<span id="cb337-8"><a href="NN.html#cb337-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> Florida.ts) <span class="sc">+</span></span>
<span id="cb337-9"><a href="NN.html#cb337-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> DATE, <span class="at">y =</span> Y.Death, <span class="at">color =</span> <span class="st">&quot;NNAR&quot;</span>), </span>
<span id="cb337-10"><a href="NN.html#cb337-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> nnar.fc.report) <span class="sc">+</span></span>
<span id="cb337-11"><a href="NN.html#cb337-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb337-12"><a href="NN.html#cb337-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="at">Reported =</span> <span class="st">&quot;black&quot;</span>, <span class="at">NNAR =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb337-13"><a href="NN.html#cb337-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb337-14"><a href="NN.html#cb337-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Death count&quot;</span>,</span>
<span id="cb337-15"><a href="NN.html#cb337-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Reported vs NNAR(21,1,11)[7] predictions&quot;</span>) <span class="sc">+</span></span>
<span id="cb337-16"><a href="NN.html#cb337-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">&quot;Series&quot;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:nnetar1"></span>
<img src="SLID_book_files/figure-html/nnetar1-1.png" alt="Two weeks ahead forecast of the daily new death count for Florida using nnetar." width="672" />
<p class="caption">
Figure 12.8: Two weeks ahead forecast of the daily new death count for Florida using nnetar.
</p>
</div>
<p>We can also specify the <code>repeats</code> and <code>size</code> options in the <code>nnetar</code> function.</p>
<ul>
<li><p>The <code>repeats</code> option of <code>nnetar</code> shows the number of networks (<code>default = 20</code>) to fit with different random starting weights. These networks are then averaged when producing forecasts.</p></li>
<li><p>The <code>size</code> option provides number of nodes in the hidden layer. Default is half of the number of input nodes (including external regressors, if given) plus 1.</p></li>
</ul>
<p>We can consider a Box-Cox transformation for the data. For example, if we want to restrict to positive values, we can consider a Box-Cox transformation parameter <code>lambda</code>.</p>
<p>If <code>lambda = auto</code>, then a transformation is automatically selected using <code>BoxCox.lambda</code>. The transformation is ignored if <code>NULL</code>. Otherwise, data transformed before model is estimated.</p>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="NN.html#cb338-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">nnetar</span>(y <span class="sc">+</span> <span class="dv">1</span>, <span class="at">lambda =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">5</span>)</span>
<span id="cb338-2"><a href="NN.html#cb338-2" aria-hidden="true" tabindex="-1"></a>fit</span></code></pre></div>
<pre><code>## Series: y + 1 
## Model:  NNAR(14,1,5)[7] 
## Call:   nnetar(y = y + 1, size = 5, lambda = 0)
## 
## Average of 20 networks, each of which is
## a 14-5-1 network with 81 weights
## options were - linear output units 
## 
## sigma^2 estimated as 0.2213</code></pre>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="NN.html#cb340-1" aria-hidden="true" tabindex="-1"></a>nnar.fc.report <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">forecast</span>(fit, <span class="at">h =</span> <span class="dv">14</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb340-2"><a href="NN.html#cb340-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DATE =</span> <span class="fu">as.Date</span>(<span class="st">&quot;2020-12-11&quot;</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">14</span>)</span>
<span id="cb340-3"><a href="NN.html#cb340-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(nnar.fc.report) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Y.Death&quot;</span>, <span class="st">&quot;DATE&quot;</span>)</span>
<span id="cb340-4"><a href="NN.html#cb340-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb340-5"><a href="NN.html#cb340-5" aria-hidden="true" tabindex="-1"></a><span class="co"># plot of reported vs NNAR predictions</span></span>
<span id="cb340-6"><a href="NN.html#cb340-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb340-7"><a href="NN.html#cb340-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> DATE, <span class="at">y =</span> Y.Death, <span class="at">color =</span> <span class="st">&quot;Reported&quot;</span>), </span>
<span id="cb340-8"><a href="NN.html#cb340-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> Florida.ts) <span class="sc">+</span></span>
<span id="cb340-9"><a href="NN.html#cb340-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> DATE, <span class="at">y =</span> Y.Death, <span class="at">color =</span> <span class="st">&quot;NNAR&quot;</span>), </span>
<span id="cb340-10"><a href="NN.html#cb340-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> nnar.fc.report) <span class="sc">+</span></span>
<span id="cb340-11"><a href="NN.html#cb340-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb340-12"><a href="NN.html#cb340-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="at">Reported =</span> <span class="st">&quot;black&quot;</span>, <span class="at">NNAR =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb340-13"><a href="NN.html#cb340-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb340-14"><a href="NN.html#cb340-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Death count&quot;</span>,</span>
<span id="cb340-15"><a href="NN.html#cb340-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Reported vs NNAR(14,1,5)[7] predictions&quot;</span>) <span class="sc">+</span></span>
<span id="cb340-16"><a href="NN.html#cb340-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">&quot;Series&quot;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:nnetar2"></span>
<img src="SLID_book_files/figure-html/nnetar2-1.png" alt="Two weeks ahead forecast of the daily new death count for Florida using nnetar with predictions constrained to positive values." width="672" />
<p class="caption">
Figure 12.9: Two weeks ahead forecast of the daily new death count for Florida using nnetar with predictions constrained to positive values.
</p>
</div>
<p>Note that the NNAR model is a nonlinear autogressive model, and it is not possible to analytically derive prediction intervals. Below we use the simulation method to generate simulated paths.</p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="NN.html#cb341-1" aria-hidden="true" tabindex="-1"></a>fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">PI =</span> <span class="cn">TRUE</span>, <span class="at">h =</span> <span class="dv">14</span>, <span class="at">npaths =</span> <span class="dv">500</span>)</span></code></pre></div>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="NN.html#cb342-1" aria-hidden="true" tabindex="-1"></a><span class="co">#autoplot(fcast, xlab = &quot;Days&quot;, ylab = &quot;Daily new deaths&quot;)</span></span>
<span id="cb342-2"><a href="NN.html#cb342-2" aria-hidden="true" tabindex="-1"></a>fcast.report <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(fcast) <span class="sc">%&gt;%</span></span>
<span id="cb342-3"><a href="NN.html#cb342-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DATE =</span> <span class="fu">as.Date</span>(<span class="st">&quot;2020-12-11&quot;</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">14</span>)</span>
<span id="cb342-4"><a href="NN.html#cb342-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(fcast.report) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Y.Death&quot;</span>, <span class="st">&quot;Lo.80&quot;</span>, <span class="st">&quot;Hi.80&quot;</span>, </span>
<span id="cb342-5"><a href="NN.html#cb342-5" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;Lo.95&quot;</span>, <span class="st">&quot;Hi.95&quot;</span>, <span class="st">&quot;DATE&quot;</span>) </span>
<span id="cb342-6"><a href="NN.html#cb342-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb342-7"><a href="NN.html#cb342-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Florida.ts, <span class="fu">aes</span>(DATE, Y.Death)) <span class="sc">+</span> </span>
<span id="cb342-8"><a href="NN.html#cb342-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb342-9"><a href="NN.html#cb342-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Days&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Death Count&quot;</span>) <span class="sc">+</span> </span>
<span id="cb342-10"><a href="NN.html#cb342-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add prediction intervals</span></span>
<span id="cb342-11"><a href="NN.html#cb342-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> DATE, </span>
<span id="cb342-12"><a href="NN.html#cb342-12" aria-hidden="true" tabindex="-1"></a>                            <span class="at">y =</span> Y.Death, </span>
<span id="cb342-13"><a href="NN.html#cb342-13" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ymin =</span> Lo<span class="fl">.95</span>, </span>
<span id="cb342-14"><a href="NN.html#cb342-14" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ymax =</span> Hi<span class="fl">.95</span>,</span>
<span id="cb342-15"><a href="NN.html#cb342-15" aria-hidden="true" tabindex="-1"></a>                            <span class="at">fill =</span> <span class="st">&#39;95% Prediction intervals&#39;</span>), </span>
<span id="cb342-16"><a href="NN.html#cb342-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> fcast.report, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb342-17"><a href="NN.html#cb342-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add line for predicted values</span></span>
<span id="cb342-18"><a href="NN.html#cb342-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> DATE, </span>
<span id="cb342-19"><a href="NN.html#cb342-19" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y =</span> Y.Death,</span>
<span id="cb342-20"><a href="NN.html#cb342-20" aria-hidden="true" tabindex="-1"></a>                          <span class="at">colour =</span> <span class="st">&#39;Predicted values&#39;</span>),</span>
<span id="cb342-21"><a href="NN.html#cb342-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">data =</span> fcast.report,</span>
<span id="cb342-22"><a href="NN.html#cb342-22" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Set the line type in legend</span></span>
<span id="cb342-23"><a href="NN.html#cb342-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">key_glyph =</span> <span class="st">&quot;timeseries&quot;</span>) <span class="sc">+</span> </span>
<span id="cb342-24"><a href="NN.html#cb342-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="st">&quot;&quot;</span>, <span class="at">values =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb342-25"><a href="NN.html#cb342-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">&quot;&quot;</span>, <span class="at">values =</span> <span class="st">&quot;pink&quot;</span>) <span class="sc">+</span> </span>
<span id="cb342-26"><a href="NN.html#cb342-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:nnetar3"></span>
<img src="SLID_book_files/figure-html/nnetar3-1.png" alt="Two weeks ahead forecast and prediction intervals of the daily new death count for Florida using nnetar with predictions constrained to positive values." width="672" />
<p class="caption">
Figure 12.10: Two weeks ahead forecast and prediction intervals of the daily new death count for Florida using nnetar with predictions constrained to positive values.
</p>
</div>
<p>Because it is a little slow, <code>PI = FALSE</code> is the default, so prediction intervals are not computed unless requested. The <code>npaths</code> argument in <code>forecast.nnetar</code> controls how many simulations are done (default 1000). By default, the errors are drawn from a normal distribution. The bootstrap argument allows the errors to be “bootstrapped” (i.e., randomly drawn from the historical errors).</p>
</div>
<div id="exercises-7" class="section level2" number="12.6">
<h2><span class="header-section-number">12.6</span> Exercises</h2>
<ol style="list-style-type: decimal">
<li>Based on the input values and weights given in Figure <a href="NN.html#fig:NNE1">12.11</a>, find the values of <span class="math inline">\(a_1^{(2)}\)</span>, <span class="math inline">\(a_2^{(2)}\)</span> and <span class="math inline">\(a_1^{(3)}\)</span>. Use the sigmoid activation function.</li>
</ol>
<div class="figure" style="text-align: center"><span id="fig:NNE1"></span>
<img src="figures/NNE1.png" alt="An example of neural network with one hidden layer." width="60%" />
<p class="caption">
Figure 12.11: An example of neural network with one hidden layer.
</p>
</div>
<ol start="2" style="list-style-type: decimal">
<li>From <code>state.long</code> in the R package <code>slid</code>, choose a state and focus on the daily new death count.</li>
</ol>
<ol style="list-style-type: lower-alpha">
<li><p>Apply the <code>nnetar</code> to your time series directly and report the fitted model.</p></li>
<li><p>Based on the model in Part a, make a 7-day ahead forecast, and provide the 95% prediction intervals.</p></li>
<li><p>Apply the <code>nnetar</code> to the log-transformed time series and report the fitted model.</p></li>
<li><p>Based on the model in Part c, make a 7-day ahead forecast, and provide the 95% prediction intervals.</p></li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ensemble.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["SLID_book.pdf", "SLID_book.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
