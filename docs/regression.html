<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 11 Regression Methods | Statistical Learning of Infectious Disease Data Analytics</title>
  <meta name="description" content="The use of statistical models to understand infectious disease dynamics has a very rich history in epidemiology. This book introduces modern statistical models and state-of-the-art learning methods to analyze infectious disease data. Many of the key approaches, examples and case studies will be presented. The primary emphasis will be interpretation, inference and hands-on data analyses. This course also provides practical concepts and R computing skills to perform infectious disease data analysis and visualization." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 11 Regression Methods | Statistical Learning of Infectious Disease Data Analytics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="The use of statistical models to understand infectious disease dynamics has a very rich history in epidemiology. This book introduces modern statistical models and state-of-the-art learning methods to analyze infectious disease data. Many of the key approaches, examples and case studies will be presented. The primary emphasis will be interpretation, inference and hands-on data analyses. This course also provides practical concepts and R computing skills to perform infectious disease data analysis and visualization." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 11 Regression Methods | Statistical Learning of Infectious Disease Data Analytics" />
  
  <meta name="twitter:description" content="The use of statistical models to understand infectious disease dynamics has a very rich history in epidemiology. This book introduces modern statistical models and state-of-the-art learning methods to analyze infectious disease data. Many of the key approaches, examples and case studies will be presented. The primary emphasis will be interpretation, inference and hands-on data analyses. This course also provides practical concepts and R computing skills to perform infectious disease data analysis and visualization." />
  

<meta name="author" content="Lily Wang" />


<meta name="date" content="2021-04-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="timeseries.html"/>
<link rel="next" href="NN.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.3.9000/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#data-sets-used-in-labs-and-exercises"><i class="fa fa-check"></i><b>1.1</b> Data Sets Used in Labs and Exercises</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>1.2</b> Acknowledgements</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#about-the-author"><i class="fa fa-check"></i><b>1.3</b> About the Author</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#aims-and-scope-of-this-book"><i class="fa fa-check"></i><b>2.1</b> Aims and Scope of This Book</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#the-structure-of-this-book"><i class="fa fa-check"></i><b>2.2</b> The Structure of This Book</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="intro.html"><a href="intro.html#infectious-disease-data"><i class="fa fa-check"></i><b>2.2.1</b> Infectious disease data</a></li>
<li class="chapter" data-level="2.2.2" data-path="intro.html"><a href="intro.html#basic-characteristics-of-the-infection-process"><i class="fa fa-check"></i><b>2.2.2</b> Basic characteristics of the infection process</a></li>
<li class="chapter" data-level="2.2.3" data-path="intro.html"><a href="intro.html#data-visualization"><i class="fa fa-check"></i><b>2.2.3</b> Data visualization</a></li>
<li class="chapter" data-level="2.2.4" data-path="intro.html"><a href="intro.html#modeling-and-forecasting"><i class="fa fa-check"></i><b>2.2.4</b> Modeling and Forecasting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="dplyr.html"><a href="dplyr.html"><i class="fa fa-check"></i><b>3</b> Data Wrangling with <code>dplyr</code> and <code>tidyr</code></a>
<ul>
<li class="chapter" data-level="3.1" data-path="dplyr.html"><a href="dplyr.html#learning-dplyr"><i class="fa fa-check"></i><b>3.1</b> Learning <code>dplyr</code></a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="dplyr.html"><a href="dplyr.html#tibbles"><i class="fa fa-check"></i><b>3.1.1</b> Tibbles</a></li>
<li class="chapter" data-level="3.1.2" data-path="dplyr.html"><a href="dplyr.html#import-data"><i class="fa fa-check"></i><b>3.1.2</b> Import data</a></li>
<li class="chapter" data-level="3.1.3" data-path="dplyr.html"><a href="dplyr.html#common-dplyr-functions"><i class="fa fa-check"></i><b>3.1.3</b> Common <code>dplyr</code> functions</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="dplyr.html"><a href="dplyr.html#selecting-columns-and-filtering-rows"><i class="fa fa-check"></i><b>3.2</b> Selecting Columns and Filtering Rows</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="dplyr.html"><a href="dplyr.html#subset-variables-columns"><i class="fa fa-check"></i><b>3.2.1</b> Subset Variables (Columns)</a></li>
<li class="chapter" data-level="3.2.2" data-path="dplyr.html"><a href="dplyr.html#subset-observations-rows"><i class="fa fa-check"></i><b>3.2.2</b> Subset Observations (Rows)</a></li>
<li class="chapter" data-level="3.2.3" data-path="dplyr.html"><a href="dplyr.html#pipes"><i class="fa fa-check"></i><b>3.2.3</b> Pipes</a></li>
<li class="chapter" data-level="3.2.4" data-path="dplyr.html"><a href="dplyr.html#select-and-order-top-n-entries-by-group-if-grouped-data."><i class="fa fa-check"></i><b>3.2.4</b> Select and order top n entries (by group if grouped data).</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="dplyr.html"><a href="dplyr.html#make-new-variables-mutate"><i class="fa fa-check"></i><b>3.3</b> Make New Variables: Mutate</a></li>
<li class="chapter" data-level="3.4" data-path="dplyr.html"><a href="dplyr.html#summarize-data"><i class="fa fa-check"></i><b>3.4</b> Summarize Data</a></li>
<li class="chapter" data-level="3.5" data-path="dplyr.html"><a href="dplyr.html#combine-data-sets"><i class="fa fa-check"></i><b>3.5</b> Combine Data Sets</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="dplyr.html"><a href="dplyr.html#the-join-family"><i class="fa fa-check"></i><b>3.5.1</b> The join family</a></li>
<li class="chapter" data-level="3.5.2" data-path="dplyr.html"><a href="dplyr.html#toy-examples-with-joins"><i class="fa fa-check"></i><b>3.5.2</b> Toy examples with joins</a></li>
<li class="chapter" data-level="3.5.3" data-path="dplyr.html"><a href="dplyr.html#practice-with-joins-for-real-data"><i class="fa fa-check"></i><b>3.5.3</b> Practice with joins for real data</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="dplyr.html"><a href="dplyr.html#reshaping-data"><i class="fa fa-check"></i><b>3.6</b> Reshaping Data</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="dplyr.html"><a href="dplyr.html#from-wide-to-long"><i class="fa fa-check"></i><b>3.6.1</b> From wide to long</a></li>
<li class="chapter" data-level="3.6.2" data-path="dplyr.html"><a href="dplyr.html#from-long-to-wide"><i class="fa fa-check"></i><b>3.6.2</b> From long to wide</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="dplyr.html"><a href="dplyr.html#exercises"><i class="fa fa-check"></i><b>3.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>4</b> Data Visualization with ggplot2</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ggplot2.html"><a href="ggplot2.html#introduction"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="ggplot2.html"><a href="ggplot2.html#types-of-variables-and-preparation"><i class="fa fa-check"></i><b>4.2</b> Types of Variables and Preparation</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="ggplot2.html"><a href="ggplot2.html#types-of-variables"><i class="fa fa-check"></i><b>4.2.1</b> Types of Variables</a></li>
<li class="chapter" data-level="4.2.2" data-path="ggplot2.html"><a href="ggplot2.html#rules-for-graph-designing"><i class="fa fa-check"></i><b>4.2.2</b> Rules for Graph Designing</a></li>
<li class="chapter" data-level="4.2.3" data-path="ggplot2.html"><a href="ggplot2.html#installing-packages-and-loading-data"><i class="fa fa-check"></i><b>4.2.3</b> Installing packages and loading data</a></li>
<li class="chapter" data-level="4.2.4" data-path="ggplot2.html"><a href="ggplot2.html#your-first-scatterplot"><i class="fa fa-check"></i><b>4.2.4</b> Your first scatterplot</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="ggplot2.html"><a href="ggplot2.html#position-scales-and-axes"><i class="fa fa-check"></i><b>4.3</b> Position Scales and Axes</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="ggplot2.html"><a href="ggplot2.html#change-the-labels-of-the-axis-using-xlab-and-ylab"><i class="fa fa-check"></i><b>4.3.1</b> Change the labels of the axis using <code>xlab()</code> and <code>ylab()</code></a></li>
<li class="chapter" data-level="4.3.2" data-path="ggplot2.html"><a href="ggplot2.html#change-the-range-of-the-axis-using-xlim-and-ylim"><i class="fa fa-check"></i><b>4.3.2</b> Change the range of the axis using <code>xlim()</code> and <code>ylim()</code></a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="ggplot2.html"><a href="ggplot2.html#color-scales-and-size-of-geom_points"><i class="fa fa-check"></i><b>4.4</b> Color Scales and Size of <code>geom_points()</code></a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="ggplot2.html"><a href="ggplot2.html#change-the-color-of-all-points"><i class="fa fa-check"></i><b>4.4.1</b> Change the color of all points</a></li>
<li class="chapter" data-level="4.4.2" data-path="ggplot2.html"><a href="ggplot2.html#color-the-observations-by-the-value-of-a-feature"><i class="fa fa-check"></i><b>4.4.2</b> Color the observations by the value of a feature</a></li>
<li class="chapter" data-level="4.4.3" data-path="ggplot2.html"><a href="ggplot2.html#change-the-color-palette"><i class="fa fa-check"></i><b>4.4.3</b> Change the color palette</a></li>
<li class="chapter" data-level="4.4.4" data-path="ggplot2.html"><a href="ggplot2.html#change-the-size-by-the-value-of-a-feature"><i class="fa fa-check"></i><b>4.4.4</b> Change the size by the value of a feature</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="ggplot2.html"><a href="ggplot2.html#individual-geoms"><i class="fa fa-check"></i><b>4.5</b> Individual geoms</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="ggplot2.html"><a href="ggplot2.html#histogram"><i class="fa fa-check"></i><b>4.5.1</b> Histogram</a></li>
<li class="chapter" data-level="4.5.2" data-path="ggplot2.html"><a href="ggplot2.html#bar-chart"><i class="fa fa-check"></i><b>4.5.2</b> Bar chart</a></li>
<li class="chapter" data-level="4.5.3" data-path="ggplot2.html"><a href="ggplot2.html#default-bar-chart"><i class="fa fa-check"></i><b>4.5.3</b> Default bar chart</a></li>
<li class="chapter" data-level="4.5.4" data-path="ggplot2.html"><a href="ggplot2.html#bar-chart-with-assigned-value"><i class="fa fa-check"></i><b>4.5.4</b> Bar chart with assigned value</a></li>
<li class="chapter" data-level="4.5.5" data-path="ggplot2.html"><a href="ggplot2.html#legend"><i class="fa fa-check"></i><b>4.5.5</b> Legend</a></li>
<li class="chapter" data-level="4.5.6" data-path="ggplot2.html"><a href="ggplot2.html#boxplots-jittering-and-violin-plots"><i class="fa fa-check"></i><b>4.5.6</b> Boxplots, jittering and violin plots</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="ggplot2.html"><a href="ggplot2.html#collective-geoms"><i class="fa fa-check"></i><b>4.6</b> Collective geoms</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="ggplot2.html"><a href="ggplot2.html#smoother"><i class="fa fa-check"></i><b>4.6.1</b> Smoother</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="ggplot2.html"><a href="ggplot2.html#time-series"><i class="fa fa-check"></i><b>4.7</b> Time Series</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="ggplot2.html"><a href="ggplot2.html#basic-line-plots"><i class="fa fa-check"></i><b>4.7.1</b> Basic line plots</a></li>
<li class="chapter" data-level="4.7.2" data-path="ggplot2.html"><a href="ggplot2.html#add-a-second-line"><i class="fa fa-check"></i><b>4.7.2</b> Add a second line</a></li>
<li class="chapter" data-level="4.7.3" data-path="ggplot2.html"><a href="ggplot2.html#add-ribbons"><i class="fa fa-check"></i><b>4.7.3</b> Add ribbons</a></li>
<li class="chapter" data-level="4.7.4" data-path="ggplot2.html"><a href="ggplot2.html#adjust-the-scale-of-time-axis"><i class="fa fa-check"></i><b>4.7.4</b> Adjust the scale of time axis</a></li>
<li class="chapter" data-level="4.7.5" data-path="ggplot2.html"><a href="ggplot2.html#add-annotations"><i class="fa fa-check"></i><b>4.7.5</b> Add annotations</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="ggplot2.html"><a href="ggplot2.html#maps"><i class="fa fa-check"></i><b>4.8</b> Maps</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="ggplot2.html"><a href="ggplot2.html#making-a-base-map"><i class="fa fa-check"></i><b>4.8.1</b> Making a base map</a></li>
<li class="chapter" data-level="4.8.2" data-path="ggplot2.html"><a href="ggplot2.html#customizing-choropleth-map"><i class="fa fa-check"></i><b>4.8.2</b> Customizing <code>choropleth</code> map</a></li>
<li class="chapter" data-level="4.8.3" data-path="ggplot2.html"><a href="ggplot2.html#overlay-polygon-maps"><i class="fa fa-check"></i><b>4.8.3</b> Overlay polygon maps</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="ggplot2.html"><a href="ggplot2.html#arranging-plots"><i class="fa fa-check"></i><b>4.9</b> Arranging Plots</a>
<ul>
<li class="chapter" data-level="4.9.1" data-path="ggplot2.html"><a href="ggplot2.html#facet"><i class="fa fa-check"></i><b>4.9.1</b> Facet</a></li>
<li class="chapter" data-level="4.9.2" data-path="ggplot2.html"><a href="ggplot2.html#combining-plots-using-patchwork-package"><i class="fa fa-check"></i><b>4.9.2</b> Combining plots using <code>patchwork</code> package</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="ggplot2.html"><a href="ggplot2.html#output"><i class="fa fa-check"></i><b>4.10</b> Output</a>
<ul>
<li class="chapter" data-level="4.10.1" data-path="ggplot2.html"><a href="ggplot2.html#save-in-figure-format"><i class="fa fa-check"></i><b>4.10.1</b> Save in figure format</a></li>
<li class="chapter" data-level="4.10.2" data-path="ggplot2.html"><a href="ggplot2.html#save-in-rds-format"><i class="fa fa-check"></i><b>4.10.2</b> Save in RDS format</a></li>
</ul></li>
<li class="chapter" data-level="4.11" data-path="ggplot2.html"><a href="ggplot2.html#exercises-1"><i class="fa fa-check"></i><b>4.11</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="plotly.html"><a href="plotly.html"><i class="fa fa-check"></i><b>5</b> Interactive Visualization</a>
<ul>
<li class="chapter" data-level="5.1" data-path="plotly.html"><a href="plotly.html#an-introduction"><i class="fa fa-check"></i><b>5.1</b> An Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="plotly.html"><a href="plotly.html#creating-plotly-objects"><i class="fa fa-check"></i><b>5.2</b> Creating Plotly Objects</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="plotly.html"><a href="plotly.html#using-plot_ly-to-create-a-plotly-object"><i class="fa fa-check"></i><b>5.2.1</b> Using <code>plot_ly()</code> to create a plotly object</a></li>
<li class="chapter" data-level="5.2.2" data-path="plotly.html"><a href="plotly.html#use-dplyr-verbs-to-modify-data"><i class="fa fa-check"></i><b>5.2.2</b> Use <code>dplyr</code> verbs to modify data</a></li>
<li class="chapter" data-level="5.2.3" data-path="plotly.html"><a href="plotly.html#using-ggplotly-to-create-a-plotly-object"><i class="fa fa-check"></i><b>5.2.3</b> Using <code>ggplotly()</code> to create a <code>plotly</code> object</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="plotly.html"><a href="plotly.html#scatterplots-and-line-plots"><i class="fa fa-check"></i><b>5.3</b> Scatterplots and Line Plots</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="plotly.html"><a href="plotly.html#make-a-scatterplot"><i class="fa fa-check"></i><b>5.3.1</b> Make a scatterplot</a></li>
<li class="chapter" data-level="5.3.2" data-path="plotly.html"><a href="plotly.html#markers"><i class="fa fa-check"></i><b>5.3.2</b> Markers</a></li>
<li class="chapter" data-level="5.3.3" data-path="plotly.html"><a href="plotly.html#a-single-time-series-plot"><i class="fa fa-check"></i><b>5.3.3</b> A single time series plot</a></li>
<li class="chapter" data-level="5.3.4" data-path="plotly.html"><a href="plotly.html#hover-text-and-template"><i class="fa fa-check"></i><b>5.3.4</b> Hover text and template</a></li>
<li class="chapter" data-level="5.3.5" data-path="plotly.html"><a href="plotly.html#multiple-time-series-plots"><i class="fa fa-check"></i><b>5.3.5</b> Multiple time series plots</a></li>
<li class="chapter" data-level="5.3.6" data-path="plotly.html"><a href="plotly.html#more-features-about-the-lines"><i class="fa fa-check"></i><b>5.3.6</b> More features about the lines</a></li>
<li class="chapter" data-level="5.3.7" data-path="plotly.html"><a href="plotly.html#add-ribbons-1"><i class="fa fa-check"></i><b>5.3.7</b> Add ribbons</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="plotly.html"><a href="plotly.html#pie-charts"><i class="fa fa-check"></i><b>5.4</b> Pie Charts</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="plotly.html"><a href="plotly.html#draw-static-pie-charts-using-ggplot2"><i class="fa fa-check"></i><b>5.4.1</b> Draw static pie charts using ggplot2</a></li>
<li class="chapter" data-level="5.4.2" data-path="plotly.html"><a href="plotly.html#draw-interactive-pie-charts"><i class="fa fa-check"></i><b>5.4.2</b> Draw interactive pie charts</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="plotly.html"><a href="plotly.html#animation"><i class="fa fa-check"></i><b>5.5</b> Animation</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="plotly.html"><a href="plotly.html#an-animation-of-the-evolution-of-infected-vs.-death-count"><i class="fa fa-check"></i><b>5.5.1</b> An animation of the evolution of infected vs. death count</a></li>
<li class="chapter" data-level="5.5.2" data-path="plotly.html"><a href="plotly.html#an-animation-of-the-state-level-time-series-plot-of-infected-count"><i class="fa fa-check"></i><b>5.5.2</b> An animation of the state-level time series plot of infected count</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="plotly.html"><a href="plotly.html#saving-html"><i class="fa fa-check"></i><b>5.6</b> Saving HTML</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="plotly.html"><a href="plotly.html#save-as-a-standalone-html-file"><i class="fa fa-check"></i><b>5.6.1</b> Save as a standalone HTML file</a></li>
<li class="chapter" data-level="5.6.2" data-path="plotly.html"><a href="plotly.html#save-as-non-selfcontained-html-file"><i class="fa fa-check"></i><b>5.6.2</b> Save as non-selfcontained HTML file</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="plotly.html"><a href="plotly.html#exercises-2"><i class="fa fa-check"></i><b>5.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="shiny.html"><a href="shiny.html"><i class="fa fa-check"></i><b>6</b> R Shiny</a>
<ul>
<li class="chapter" data-level="6.1" data-path="shiny.html"><a href="shiny.html#an-introduction-to-shiny"><i class="fa fa-check"></i><b>6.1</b> An Introduction to Shiny</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="shiny.html"><a href="shiny.html#your-first-shiny-app"><i class="fa fa-check"></i><b>6.1.1</b> Your first shiny app</a></li>
<li class="chapter" data-level="6.1.2" data-path="shiny.html"><a href="shiny.html#create-a-new-shiny-app-in-rstudio"><i class="fa fa-check"></i><b>6.1.2</b> Create a new shiny app in RStudio</a></li>
<li class="chapter" data-level="6.1.3" data-path="shiny.html"><a href="shiny.html#share-your-app"><i class="fa fa-check"></i><b>6.1.3</b> Share your app</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="shiny.html"><a href="shiny.html#useful-input-widgets"><i class="fa fa-check"></i><b>6.2</b> Useful Input Widgets</a></li>
<li class="chapter" data-level="6.3" data-path="shiny.html"><a href="shiny.html#displaying-reactive-output"><i class="fa fa-check"></i><b>6.3</b> Displaying Reactive Output</a></li>
<li class="chapter" data-level="6.4" data-path="shiny.html"><a href="shiny.html#rendering-plotly-inside-shiny"><i class="fa fa-check"></i><b>6.4</b> Rendering Plotly Inside Shiny</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="map.html"><a href="map.html"><i class="fa fa-check"></i><b>7</b> Interactive Geospatial Visualization</a>
<ul>
<li class="chapter" data-level="7.1" data-path="map.html"><a href="map.html#an-introduction-to-leaflet"><i class="fa fa-check"></i><b>7.1</b> An Introduction to Leaflet</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="map.html"><a href="map.html#more-references"><i class="fa fa-check"></i><b>7.1.1</b> More References</a></li>
<li class="chapter" data-level="7.1.2" data-path="map.html"><a href="map.html#features-and-installation"><i class="fa fa-check"></i><b>7.1.2</b> Features and installation</a></li>
<li class="chapter" data-level="7.1.3" data-path="map.html"><a href="map.html#basic-usage"><i class="fa fa-check"></i><b>7.1.3</b> Basic Usage</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="map.html"><a href="map.html#the-data-object"><i class="fa fa-check"></i><b>7.2</b> The Data Object</a></li>
<li class="chapter" data-level="7.3" data-path="map.html"><a href="map.html#choropleth-map"><i class="fa fa-check"></i><b>7.3</b> Choropleth map</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="map.html"><a href="map.html#create-a-base-map"><i class="fa fa-check"></i><b>7.3.1</b> Create a base map</a></li>
<li class="chapter" data-level="7.3.2" data-path="map.html"><a href="map.html#color-the-map"><i class="fa fa-check"></i><b>7.3.2</b> Color the map</a></li>
<li class="chapter" data-level="7.3.3" data-path="map.html"><a href="map.html#interactive-map"><i class="fa fa-check"></i><b>7.3.3</b> Interactive map</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="map.html"><a href="map.html#legend-1"><i class="fa fa-check"></i><b>7.4</b> Legend</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="map.html"><a href="map.html#classification-schemes"><i class="fa fa-check"></i><b>7.4.1</b> Classification schemes</a></li>
<li class="chapter" data-level="7.4.2" data-path="map.html"><a href="map.html#mapping-variables-to-colors"><i class="fa fa-check"></i><b>7.4.2</b> Mapping variables to colors</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="map.html"><a href="map.html#an-example-of-county-level-map"><i class="fa fa-check"></i><b>7.5</b> An Example of County-level Map</a></li>
<li class="chapter" data-level="7.6" data-path="map.html"><a href="map.html#spot-maps"><i class="fa fa-check"></i><b>7.6</b> Spot Maps</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="map.html"><a href="map.html#adding-circles"><i class="fa fa-check"></i><b>7.6.1</b> Adding circles</a></li>
<li class="chapter" data-level="7.6.2" data-path="map.html"><a href="map.html#add-popups"><i class="fa fa-check"></i><b>7.6.2</b> Add popups</a></li>
<li class="chapter" data-level="7.6.3" data-path="map.html"><a href="map.html#add-labels"><i class="fa fa-check"></i><b>7.6.3</b> Add labels</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="map.html"><a href="map.html#integrating-leaflet-with-r-shiny"><i class="fa fa-check"></i><b>7.7</b> Integrating Leaflet with R Shiny</a></li>
<li class="chapter" data-level="7.8" data-path="map.html"><a href="map.html#exercises-3"><i class="fa fa-check"></i><b>7.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="modeling.html"><a href="modeling.html"><i class="fa fa-check"></i><b>8</b> Epidemic Modeling</a>
<ul>
<li class="chapter" data-level="8.1" data-path="modeling.html"><a href="modeling.html#an-introduction-to-epidemic-modeling"><i class="fa fa-check"></i><b>8.1</b> An Introduction to Epidemic Modeling</a></li>
<li class="chapter" data-level="8.2" data-path="modeling.html"><a href="modeling.html#mechanistic-models"><i class="fa fa-check"></i><b>8.2</b> Mechanistic Models</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="modeling.html"><a href="modeling.html#compartment-modeling"><i class="fa fa-check"></i><b>8.2.1</b> Compartment Modeling</a></li>
<li class="chapter" data-level="8.2.2" data-path="modeling.html"><a href="modeling.html#agent-based-methods"><i class="fa fa-check"></i><b>8.2.2</b> Agent-based Methods</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="modeling.html"><a href="modeling.html#phenomenological-models"><i class="fa fa-check"></i><b>8.3</b> Phenomenological Models</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="modeling.html"><a href="modeling.html#time-series-analysis"><i class="fa fa-check"></i><b>8.3.1</b> Time Series Analysis</a></li>
<li class="chapter" data-level="8.3.2" data-path="modeling.html"><a href="modeling.html#regression-methods"><i class="fa fa-check"></i><b>8.3.2</b> Regression methods</a></li>
<li class="chapter" data-level="8.3.3" data-path="modeling.html"><a href="modeling.html#machine-learning-methods"><i class="fa fa-check"></i><b>8.3.3</b> Machine learning methods</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="modeling.html"><a href="modeling.html#hybrid-models-and-ensemble-methods"><i class="fa fa-check"></i><b>8.4</b> Hybrid Models and Ensemble Methods</a></li>
<li class="chapter" data-level="8.5" data-path="modeling.html"><a href="modeling.html#epidemic-modeling-mathematical-and-statistical-perspectives"><i class="fa fa-check"></i><b>8.5</b> Epidemic Modeling: Mathematical and Statistical Perspectives</a></li>
<li class="chapter" data-level="8.6" data-path="modeling.html"><a href="modeling.html#some-terminologies-in-epidemic-modeling"><i class="fa fa-check"></i><b>8.6</b> Some Terminologies in Epidemic Modeling</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="compartment.html"><a href="compartment.html"><i class="fa fa-check"></i><b>9</b> Compartment Models</a>
<ul>
<li class="chapter" data-level="9.1" data-path="compartment.html"><a href="compartment.html#a-simple-sis-model-a-model-for-diseases-with-no-immunity"><i class="fa fa-check"></i><b>9.1</b> A Simple SIS Model (A Model for Diseases with No Immunity)</a></li>
<li class="chapter" data-level="9.2" data-path="compartment.html"><a href="compartment.html#an-sir-model"><i class="fa fa-check"></i><b>9.2</b> An SIR Model</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="compartment.html"><a href="compartment.html#an-sir-model-with-births-and-deaths"><i class="fa fa-check"></i><b>9.2.1</b> An SIR model with births and deaths</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="compartment.html"><a href="compartment.html#sir-parameter-estimation"><i class="fa fa-check"></i><b>9.3</b> SIR parameter estimation</a></li>
<li class="chapter" data-level="9.4" data-path="compartment.html"><a href="compartment.html#implementation-of-parameter-estimation-in-r"><i class="fa fa-check"></i><b>9.4</b> Implementation of parameter estimation in R</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="compartment.html"><a href="compartment.html#example-1.-outbreak-of-measles-in-niamey"><i class="fa fa-check"></i><b>9.4.1</b> Example 1. Outbreak of measles in Niamey</a></li>
<li class="chapter" data-level="9.4.2" data-path="compartment.html"><a href="compartment.html#example-2.-covid-19"><i class="fa fa-check"></i><b>9.4.2</b> Example 2. COVID-19</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="compartment.html"><a href="compartment.html#basic-reproduction-number"><i class="fa fa-check"></i><b>9.5</b> Basic Reproduction Number</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="compartment.html"><a href="compartment.html#seir-model"><i class="fa fa-check"></i><b>9.5.1</b> SEIR Model</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="compartment.html"><a href="compartment.html#herd-immunity"><i class="fa fa-check"></i><b>9.6</b> Herd Immunity</a></li>
<li class="chapter" data-level="9.7" data-path="compartment.html"><a href="compartment.html#exercises-4"><i class="fa fa-check"></i><b>9.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="timeseries.html"><a href="timeseries.html"><i class="fa fa-check"></i><b>10</b> Time Series Analysis of Infectious Disease Data</a>
<ul>
<li class="chapter" data-level="10.1" data-path="timeseries.html"><a href="timeseries.html#datasets-and-r-packages"><i class="fa fa-check"></i><b>10.1</b> Datasets and R Packages</a></li>
<li class="chapter" data-level="10.2" data-path="timeseries.html"><a href="timeseries.html#an-introduction-to-time-series-analysis"><i class="fa fa-check"></i><b>10.2</b> An Introduction to Time Series Analysis</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="timeseries.html"><a href="timeseries.html#tsibble-objects"><i class="fa fa-check"></i><b>10.2.1</b> “tsibble” objects</a></li>
<li class="chapter" data-level="10.2.2" data-path="timeseries.html"><a href="timeseries.html#working-with-tsibble-objects"><i class="fa fa-check"></i><b>10.2.2</b> Working with “tsibble” objects</a></li>
<li class="chapter" data-level="10.2.3" data-path="timeseries.html"><a href="timeseries.html#drawing-time-series-plots"><i class="fa fa-check"></i><b>10.2.3</b> Drawing time series plots</a></li>
<li class="chapter" data-level="10.2.4" data-path="timeseries.html"><a href="timeseries.html#objectives-of-time-series-analysis"><i class="fa fa-check"></i><b>10.2.4</b> Objectives of Time Series Analysis</a></li>
<li class="chapter" data-level="10.2.5" data-path="timeseries.html"><a href="timeseries.html#stationarity"><i class="fa fa-check"></i><b>10.2.5</b> Stationarity</a></li>
<li class="chapter" data-level="10.2.6" data-path="timeseries.html"><a href="timeseries.html#autocorrelation"><i class="fa fa-check"></i><b>10.2.6</b> Autocorrelation</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="timeseries.html"><a href="timeseries.html#time-series-decomposition"><i class="fa fa-check"></i><b>10.3</b> Time Series Decomposition</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="timeseries.html"><a href="timeseries.html#box-cox-transformations"><i class="fa fa-check"></i><b>10.3.1</b> Box-Cox transformations</a></li>
<li class="chapter" data-level="10.3.2" data-path="timeseries.html"><a href="timeseries.html#methods-for-estimating-the-trend"><i class="fa fa-check"></i><b>10.3.2</b> Methods for estimating the trend</a></li>
<li class="chapter" data-level="10.3.3" data-path="timeseries.html"><a href="timeseries.html#seasonal-component"><i class="fa fa-check"></i><b>10.3.3</b> Seasonal component</a></li>
<li class="chapter" data-level="10.3.4" data-path="timeseries.html"><a href="timeseries.html#trend-and-seasonal-estimation"><i class="fa fa-check"></i><b>10.3.4</b> Trend and seasonal estimation:</a></li>
<li class="chapter" data-level="10.3.5" data-path="timeseries.html"><a href="timeseries.html#seasonal-and-trend-decomposition-using-loess-stl"><i class="fa fa-check"></i><b>10.3.5</b> Seasonal and trend decomposition using Loess (STL)</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="timeseries.html"><a href="timeseries.html#simple-time-series-forecasting-approaches"><i class="fa fa-check"></i><b>10.4</b> Simple Time Series Forecasting Approaches</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="timeseries.html"><a href="timeseries.html#average-method"><i class="fa fa-check"></i><b>10.4.1</b> Average method</a></li>
<li class="chapter" data-level="10.4.2" data-path="timeseries.html"><a href="timeseries.html#random-walk-forecasts"><i class="fa fa-check"></i><b>10.4.2</b> Random walk forecasts</a></li>
<li class="chapter" data-level="10.4.3" data-path="timeseries.html"><a href="timeseries.html#seasonal-random-walk-forecasts"><i class="fa fa-check"></i><b>10.4.3</b> Seasonal random walk forecasts</a></li>
<li class="chapter" data-level="10.4.4" data-path="timeseries.html"><a href="timeseries.html#random-walk-with-drift-method"><i class="fa fa-check"></i><b>10.4.4</b> Random walk with drift method</a></li>
<li class="chapter" data-level="10.4.5" data-path="timeseries.html"><a href="timeseries.html#displaying-all-the-forecasting-results"><i class="fa fa-check"></i><b>10.4.5</b> Displaying all the forecasting results</a></li>
<li class="chapter" data-level="10.4.6" data-path="timeseries.html"><a href="timeseries.html#distributional-forecasts-and-prediction-intervals"><i class="fa fa-check"></i><b>10.4.6</b> Distributional forecasts and prediction intervals</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="timeseries.html"><a href="timeseries.html#residual-diagnostics-and-accuracy-evaluation"><i class="fa fa-check"></i><b>10.5</b> Residual Diagnostics and Accuracy Evaluation</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="timeseries.html"><a href="timeseries.html#residual-diagnostics"><i class="fa fa-check"></i><b>10.5.1</b> Residual diagnostics</a></li>
<li class="chapter" data-level="10.5.2" data-path="timeseries.html"><a href="timeseries.html#forecasting-accuracy"><i class="fa fa-check"></i><b>10.5.2</b> Forecasting accuracy</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="timeseries.html"><a href="timeseries.html#arima-models"><i class="fa fa-check"></i><b>10.6</b> ARIMA Models</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="timeseries.html"><a href="timeseries.html#differencing"><i class="fa fa-check"></i><b>10.6.1</b> Differencing</a></li>
<li class="chapter" data-level="10.6.2" data-path="timeseries.html"><a href="timeseries.html#arma-models"><i class="fa fa-check"></i><b>10.6.2</b> ARMA models</a></li>
<li class="chapter" data-level="10.6.3" data-path="timeseries.html"><a href="timeseries.html#simple-examples-of-arma-models"><i class="fa fa-check"></i><b>10.6.3</b> Simple examples of ARMA models</a></li>
<li class="chapter" data-level="10.6.4" data-path="timeseries.html"><a href="timeseries.html#arima-models-1"><i class="fa fa-check"></i><b>10.6.4</b> ARIMA models</a></li>
<li class="chapter" data-level="10.6.5" data-path="timeseries.html"><a href="timeseries.html#seasonal-arima-sarima-model"><i class="fa fa-check"></i><b>10.6.5</b> Seasonal ARIMA (SARIMA) model</a></li>
<li class="chapter" data-level="10.6.6" data-path="timeseries.html"><a href="timeseries.html#building-sarima-models"><i class="fa fa-check"></i><b>10.6.6</b> Building SARIMA Models</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="timeseries.html"><a href="timeseries.html#model-comparison"><i class="fa fa-check"></i><b>10.7</b> Model Comparison</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="timeseries.html"><a href="timeseries.html#exponential-smoothing-and-arima-models"><i class="fa fa-check"></i><b>10.7.1</b> Exponential smoothing and ARIMA models</a></li>
<li class="chapter" data-level="10.7.2" data-path="timeseries.html"><a href="timeseries.html#cross-validation-for-time-series-analysis"><i class="fa fa-check"></i><b>10.7.2</b> Cross-validation for Time series analysis</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="timeseries.html"><a href="timeseries.html#ensuring-forecasts-stay-within-limits"><i class="fa fa-check"></i><b>10.8</b> Ensuring Forecasts Stay Within Limits</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="timeseries.html"><a href="timeseries.html#positive-forecasts"><i class="fa fa-check"></i><b>10.8.1</b> Positive forecasts</a></li>
<li class="chapter" data-level="10.8.2" data-path="timeseries.html"><a href="timeseries.html#forecasts-constrained-to-an-interval"><i class="fa fa-check"></i><b>10.8.2</b> Forecasts constrained to an interval</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="timeseries.html"><a href="timeseries.html#prediction-and-prediction-intervals-for-aggregates"><i class="fa fa-check"></i><b>10.9</b> Prediction and Prediction Intervals for Aggregates</a></li>
<li class="chapter" data-level="10.10" data-path="timeseries.html"><a href="timeseries.html#exercises-5"><i class="fa fa-check"></i><b>10.10</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>11</b> Regression Methods</a>
<ul>
<li class="chapter" data-level="11.1" data-path="regression.html"><a href="regression.html#parametric-regression-methods"><i class="fa fa-check"></i><b>11.1</b> Parametric Regression Methods</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="regression.html"><a href="regression.html#examples"><i class="fa fa-check"></i><b>11.1.1</b> Examples</a></li>
<li class="chapter" data-level="11.1.2" data-path="regression.html"><a href="regression.html#model-adequacy-checking"><i class="fa fa-check"></i><b>11.1.2</b> Model adequacy checking</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="regression.html"><a href="regression.html#nonparametric-regression-methods"><i class="fa fa-check"></i><b>11.2</b> Nonparametric Regression Methods</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="regression.html"><a href="regression.html#piecewise-constant-splines"><i class="fa fa-check"></i><b>11.2.1</b> Piecewise constant splines</a></li>
<li class="chapter" data-level="11.2.2" data-path="regression.html"><a href="regression.html#truncated-power-splines"><i class="fa fa-check"></i><b>11.2.2</b> Truncated power splines</a></li>
<li class="chapter" data-level="11.2.3" data-path="regression.html"><a href="regression.html#b-splines-and-natural-splines"><i class="fa fa-check"></i><b>11.2.3</b> B-splines and natural splines</a></li>
<li class="chapter" data-level="11.2.4" data-path="regression.html"><a href="regression.html#smoothing-splines"><i class="fa fa-check"></i><b>11.2.4</b> Smoothing splines</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="regression.html"><a href="regression.html#example-cdc-fluview-portal-data"><i class="fa fa-check"></i><b>11.3</b> Example: CDC FluView Portal Data</a></li>
<li class="chapter" data-level="11.4" data-path="regression.html"><a href="regression.html#poisson-regression"><i class="fa fa-check"></i><b>11.4</b> Poisson regression</a></li>
<li class="chapter" data-level="11.5" data-path="regression.html"><a href="regression.html#logistic-regression"><i class="fa fa-check"></i><b>11.5</b> Logistic regression</a></li>
<li class="chapter" data-level="11.6" data-path="regression.html"><a href="regression.html#exercises-6"><i class="fa fa-check"></i><b>11.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="NN.html"><a href="NN.html"><i class="fa fa-check"></i><b>12</b> Neural Networks</a>
<ul>
<li class="chapter" data-level="12.1" data-path="NN.html"><a href="NN.html#a-single-neuron"><i class="fa fa-check"></i><b>12.1</b> A Single Neuron</a></li>
<li class="chapter" data-level="12.2" data-path="NN.html"><a href="NN.html#neural-network-structure"><i class="fa fa-check"></i><b>12.2</b> Neural Network Structure</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="NN.html"><a href="NN.html#forward-propagation"><i class="fa fa-check"></i><b>12.2.1</b> Forward propagation</a></li>
<li class="chapter" data-level="12.2.2" data-path="NN.html"><a href="NN.html#back-propagation"><i class="fa fa-check"></i><b>12.2.2</b> Back-propagation</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="NN.html"><a href="NN.html#overfitting"><i class="fa fa-check"></i><b>12.3</b> Overfitting</a></li>
<li class="chapter" data-level="12.4" data-path="NN.html"><a href="NN.html#neural-network-auto-regressive-nnar-models"><i class="fa fa-check"></i><b>12.4</b> Neural Network Auto-Regressive (NNAR) models</a></li>
<li class="chapter" data-level="12.5" data-path="NN.html"><a href="NN.html#covid-19-forecasting"><i class="fa fa-check"></i><b>12.5</b> COVID-19 Forecasting</a></li>
<li class="chapter" data-level="12.6" data-path="NN.html"><a href="NN.html#exercises-7"><i class="fa fa-check"></i><b>12.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="ensemble.html"><a href="ensemble.html"><i class="fa fa-check"></i><b>13</b> Hybrid Mdels</a>
<ul>
<li class="chapter" data-level="13.1" data-path="ensemble.html"><a href="ensemble.html#ensembling-time-series-models"><i class="fa fa-check"></i><b>13.1</b> Ensembling Time Series Models</a></li>
<li class="chapter" data-level="13.2" data-path="ensemble.html"><a href="ensemble.html#model-diagnostics"><i class="fa fa-check"></i><b>13.2</b> Model Diagnostics</a></li>
<li class="chapter" data-level="13.3" data-path="ensemble.html"><a href="ensemble.html#forecasting"><i class="fa fa-check"></i><b>13.3</b> Forecasting</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="ensemble.html"><a href="ensemble.html#perform-cross-validation-on-a-time-series"><i class="fa fa-check"></i><b>13.3.1</b> Perform cross validation on a time series</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="ensemble.html"><a href="ensemble.html#weights-selection-using-cross-validation"><i class="fa fa-check"></i><b>13.4</b> Weights Selection Using Cross Validation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i>Appendix</a></li>
<li class="chapter" data-level="14" data-path="appendix-a.html"><a href="appendix-a.html"><i class="fa fa-check"></i><b>14</b> Appendix A</a>
<ul>
<li class="chapter" data-level="14.1" data-path="appendix-a.html"><a href="appendix-a.html#r-introduction-and-preliminaries"><i class="fa fa-check"></i><b>14.1</b> R Introduction and Preliminaries</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="appendix-a.html"><a href="appendix-a.html#the-r-environment-and-language"><i class="fa fa-check"></i><b>14.1.1</b> The R Environment and Language</a></li>
<li class="chapter" data-level="14.1.2" data-path="appendix-a.html"><a href="appendix-a.html#r-and-statistics"><i class="fa fa-check"></i><b>14.1.2</b> R and Statistics</a></li>
<li class="chapter" data-level="14.1.3" data-path="appendix-a.html"><a href="appendix-a.html#obtaining-r-and-installation"><i class="fa fa-check"></i><b>14.1.3</b> Obtaining R and installation</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="appendix-a.html"><a href="appendix-a.html#starting-r"><i class="fa fa-check"></i><b>14.2</b> Starting R</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="appendix-a.html"><a href="appendix-a.html#description-of-three-panels-in-user-interface"><i class="fa fa-check"></i><b>14.2.1</b> Description of three panels in user interface</a></li>
<li class="chapter" data-level="14.2.2" data-path="appendix-a.html"><a href="appendix-a.html#r-help"><i class="fa fa-check"></i><b>14.2.2</b> R help</a></li>
<li class="chapter" data-level="14.2.3" data-path="appendix-a.html"><a href="appendix-a.html#some-mathematical-expressions"><i class="fa fa-check"></i><b>14.2.3</b> Some mathematical expressions</a></li>
<li class="chapter" data-level="14.2.4" data-path="appendix-a.html"><a href="appendix-a.html#r-packages"><i class="fa fa-check"></i><b>14.2.4</b> R Packages</a></li>
<li class="chapter" data-level="14.2.5" data-path="appendix-a.html"><a href="appendix-a.html#creating-a-project-and-setting-working-directory"><i class="fa fa-check"></i><b>14.2.5</b> Creating a project and setting working directory</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="appendix-a.html"><a href="appendix-a.html#exportimport-data"><i class="fa fa-check"></i><b>14.3</b> Export/Import Data</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="appendix-a.html"><a href="appendix-a.html#data-export"><i class="fa fa-check"></i><b>14.3.1</b> Data Export</a></li>
<li class="chapter" data-level="14.3.2" data-path="appendix-a.html"><a href="appendix-a.html#data-import"><i class="fa fa-check"></i><b>14.3.2</b> Data Import</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="appendix-b.html"><a href="appendix-b.html"><i class="fa fa-check"></i><b>15</b> Appendix B</a>
<ul>
<li class="chapter" data-level="15.1" data-path="appendix-b.html"><a href="appendix-b.html#epidemic-data"><i class="fa fa-check"></i><b>15.1</b> Epidemic Data</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="appendix-b.html"><a href="appendix-b.html#state-level"><i class="fa fa-check"></i><b>15.1.1</b> State level</a></li>
<li class="chapter" data-level="15.1.2" data-path="appendix-b.html"><a href="appendix-b.html#county-level"><i class="fa fa-check"></i><b>15.1.2</b> County level</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="appendix-b.html"><a href="appendix-b.html#other-factors"><i class="fa fa-check"></i><b>15.2</b> Other Factors</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="appendix-b.html"><a href="appendix-b.html#policy-data"><i class="fa fa-check"></i><b>15.2.1</b> Policy Data</a></li>
<li class="chapter" data-level="15.2.2" data-path="appendix-b.html"><a href="appendix-b.html#demographic-characteristics"><i class="fa fa-check"></i><b>15.2.2</b> Demographic Characteristics</a></li>
<li class="chapter" data-level="15.2.3" data-path="appendix-b.html"><a href="appendix-b.html#healthcare-infrastructure"><i class="fa fa-check"></i><b>15.2.3</b> Healthcare Infrastructure</a></li>
<li class="chapter" data-level="15.2.4" data-path="appendix-b.html"><a href="appendix-b.html#socioeconomic-status"><i class="fa fa-check"></i><b>15.2.4</b> Socioeconomic Status</a></li>
<li class="chapter" data-level="15.2.5" data-path="appendix-b.html"><a href="appendix-b.html#environmental-factor"><i class="fa fa-check"></i><b>15.2.5</b> Environmental Factor</a></li>
<li class="chapter" data-level="15.2.6" data-path="appendix-b.html"><a href="appendix-b.html#mobility"><i class="fa fa-check"></i><b>15.2.6</b> Mobility</a></li>
<li class="chapter" data-level="15.2.7" data-path="appendix-b.html"><a href="appendix-b.html#geographic-information"><i class="fa fa-check"></i><b>15.2.7</b> Geographic Information</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="appendix-b.html"><a href="appendix-b.html#data-sets"><i class="fa fa-check"></i><b>15.3</b> Data Sets</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="appendix-b.html"><a href="appendix-b.html#chapter-2"><i class="fa fa-check"></i><b>15.3.1</b> Chapter 2</a></li>
<li class="chapter" data-level="15.3.2" data-path="appendix-b.html"><a href="appendix-b.html#chapter-3"><i class="fa fa-check"></i><b>15.3.2</b> Chapter 3</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Learning of Infectious Disease Data Analytics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="regression" class="section level1" number="11">
<h1><span class="header-section-number">Chapter 11</span> Regression Methods</h1>
<p>In Chapter <a href="timeseries.html#timeseries">10</a> we introduces the time series analysis tools, which treat the value of a target variable at each time point as a random variable and uses the covariance function between these random variables to represent the correlation; another approach uses a deterministic smooth surface function to describe the variations and connections among values at different locations. This chapter introduces the latter approach.</p>
<p>In this chapter the analytical techniques of regression and discrimination are introduced as a means of quantifying the effect of a set of explanatory variables on the spatial distribution of a particular outcome. The material presented here is similar to that which might be presented in standard statistical texts, but includes an overview of the modifications needed to account for the temporal dependency frequently associated with disease data.</p>
<p>The use of nonparametric techniques has a long tradition in time series analysis. We present some nonparametric methods to forecast a seasonal univariate time series, and propose some dynamic updating methods to improve point forecast accuracy.</p>
<p>Perhaps the first aspect to consider is the type of outcome variable under investigation. In epidemiology interest lies in understanding patterns of disease in populations, so it is often the case that the outcome variable is either a count of disease events for area units, or more simply a binary response indicating the presence or absence of disease at a given location. Knowledge of the type of outcome variable is important since it determines the regression technique to be used and the options available to account for spatial dependence.</p>
<div id="parametric-regression-methods" class="section level2" number="11.1">
<h2><span class="header-section-number">11.1</span> Parametric Regression Methods</h2>
<p>Linear regression is a technique that can be used to model the broad-scale (first-order) trend. It allows the mean value of a continuous response variable (also known as a dependent variable) <span class="math inline">\(Y_t\)</span> to be represented as a function of <span class="math inline">\(d\)</span> explanatory (also known as covariate, predictor, or independent) variables:
<span class="math display">\[
Y_{t}=\beta_0+\beta_1X_{1t}+\beta_2X_{2t}+\cdots+\beta_dX_{dt}+\epsilon_t,
\]</span>
where <span class="math inline">\(\beta_{0}, \beta_{1},\ldots, \beta_d\)</span> are unknown parameters or coefficients, and <span class="math inline">\(\varepsilon\)</span> is the error term.</p>
<p>Note the following key assumptions behind this type of regression analysis:</p>
<ol style="list-style-type: lower-roman">
<li>The relationship between the response and the regressors is linear, at least approximately.</li>
<li>The errors all have the same variance: <span class="math inline">\(\mathrm{Var}(\epsilon_t) = \sigma^2\)</span> for all <span class="math inline">\(t\)</span>.</li>
<li>The errors are independent of each other. That is, the value of the observation at any point is not affected by the value of observations at any other point.</li>
<li>The residuals <span class="math inline">\(\epsilon_t\)</span> are normally distributed with a mean of zero.</li>
</ol>
<div id="examples" class="section level3" number="11.1.1">
<h3><span class="header-section-number">11.1.1</span> Examples</h3>
<p>To predict the number of deaths for COVID-19, <span class="citation"><a href="appendix-b.html#ref-Altieri:etal:21" role="doc-biblioref">Altieri et al.</a> (<a href="appendix-b.html#ref-Altieri:etal:21" role="doc-biblioref">2021</a>)</span> considered various regression models for modeling the death count at the county level in the US. The death count is assumed to follow a linear or exponential relationship with time or the current death count.</p>
<ol style="list-style-type: decimal">
<li><p>A separate-county exponential predictor: a series of predictors built for predicting cumulative death counts for each county using only past death counts from that county.
<span class="math display">\[
E(D_{t+1}|t) = \exp{\left\{\beta_0 +\beta_1(t+1)\right\}}.
\]</span></p></li>
<li><p>A separate-county linear predictor: a predictor similar to the separate county exponential predictors, but uses a simple linear format, rather than the exponential format.
<span class="math display">\[
E(D_{t+1}|t) = \beta_0 + \beta_1\times(t + 1).
\]</span></p></li>
<li><p>A shared-county exponential predictor: a single predictor built using death counts from all counties, used to predict death counts for individual counties.
<span class="math display">\[
E(D_{t+1}|t) = \exp\left\{\beta_0 + \beta_1 \log\left(D_t + 1\right)\right\}.
\]</span></p></li>
<li><p>An expanded shared-county exponential predictor: a predictor similar to the shared-county exponential predictor, which also includes COVID-19 case numbers and neighboring county cases and deaths as predictive features.
<span class="math display">\[
E(D_{t+1}|t) = \exp\left\{\beta_0 + \beta_1 \log\left(D_t + 1\right)\right\}.
\]</span></p></li>
<li><p>A demographics shared-county exponential predictor: a predictor also similar to the shared-county exponential predictor, but which also includes various county demographic and health-related predictive features.</p></li>
</ol>
<p><span class="math display">\[\begin{eqnarray*}
E(D_{t+1}|t) &amp;=&amp; \exp\left\{\beta_0 + \beta_1 \log\left(D_t + 1\right) + \beta_2\log\left(I_{t-k+1}+1\right)\right. \\
&amp;&amp; \left. + \beta_3\log\left(D_{t-k+1}^{\mathrm{neighbor}}\right) + \beta_4\log\left(I_{t-k+1}^{\mathrm{neighbor}}\right) \right\}.
\end{eqnarray*}\]</span></p>
<p>In the following, we illustrate Methods 1 and 2 using the data <code>Florida.ts</code>. We are interested in making predictions for the period December 05-December 11, 2020, and we use a training set from the past week (November 28 to December 04, 2020). The linear regression model and exponential model will be fitted on the training set, and the fitted model is used to make predictions. Figure <a href="regression.html#fig:celt">11.1</a> shows the forecasts of the daily death count.</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="regression.html#cb315-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set training data from NOV 28 to DEC 04</span></span>
<span id="cb315-2"><a href="regression.html#cb315-2" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> Florida.ts <span class="sc">%&gt;%</span> </span>
<span id="cb315-3"><a href="regression.html#cb315-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter_index</span>(<span class="st">&quot;2020-11-28&quot;</span> <span class="sc">~</span> <span class="st">&quot;2020-12-04&quot;</span>)</span>
<span id="cb315-4"><a href="regression.html#cb315-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb315-5"><a href="regression.html#cb315-5" aria-hidden="true" tabindex="-1"></a><span class="co"># both linear and exponential trend</span></span>
<span id="cb315-6"><a href="regression.html#cb315-6" aria-hidden="true" tabindex="-1"></a>fit_trends <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span></span>
<span id="cb315-7"><a href="regression.html#cb315-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(</span>
<span id="cb315-8"><a href="regression.html#cb315-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">linear =</span> <span class="fu">TSLM</span>(Y.Death <span class="sc">~</span> <span class="fu">trend</span>()),</span>
<span id="cb315-9"><a href="regression.html#cb315-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">exponential =</span> <span class="fu">TSLM</span>(<span class="fu">log</span>(Y.Death <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">~</span> <span class="fu">trend</span>()),</span>
<span id="cb315-10"><a href="regression.html#cb315-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb315-11"><a href="regression.html#cb315-11" aria-hidden="true" tabindex="-1"></a>fc_trends <span class="ot">&lt;-</span> fit_trends <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">7</span>)</span>
<span id="cb315-12"><a href="regression.html#cb315-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb315-13"><a href="regression.html#cb315-13" aria-hidden="true" tabindex="-1"></a><span class="co"># make predictions for the next week</span></span>
<span id="cb315-14"><a href="regression.html#cb315-14" aria-hidden="true" tabindex="-1"></a>Florida.ts <span class="sc">%&gt;%</span></span>
<span id="cb315-15"><a href="regression.html#cb315-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(Y.Death) <span class="sc">+</span></span>
<span id="cb315-16"><a href="regression.html#cb315-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">fitted</span>(fit_trends),</span>
<span id="cb315-17"><a href="regression.html#cb315-17" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">y =</span> .fitted, <span class="at">color =</span> .model)) <span class="sc">+</span></span>
<span id="cb315-18"><a href="regression.html#cb315-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(fc_trends, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">level =</span> <span class="dv">95</span>) <span class="sc">+</span></span>
<span id="cb315-19"><a href="regression.html#cb315-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Death Count&quot;</span>,</span>
<span id="cb315-20"><a href="regression.html#cb315-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Florida daily new deaths&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:celt"></span>
<img src="SLID_book_files/figure-html/celt-1.png" alt="Reported death count vs linear and exponential fit." width="672" />
<p class="caption">
Figure 11.1: Reported death count vs linear and exponential fit.
</p>
</div>
</div>
<div id="model-adequacy-checking" class="section level3" number="11.1.2">
<h3><span class="header-section-number">11.1.2</span> Model adequacy checking</h3>
<p>We should consider the validity of the assumptions mentioned before. Violations of the assumptions may yield an unstable model in the sense that a different sample could lead to a totally different model with opposite conclusions. Graphical analysis of residuals (original or scaled) is a very effective way to investigate the adequacy of the fit.</p>
<ul>
<li>Normal probability plot of residuals;</li>
<li>Plot of residuals against the fitted values;</li>
<li>Plot of residuals against each regressor variable;</li>
<li>Plot of residuals in time series (if time series data were collected).</li>
</ul>
<p><strong>Goodness of Fit</strong></p>
<p>How well does the model fit the data? One measure is <span class="math inline">\(R^2\)</span>, the so-called coefficient of determination or percentage of variance explained
<span class="math display">\[
R^2 = 1- \frac{\Sigma (Y_i-\hat{Y}_i)^2}{\Sigma (Y_i-\bar{Y}^2)} = 1-
\frac{\mbox{RSS}}{\mbox{Total SS (corrected for mean)}}.
\]</span></p>
<p>The range is <span class="math inline">\(0 \le R^2 \le 1\)</span>, and values closer to 1 indicates better fits. For simple linear regression <span class="math inline">\(R^2=r^2\)</span> where <span class="math inline">\(r\)</span> is the correlation between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>. An equivalent definition is
<span class="math display">\[
R^2 = \frac{\Sigma (\hat{Y}_i-\bar{Y})^2}{\Sigma (Y_i-\bar{Y})^2} = \frac{\mbox{Regression Sum of Squares}}{\mbox{Total SS (corrected for mean)}}.
\]</span></p>
<p>After selecting the regression variables and fitting a regression model, it is necessary to plot the residuals to check that the assumptions of the model have been satisfied. There are a series of plots that should be produced in order to check different aspects of the fitted model and the underlying assumptions. We will now discuss each of them in turn.</p>
<p><strong>ACF plot of residuals</strong></p>
<p>With time series data, it is highly likely that the value of a variable observed in the current time period will be similar to its value in the previous period, or even the period before that, and so on. Therefore when fitting a regression model to time series data, it is common to find autocorrelation in the residuals. In this case, the estimated model violates the assumption of no autocorrelation in the errors, and our forecasts may be inefficient — there is some information left over which should be accounted for in the model in order to obtain better forecasts. The forecasts from a model with autocorrelated errors are still unbiased, and so are not “wrong,” but they will usually have larger prediction intervals than they need to. Therefore we should always look at an ACF plot of the residuals.</p>
<p><strong>Histogram of residuals</strong></p>
<p>It is always a good idea to check whether the residuals are normally distributed. As we explained earlier, this is not essential for forecasting, but it does make the calculation of prediction intervals much easier.</p>
<p><strong>Residual plots against predictors</strong></p>
<p>We would expect the residuals to be randomly scattered without showing any systematic patterns. A simple and quick way to check this is to examine scatterplots of the residuals against each of the predictor variables. If these scatterplots show a pattern, then the relationship may be nonlinear and the model will need to be modified accordingly.</p>
<p>It is also necessary to plot the residuals against any predictors that are not in the model. If any of these show a pattern, then the corresponding predictor may need to be added to the model (possibly in a nonlinear form).</p>
</div>
</div>
<div id="nonparametric-regression-methods" class="section level2" number="11.2">
<h2><span class="header-section-number">11.2</span> Nonparametric Regression Methods</h2>
<p>It is common for time series data to be trending. A linear trend can be modelled by simply using <span class="math inline">\(x_{1t}=t\)</span> as a predictor,
<span class="math display">\[
Y_t=\beta_0+\beta_1 t+\varepsilon_t,
\]</span>
where <span class="math inline">\(t=1,\ldots,n\)</span>. A trend variable can be specified in the <code>TSLM()</code> function using the <code>trend()</code> special.</p>
<p>In this section, we further extend the linear regression to model the nonlinear trends.</p>
<p>A nonparametric regression model assumes
<span class="math display">\[
y_{t}=m\left(t\right)+\varepsilon_{t}, \ \ t=1,\cdots,n,
\]</span>
where <span class="math inline">\(\varepsilon_{t}\)</span> are assumed to be i.i.d. with mean <span class="math inline">\(0\)</span> and variance <span class="math inline">\(\sigma^{2}\)</span>, <span class="math inline">\(m(\cdot)\)</span> is a nonparametric regression function. Linear regression is a special case:
<span class="math display">\[
m(t)=\beta_{0}+\beta_{1}t.
\]</span></p>
<div id="piecewise-constant-splines" class="section level3" number="11.2.1">
<h3><span class="header-section-number">11.2.1</span> Piecewise constant splines</h3>
<p>We break the time domain into bins, and fit a different constant in each bin. We create cut-off points <span class="math inline">\(k_1\)</span>, <span class="math inline">\(k_2\)</span>, , <span class="math inline">\(k_{N}\)</span> in the time domain, and then construct <span class="math inline">\(N + 1\)</span> piecewise constant basis functions:</p>
<p><span class="math display">\[\begin{eqnarray*}
  B_0(t) &amp;=&amp; I(t &lt;k_1), \\
  B_1(t) &amp;=&amp; I(k_1 \leq t &lt;k_2), \\
  B_2(t) &amp;=&amp; I(k_2 \leq t &lt;k_3), \\
  \cdots &amp;=&amp;  \cdots, \\
  B_{N-1}(t) &amp;=&amp; I(k_{N-1} \leq t &lt;k_N), \\
  B_N(t) &amp;=&amp; I(k_N \leq t),
\end{eqnarray*}\]</span>
where <span class="math inline">\(I(\cdot)\)</span> is an indicator function that returns a <span class="math inline">\(1\)</span> if the condition is true, indicator and returns a <span class="math inline">\(0\)</span> otherwise.</p>
<p>Figure <a href="regression.html#fig:pcs">11.2</a> shows a fit for the daily new death count for Florida using piecewise constant splines.</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="regression.html#cb316-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(Florida.ts)</span>
<span id="cb316-2"><a href="regression.html#cb316-2" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n</span>
<span id="cb316-3"><a href="regression.html#cb316-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> Florida.ts<span class="sc">$</span>Y.Death</span>
<span id="cb316-4"><a href="regression.html#cb316-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb316-5"><a href="regression.html#cb316-5" aria-hidden="true" tabindex="-1"></a><span class="co"># knots</span></span>
<span id="cb316-6"><a href="regression.html#cb316-6" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">21</span></span>
<span id="cb316-7"><a href="regression.html#cb316-7" aria-hidden="true" tabindex="-1"></a>knots <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> (n<span class="dv">-1</span>)<span class="sc">/</span>(N<span class="sc">+</span><span class="dv">1</span>) <span class="sc">*</span> (<span class="dv">0</span><span class="sc">:</span>N)</span>
<span id="cb316-8"><a href="regression.html#cb316-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb316-9"><a href="regression.html#cb316-9" aria-hidden="true" tabindex="-1"></a><span class="co"># piecewise constant spline basis</span></span>
<span id="cb316-10"><a href="regression.html#cb316-10" aria-hidden="true" tabindex="-1"></a>t.rep <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(t, N), n, N)</span>
<span id="cb316-11"><a href="regression.html#cb316-11" aria-hidden="true" tabindex="-1"></a>knot.L <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(knots[<span class="sc">-</span>(N <span class="sc">+</span> <span class="dv">1</span>)], <span class="at">each =</span> n), n, N)</span>
<span id="cb316-12"><a href="regression.html#cb316-12" aria-hidden="true" tabindex="-1"></a>knot.R <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(knots[<span class="sc">-</span><span class="dv">1</span>], <span class="at">each =</span> n), n, N)</span>
<span id="cb316-13"><a href="regression.html#cb316-13" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">*</span>((knot.L <span class="sc">&lt;=</span> t.rep) <span class="sc">&amp;</span> (t.rep <span class="sc">&lt;</span> knot.R))</span>
<span id="cb316-14"><a href="regression.html#cb316-14" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(B, knots[N] <span class="sc">&lt;</span> t <span class="sc">&amp;</span> t <span class="sc">&lt;=</span> n)</span>
<span id="cb316-15"><a href="regression.html#cb316-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb316-16"><a href="regression.html#cb316-16" aria-hidden="true" tabindex="-1"></a><span class="co"># piecewise constant spline fit</span></span>
<span id="cb316-17"><a href="regression.html#cb316-17" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">t</span>(X) <span class="sc">%*%</span> X</span>
<span id="cb316-18"><a href="regression.html#cb316-18" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fu">solve</span>(M) <span class="sc">%*%</span> <span class="fu">t</span>(X) <span class="sc">%*%</span> y</span>
<span id="cb316-19"><a href="regression.html#cb316-19" aria-hidden="true" tabindex="-1"></a>yhat <span class="ot">&lt;-</span> X <span class="sc">%*%</span> beta</span>
<span id="cb316-20"><a href="regression.html#cb316-20" aria-hidden="true" tabindex="-1"></a>Florida.ts<span class="sc">$</span>pcs_preds <span class="ot">&lt;-</span> yhat</span>
<span id="cb316-21"><a href="regression.html#cb316-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb316-22"><a href="regression.html#cb316-22" aria-hidden="true" tabindex="-1"></a><span class="co"># plot of reported vs piecewise constant spline fit</span></span>
<span id="cb316-23"><a href="regression.html#cb316-23" aria-hidden="true" tabindex="-1"></a>Florida.ts <span class="sc">%&gt;%</span></span>
<span id="cb316-24"><a href="regression.html#cb316-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> DATE)) <span class="sc">+</span></span>
<span id="cb316-25"><a href="regression.html#cb316-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Y.Death, <span class="at">color =</span> <span class="st">&quot;Reported&quot;</span>)) <span class="sc">+</span></span>
<span id="cb316-26"><a href="regression.html#cb316-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> pcs_preds, <span class="at">color =</span> <span class="st">&quot;Fitted&quot;</span>)) <span class="sc">+</span></span>
<span id="cb316-27"><a href="regression.html#cb316-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb316-28"><a href="regression.html#cb316-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="at">Reported =</span> <span class="st">&quot;black&quot;</span>, <span class="at">Fitted =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb316-29"><a href="regression.html#cb316-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb316-30"><a href="regression.html#cb316-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Death count&quot;</span>,</span>
<span id="cb316-31"><a href="regression.html#cb316-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Reported vs piecewise constant spline fit&quot;</span>) <span class="sc">+</span></span>
<span id="cb316-32"><a href="regression.html#cb316-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">&quot;Series&quot;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:pcs"></span>
<img src="SLID_book_files/figure-html/pcs-1.png" alt="Piecewise constant spline smoothing for the daily new death count for Florida." width="672" />
<p class="caption">
Figure 11.2: Piecewise constant spline smoothing for the daily new death count for Florida.
</p>
</div>
</div>
<div id="truncated-power-splines" class="section level3" number="11.2.2">
<h3><span class="header-section-number">11.2.2</span> Truncated power splines</h3>
<p>For univariate data, polynomial splines of degree <span class="math inline">\(p\)</span> can be represented by an appropriate sequence of <span class="math inline">\(N+p+1\)</span> spline basis functions, determined in turn by <span class="math inline">\(N\)</span> interior knots. These produce functions that are piecewise polynomials of degree <span class="math inline">\(p\)</span> between the knots, and joined up with continuity of degree <span class="math inline">\(p-1\)</span> at the knots. As an example consider linear splines, or piecewise linear functions.</p>
<p>Let <span class="math inline">\(k_1 &lt; k_2 &lt; \ldots &lt; k_N\)</span> be <strong>knots</strong> in the time domain, for example, <span class="math inline">\([1, n]\)</span>. Let <span class="math inline">\(\phi_0(t) = 1\)</span>, <span class="math inline">\(\phi_1(t) = t\)</span>, <span class="math inline">\(\phi_j(t) = (t-k_{j-1})_{+}\)</span> for <span class="math inline">\(j = 2, \ldots, N+1\)</span> be the basis functions, where <span class="math inline">\(x_{+}\)</span> denotes positive part of <span class="math inline">\(x\)</span>. Then, the regression is piecewise linear with bends at the knots.</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="regression.html#cb317-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> Florida.ts<span class="sc">$</span>Y.Death</span>
<span id="cb317-2"><a href="regression.html#cb317-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(Florida.ts)</span>
<span id="cb317-3"><a href="regression.html#cb317-3" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n</span>
<span id="cb317-4"><a href="regression.html#cb317-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb317-5"><a href="regression.html#cb317-5" aria-hidden="true" tabindex="-1"></a><span class="co"># knots</span></span>
<span id="cb317-6"><a href="regression.html#cb317-6" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb317-7"><a href="regression.html#cb317-7" aria-hidden="true" tabindex="-1"></a>knots <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> (n<span class="dv">-1</span>)<span class="sc">/</span>(N<span class="sc">+</span><span class="dv">1</span>) <span class="sc">*</span> (<span class="dv">0</span><span class="sc">:</span>N)</span>
<span id="cb317-8"><a href="regression.html#cb317-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb317-9"><a href="regression.html#cb317-9" aria-hidden="true" tabindex="-1"></a><span class="co"># truncated power spline basis functions</span></span>
<span id="cb317-10"><a href="regression.html#cb317-10" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span>, n, N <span class="sc">+</span> <span class="dv">2</span>)    </span>
<span id="cb317-11"><a href="regression.html#cb317-11" aria-hidden="true" tabindex="-1"></a>X[, <span class="dv">2</span>] <span class="ot">&lt;-</span> t</span>
<span id="cb317-12"><a href="regression.html#cb317-12" aria-hidden="true" tabindex="-1"></a>t.rep <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(t, N), n, N) </span>
<span id="cb317-13"><a href="regression.html#cb317-13" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> t.rep <span class="sc">-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(knots[<span class="dv">2</span><span class="sc">:</span>(N <span class="sc">+</span> <span class="dv">1</span>)], <span class="at">each =</span> n), n, N)</span>
<span id="cb317-14"><a href="regression.html#cb317-14" aria-hidden="true" tabindex="-1"></a>X[, <span class="dv">3</span><span class="sc">:</span>(N<span class="sc">+</span><span class="dv">2</span>)] <span class="ot">&lt;-</span> tmp <span class="sc">*</span> (tmp <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb317-15"><a href="regression.html#cb317-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb317-16"><a href="regression.html#cb317-16" aria-hidden="true" tabindex="-1"></a><span class="co"># truncated power spline fit</span></span>
<span id="cb317-17"><a href="regression.html#cb317-17" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">t</span>(X) <span class="sc">%*%</span> X</span>
<span id="cb317-18"><a href="regression.html#cb317-18" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fu">solve</span>(M) <span class="sc">%*%</span> <span class="fu">t</span>(X) <span class="sc">%*%</span> y</span>
<span id="cb317-19"><a href="regression.html#cb317-19" aria-hidden="true" tabindex="-1"></a>yhat <span class="ot">&lt;-</span> X <span class="sc">%*%</span> beta</span>
<span id="cb317-20"><a href="regression.html#cb317-20" aria-hidden="true" tabindex="-1"></a>Florida.ts<span class="sc">$</span>tps_preds <span class="ot">&lt;-</span> yhat</span>
<span id="cb317-21"><a href="regression.html#cb317-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb317-22"><a href="regression.html#cb317-22" aria-hidden="true" tabindex="-1"></a><span class="co"># plot of reported vs truncated power spline fit</span></span>
<span id="cb317-23"><a href="regression.html#cb317-23" aria-hidden="true" tabindex="-1"></a>Florida.ts <span class="sc">%&gt;%</span></span>
<span id="cb317-24"><a href="regression.html#cb317-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> DATE)) <span class="sc">+</span></span>
<span id="cb317-25"><a href="regression.html#cb317-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Y.Death, <span class="at">color =</span> <span class="st">&quot;Reported&quot;</span>)) <span class="sc">+</span></span>
<span id="cb317-26"><a href="regression.html#cb317-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> tps_preds, <span class="at">color =</span> <span class="st">&quot;Fitted&quot;</span>)) <span class="sc">+</span></span>
<span id="cb317-27"><a href="regression.html#cb317-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb317-28"><a href="regression.html#cb317-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="at">Reported =</span> <span class="st">&quot;black&quot;</span>, <span class="at">Fitted =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb317-29"><a href="regression.html#cb317-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb317-30"><a href="regression.html#cb317-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Death count&quot;</span>,</span>
<span id="cb317-31"><a href="regression.html#cb317-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Reported vs truncated power spline fit&quot;</span>) <span class="sc">+</span></span>
<span id="cb317-32"><a href="regression.html#cb317-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">&quot;Series&quot;</span>))</span></code></pre></div>
<p><img src="SLID_book_files/figure-html/unnamed-chunk-188-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>In general, let
<span class="math display">\[
(t-k_{j})_{+}^{p}=\left\{\begin{array}{cc}(t-k_{j})^{p} &amp; \mathrm{for} \ t\geq k_{j}\\ 0 &amp; \mathrm{for} \ t&lt;k_{j}\end{array}\right.
\]</span>
Then, the <span class="math inline">\(N+p+1\)</span> truncated power basis functions are:
<span class="math display">\[\begin{eqnarray*}
\phi_{1}(t)&amp;=&amp;1, \\
\phi_{2}(t)&amp;=&amp;t, \\
&amp;\vdots&amp; \\
\phi_{p}(t)&amp;=&amp;t^{p},\\
\phi_{p+1}(t)&amp;=&amp;(t-k_{1})_{+}^{p},\\
&amp;\vdots&amp; \\
\phi_{p+N}(t)&amp;=&amp;(t-k_{N})_{+}^{p}.
\end{eqnarray*}\]</span></p>
<p>We define the spline estimator for the regression function <span class="math inline">\(m(x)\)</span> as
<span class="math display">\[
\hat{m}\left(t\right) =\sum_{k=0}^{p} \hat{\beta}_{k}
t^{k}+\sum_{j=1}^{N}\hat{\gamma}_{j}\left(t-\kappa_{j}\right)_{+}^{p},
\]</span>
where <span class="math inline">\(\{\hat{\beta}_{0},\ldots,\hat{\beta}_{p},\hat{\gamma}_{1},\ldots,\hat{\gamma}_{N}\}\)</span> are the least square estimators of <span class="math inline">\(\{\beta_{0},\ldots,\beta_{p},\gamma_{1},\ldots,\gamma_{N}\}\)</span> based on the data. The shape of the basis functions is determined by the position of the knots <span class="math inline">\(k_{1}&lt;\ldots&lt;k_{N}\)</span>, which can, for example, be uniformly spread over the time domain.</p>
</div>
<div id="b-splines-and-natural-splines" class="section level3" number="11.2.3">
<h3><span class="header-section-number">11.2.3</span> B-splines and natural splines</h3>
<p>Both B-splines and natural splines similarly define a basis over the time domain. They are made up of piecewise polynomials of a given degree, and have defined derivatives similarly to the piecewise defined functions.</p>
<p>To introduce the space of splines, we pre-select an integer <span class="math inline">\(N\)</span>, and divide the time domain <span class="math inline">\([a,b]\)</span> into <span class="math inline">\((N+1)\)</span> subintervals <span class="math inline">\(J_{j}=[k_{j},k_{j+1})\)</span>, <span class="math inline">\(j=0,\ldots,N-1\)</span>, <span class="math inline">\(J_{N}=[k_{N},b]\)</span>, where <span class="math inline">\(\{k_{j}\}_{j=1}^{N}\)</span> is a sequence of equally-spaced points, called interior knots, given as
<span class="math display">\[
k_{1-p}=...=k_{-1}=k_{0}=a&lt;k_{1}&lt;\ldots&lt;k_{N}&lt;b=k_{N+1}=\ldots=k_{N+p},
\]</span>
in which <span class="math inline">\(k_{j}=j(b-a)/(N+1)\)</span>, <span class="math inline">\(j=0,1,\ldots,N+1\)</span>. The <span class="math inline">\(j\)</span>-th B-spline of order <span class="math inline">\(r\)</span> denoted by <span class="math inline">\(b_{j,r}\)</span> is recursively defined by de Boor (2001) as follows:</p>
<ul>
<li><p>For <span class="math inline">\(r=1\)</span>, basis <span class="math inline">\(b_{1,1},\ldots, b_{N,1}\)</span>:
<span class="math display">\[
b_{j,1}(t)=I\left\{t\in[k_{j},k_{j+1})\right\}.
\]</span></p></li>
<li><p>Given <span class="math inline">\(b_{j,r-1},j=-(r-1),\ldots,N\)</span>, construct <span class="math inline">\(b_{j,r}\)</span>
<span class="math display">\[
b_{j,r}(t)=\frac{t-k_{j}}{k_{j+r-1}-k_{j}}b_{j,r-1}(t)+\frac{k_{j+r}-t}{k_{j+r}-k_{j+1}}b_{j+1,r-1}(t)
\]</span></p></li>
<li><p>E.g., <span class="math inline">\(r=2\)</span>, basis <span class="math inline">\(b_{-1,2},\ldots, b_{N,2}\)</span>:
<span class="math display">\[
b_{j,2}(t)=\frac{t-k_{j}}{k_{j+1}-k_{j}}b_{j,1}(t)+\frac{k_{j+2}-t}{k_{j+2}-k_{j+1}}b_{j+1,1}(t).
\]</span></p></li>
</ul>
<p>It is well known that the behavior of polynomials fit to data tends to be erratic near the boundaries, and extrapolation can be dangerous. These problems are exacerbated with splines. The polynomials fit beyond the boundary knots behave even more wildly than the corresponding global polynomials in that region. This can be conveniently summarized in terms of the pointwise variance of spline functions fit by least squares.</p>
<p>A <strong>natural cubic spline</strong> adds additional constraints, namely that the function is linear beyond the boundary knots. This frees up four degrees of freedom (two constraints each in both boundary regions), which can be
spent more profitably by sprinkling more knots in the interior region.</p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="regression.html#cb318-1" aria-hidden="true" tabindex="-1"></a><span class="co"># natural spline fit</span></span>
<span id="cb318-2"><a href="regression.html#cb318-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(splines)</span>
<span id="cb318-3"><a href="regression.html#cb318-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(Florida.ts)</span>
<span id="cb318-4"><a href="regression.html#cb318-4" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n</span>
<span id="cb318-5"><a href="regression.html#cb318-5" aria-hidden="true" tabindex="-1"></a>ns_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y.Death <span class="sc">~</span> <span class="fu">ns</span>(t, <span class="at">df =</span> <span class="dv">6</span>), <span class="at">data =</span> Florida.ts)</span>
<span id="cb318-6"><a href="regression.html#cb318-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ns_fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Y.Death ~ ns(t, df = 6), data = Florida.ts)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -129.894  -14.531   -1.122   14.886  136.643 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)      -4.947     10.467  -0.473 0.636843    
## ns(t, df = 6)1   50.740     13.185   3.848 0.000144 ***
## ns(t, df = 6)2   41.051     16.893   2.430 0.015649 *  
## ns(t, df = 6)3  214.442     15.009  14.288  &lt; 2e-16 ***
## ns(t, df = 6)4   11.851     13.081   0.906 0.365637    
## ns(t, df = 6)5   88.438     26.606   3.324 0.000992 ***
## ns(t, df = 6)6  104.854     11.976   8.756  &lt; 2e-16 ***
## ---
## Signif. codes:  
## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 38.72 on 317 degrees of freedom
## Multiple R-squared:  0.5771, Adjusted R-squared:  0.5691 
## F-statistic: 72.09 on 6 and 317 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="regression.html#cb320-1" aria-hidden="true" tabindex="-1"></a>Florida.ts<span class="sc">$</span>ns_preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(ns_fit)</span>
<span id="cb320-2"><a href="regression.html#cb320-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-3"><a href="regression.html#cb320-3" aria-hidden="true" tabindex="-1"></a><span class="co"># natural spline prediction and prediction intervals</span></span>
<span id="cb320-4"><a href="regression.html#cb320-4" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">14</span></span>
<span id="cb320-5"><a href="regression.html#cb320-5" aria-hidden="true" tabindex="-1"></a>t.new <span class="ot">&lt;-</span> t[n] <span class="sc">+</span> (<span class="dv">1</span><span class="sc">:</span>h)</span>
<span id="cb320-6"><a href="regression.html#cb320-6" aria-hidden="true" tabindex="-1"></a>ns_PI <span class="ot">&lt;-</span> <span class="fu">predict</span>(ns_fit, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">t =</span> t.new), </span>
<span id="cb320-7"><a href="regression.html#cb320-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">interval =</span> <span class="st">&quot;prediction&quot;</span>,</span>
<span id="cb320-8"><a href="regression.html#cb320-8" aria-hidden="true" tabindex="-1"></a>                           <span class="at">level =</span> <span class="fl">0.95</span>)</span>
<span id="cb320-9"><a href="regression.html#cb320-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-10"><a href="regression.html#cb320-10" aria-hidden="true" tabindex="-1"></a>ns_PI <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(ns_PI) <span class="sc">%&gt;%</span></span>
<span id="cb320-11"><a href="regression.html#cb320-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DATE =</span> (Florida.ts<span class="sc">$</span>DATE)[n] <span class="sc">+</span> <span class="dv">1</span><span class="sc">:</span>h)</span>
<span id="cb320-12"><a href="regression.html#cb320-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-13"><a href="regression.html#cb320-13" aria-hidden="true" tabindex="-1"></a><span class="co"># reported values vs fitted values</span></span>
<span id="cb320-14"><a href="regression.html#cb320-14" aria-hidden="true" tabindex="-1"></a>Florida.ts <span class="sc">%&gt;%</span></span>
<span id="cb320-15"><a href="regression.html#cb320-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ns_preds, <span class="at">y =</span> Y.Death)) <span class="sc">+</span></span>
<span id="cb320-16"><a href="regression.html#cb320-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb320-17"><a href="regression.html#cb320-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Fitted (predicted values)&quot;</span>) <span class="sc">+</span></span>
<span id="cb320-18"><a href="regression.html#cb320-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Data (reported values)&quot;</span>) <span class="sc">+</span></span>
<span id="cb320-19"><a href="regression.html#cb320-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Observed vs fitted&quot;</span>) <span class="sc">+</span></span>
<span id="cb320-20"><a href="regression.html#cb320-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept=</span><span class="dv">0</span>, <span class="at">slope=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="SLID_book_files/figure-html/unnamed-chunk-189-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="regression.html#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot of reported vs natural spline fit</span></span>
<span id="cb321-2"><a href="regression.html#cb321-2" aria-hidden="true" tabindex="-1"></a>ns_p <span class="ot">&lt;-</span> Florida.ts <span class="sc">%&gt;%</span></span>
<span id="cb321-3"><a href="regression.html#cb321-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> DATE)) <span class="sc">+</span></span>
<span id="cb321-4"><a href="regression.html#cb321-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Y.Death, <span class="at">color =</span> <span class="st">&quot;Reported&quot;</span>)) <span class="sc">+</span></span>
<span id="cb321-5"><a href="regression.html#cb321-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> ns_preds, <span class="at">color =</span> <span class="st">&quot;Fitted&quot;</span>)) <span class="sc">+</span></span>
<span id="cb321-6"><a href="regression.html#cb321-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb321-7"><a href="regression.html#cb321-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="at">Reported =</span> <span class="st">&quot;black&quot;</span>, <span class="at">Fitted =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb321-8"><a href="regression.html#cb321-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb321-9"><a href="regression.html#cb321-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Death count&quot;</span>,</span>
<span id="cb321-10"><a href="regression.html#cb321-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Reported vs natural spline regression fit&quot;</span>) <span class="sc">+</span></span>
<span id="cb321-11"><a href="regression.html#cb321-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">&quot;Series&quot;</span>))</span>
<span id="cb321-12"><a href="regression.html#cb321-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb321-13"><a href="regression.html#cb321-13" aria-hidden="true" tabindex="-1"></a>ns_p</span></code></pre></div>
<p><img src="SLID_book_files/figure-html/unnamed-chunk-189-2.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="regression.html#cb322-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot of natural spline fit and its prediction intervals</span></span>
<span id="cb322-2"><a href="regression.html#cb322-2" aria-hidden="true" tabindex="-1"></a>ns_p <span class="ot">&lt;-</span> ns_p <span class="sc">+</span> <span class="fu">geom_ribbon</span>(</span>
<span id="cb322-3"><a href="regression.html#cb322-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> fit, </span>
<span id="cb322-4"><a href="regression.html#cb322-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">ymin =</span> lwr, </span>
<span id="cb322-5"><a href="regression.html#cb322-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">ymax =</span> upr,</span>
<span id="cb322-6"><a href="regression.html#cb322-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">fill =</span> <span class="st">&#39;95% Prediction Intervals&#39;</span>), </span>
<span id="cb322-7"><a href="regression.html#cb322-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> ns_PI, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb322-8"><a href="regression.html#cb322-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> fit, <span class="at">color =</span> <span class="st">&quot;Fitted&quot;</span>),</span>
<span id="cb322-9"><a href="regression.html#cb322-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> ns_PI,</span>
<span id="cb322-10"><a href="regression.html#cb322-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">key_glyph =</span> <span class="st">&quot;timeseries&quot;</span>) </span>
<span id="cb322-11"><a href="regression.html#cb322-11" aria-hidden="true" tabindex="-1"></a>ns_p</span></code></pre></div>
<p><img src="SLID_book_files/figure-html/unnamed-chunk-189-3.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="smoothing-splines" class="section level3" number="11.2.4">
<h3><span class="header-section-number">11.2.4</span> Smoothing splines</h3>
<p>A different idea to estimate the regression function <span class="math inline">\(m(\cdot)\)</span> by
<span class="math display">\[
\min_{m}\frac{1}{n}\sum_{t=1}^{n}\left(Y_{t}-m(x_{t})\right)^{2}+\lambda \int \left(m^{\prime\prime}(t)\right)^{2}dt,
\]</span>
where <span class="math inline">\(\lambda&gt;0\)</span> is a smoothing parameter, and it controls large values of the second derivative of <span class="math inline">\(m\)</span>. For <span class="math inline">\(\lambda = 0\)</span> no penalty is imposed, and any interpolating function will do, while for <span class="math inline">\(\lambda = \infty\)</span> only functions linear in <span class="math inline">\(t\)</span> are permitted.</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="regression.html#cb323-1" aria-hidden="true" tabindex="-1"></a><span class="co"># smoothing spline fit</span></span>
<span id="cb323-2"><a href="regression.html#cb323-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span>
<span id="cb323-3"><a href="regression.html#cb323-3" aria-hidden="true" tabindex="-1"></a>ss_fit <span class="ot">&lt;-</span> <span class="fu">gam</span>(Y.Death <span class="sc">~</span> <span class="fu">s</span>(t, <span class="at">bs =</span> <span class="st">&quot;cr&quot;</span>), <span class="at">data =</span> Florida.ts)</span>
<span id="cb323-4"><a href="regression.html#cb323-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ss_fit)</span></code></pre></div>
<pre><code>## 
## Family: gaussian 
## Link function: identity 
## 
## Formula:
## Y.Death ~ s(t, bs = &quot;cr&quot;)
## 
## Parametric coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   60.846      2.038   29.86   &lt;2e-16 ***
## ---
## Signif. codes:  
## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Approximate significance of smooth terms:
##        edf Ref.df     F p-value    
## s(t) 8.715  8.976 57.55  &lt;2e-16 ***
## ---
## Signif. codes:  
## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## R-sq.(adj) =  0.613   Deviance explained = 62.4%
## GCV = 1387.4  Scale est. = 1345.8    n = 324</code></pre>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="regression.html#cb325-1" aria-hidden="true" tabindex="-1"></a>Florida.ts<span class="sc">$</span>ss_preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(ss_fit)</span>
<span id="cb325-2"><a href="regression.html#cb325-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb325-3"><a href="regression.html#cb325-3" aria-hidden="true" tabindex="-1"></a><span class="co"># plot of reported vs smoothing spline fit</span></span>
<span id="cb325-4"><a href="regression.html#cb325-4" aria-hidden="true" tabindex="-1"></a>Florida.ts <span class="sc">%&gt;%</span></span>
<span id="cb325-5"><a href="regression.html#cb325-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> DATE)) <span class="sc">+</span></span>
<span id="cb325-6"><a href="regression.html#cb325-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Y.Death, <span class="at">color =</span> <span class="st">&quot;Reported&quot;</span>)) <span class="sc">+</span></span>
<span id="cb325-7"><a href="regression.html#cb325-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> ss_preds, <span class="at">color =</span> <span class="st">&quot;Fitted&quot;</span>)) <span class="sc">+</span></span>
<span id="cb325-8"><a href="regression.html#cb325-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb325-9"><a href="regression.html#cb325-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="at">Reported =</span> <span class="st">&quot;black&quot;</span>, <span class="at">Fitted =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb325-10"><a href="regression.html#cb325-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb325-11"><a href="regression.html#cb325-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Death count&quot;</span>,</span>
<span id="cb325-12"><a href="regression.html#cb325-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Reported vs smoothing spline fit&quot;</span>) <span class="sc">+</span></span>
<span id="cb325-13"><a href="regression.html#cb325-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">&quot;Series&quot;</span>))</span></code></pre></div>
<p><img src="SLID_book_files/figure-html/unnamed-chunk-190-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="example-cdc-fluview-portal-data" class="section level2" number="11.3">
<h2><span class="header-section-number">11.3</span> Example: CDC FluView Portal Data</h2>
<p>The CDC FluView Portal provides in-season and past seasons’ national, regional, and state-level outpatient illness and viral surveillance data from both ILINet (Influenza-like Illness Surveillance Network) and WHO/NREVSS (National Respiratory and Enteric Virus Surveillance System).</p>
<p>FluView, a weekly influenza surveillance report, and FluView Interactive, an online application which allows for more in-depth exploration of influenza surveillance data, are updated each week.</p>
<p>R Package “cdcfluview” retrieves Flu Season Data from the CDC “FluView” Portal. We can use the function <code>ilinet()</code> to retrieve state, regional or national influenza statistics from the CDC.</p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="regression.html#cb326-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cdcfluview)</span>
<span id="cb326-2"><a href="regression.html#cb326-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb326-3"><a href="regression.html#cb326-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb326-4"><a href="regression.html#cb326-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-5"><a href="regression.html#cb326-5" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare data</span></span>
<span id="cb326-6"><a href="regression.html#cb326-6" aria-hidden="true" tabindex="-1"></a>usflu.raw <span class="ot">&lt;-</span> <span class="fu">ilinet</span>(<span class="st">&quot;national&quot;</span>, <span class="at">years =</span> <span class="dv">2010</span><span class="sc">:</span><span class="dv">2018</span>)</span>
<span id="cb326-7"><a href="regression.html#cb326-7" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(usflu.raw)</span></code></pre></div>
<pre><code>##  [1] &quot;region_type&quot;      &quot;region&quot;          
##  [3] &quot;year&quot;             &quot;week&quot;            
##  [5] &quot;weighted_ili&quot;     &quot;unweighted_ili&quot;  
##  [7] &quot;age_0_4&quot;          &quot;age_25_49&quot;       
##  [9] &quot;age_25_64&quot;        &quot;age_5_24&quot;        
## [11] &quot;age_50_64&quot;        &quot;age_65&quot;          
## [13] &quot;ilitotal&quot;         &quot;num_of_providers&quot;
## [15] &quot;total_patients&quot;   &quot;week_start&quot;</code></pre>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="regression.html#cb328-1" aria-hidden="true" tabindex="-1"></a>usflu <span class="ot">&lt;-</span> usflu.raw <span class="sc">%&gt;%</span> </span>
<span id="cb328-2"><a href="regression.html#cb328-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb328-3"><a href="regression.html#cb328-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">paste0</span>(year, <span class="fu">sprintf</span>(<span class="st">&quot;%02d&quot;</span>, week), <span class="st">&quot;00&quot;</span>),</span>
<span id="cb328-4"><a href="regression.html#cb328-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">format=</span><span class="st">&quot;%Y%W%w&quot;</span>), </span>
<span id="cb328-5"><a href="regression.html#cb328-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">dec_date =</span> <span class="fu">decimal_date</span>(week_start),</span>
<span id="cb328-6"><a href="regression.html#cb328-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">week =</span> <span class="fu">yearweek</span>(week_start),</span>
<span id="cb328-7"><a href="regression.html#cb328-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">time_in_year =</span> dec_date<span class="sc">%%</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb328-8"><a href="regression.html#cb328-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(dec_date))</span>
<span id="cb328-9"><a href="regression.html#cb328-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-10"><a href="regression.html#cb328-10" aria-hidden="true" tabindex="-1"></a>usflu.ts <span class="ot">&lt;-</span> <span class="fu">as_tsibble</span>(usflu, <span class="at">index =</span> week) </span></code></pre></div>
<p>In the following, we will consider the variable <code>weighted_ili</code> as the response, which is the percentage of outpatient doctor visits for influenza like illness, weighted by state population. Figure <a href="regression.html#fig:ilits">11.3</a> displays the weekly time series of <code>weighted_ili</code> from 2010 to 2019.</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="regression.html#cb329-1" aria-hidden="true" tabindex="-1"></a>usflu.ts <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(weighted_ili) <span class="sc">+</span></span>
<span id="cb329-2"><a href="regression.html#cb329-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;week&quot;</span>,</span>
<span id="cb329-3"><a href="regression.html#cb329-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;National influenza-like illness&quot;</span>) <span class="sc">+</span></span>
<span id="cb329-4"><a href="regression.html#cb329-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">&quot;Series&quot;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:ilits"></span>
<img src="SLID_book_files/figure-html/ilits-1.png" alt="National influenza-like illness weekly time series." width="672" />
<p class="caption">
Figure 11.3: National influenza-like illness weekly time series.
</p>
</div>
<p><strong>Trigonometric regression</strong></p>
<p>For the <span class="math inline">\(i\)</span>th year and <span class="math inline">\(j\)</span>th reported time point <span class="math inline">\(t_{ij}\)</span>, <span class="math inline">\(i=1,2,\ldots,n\)</span>, we have
<span class="math display">\[
Y_{ij} = \beta_0 + \beta_1\sin(2\pi t_{ij}) + \beta_2\cos(2\pi t_{ij}) + \varepsilon_{ij}, 
\]</span>
where <span class="math inline">\(t_{ij} \in [0,1]\)</span>, <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> are unknown coefficients. We will consider linear regression method to estimate <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>.</p>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="regression.html#cb330-1" aria-hidden="true" tabindex="-1"></a>trig_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(weighted_ili <span class="sc">~</span> <span class="fu">sin</span>(time_in_year<span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>pi) </span>
<span id="cb330-2"><a href="regression.html#cb330-2" aria-hidden="true" tabindex="-1"></a>               <span class="sc">+</span> <span class="fu">cos</span>(time_in_year<span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>pi),</span>
<span id="cb330-3"><a href="regression.html#cb330-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> usflu)</span>
<span id="cb330-4"><a href="regression.html#cb330-4" aria-hidden="true" tabindex="-1"></a>usflu<span class="sc">$</span>trig_preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(trig_fit)</span></code></pre></div>
<p>Figure <a href="regression.html#fig:trigonom">11.4</a> displays the reported and trigonometric regression fit of <code>weighted_ili</code> from 2010 to 2019.</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="regression.html#cb331-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(usflu, <span class="fu">aes</span>(<span class="at">x =</span> week)) <span class="sc">+</span> </span>
<span id="cb331-2"><a href="regression.html#cb331-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> weighted_ili, <span class="at">color =</span> <span class="st">&quot;Reported&quot;</span>)) <span class="sc">+</span></span>
<span id="cb331-3"><a href="regression.html#cb331-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> trig_preds, <span class="at">color =</span> <span class="st">&quot;Trigonometric&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb331-4"><a href="regression.html#cb331-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb331-5"><a href="regression.html#cb331-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="at">Reported =</span> <span class="st">&quot;black&quot;</span>, <span class="at">Trigonometric =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb331-6"><a href="regression.html#cb331-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb331-7"><a href="regression.html#cb331-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;week&quot;</span>, </span>
<span id="cb331-8"><a href="regression.html#cb331-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Reported vs trigonometric regression fit&quot;</span>) <span class="sc">+</span></span>
<span id="cb331-9"><a href="regression.html#cb331-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">&quot;Series&quot;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:trigonom"></span>
<img src="SLID_book_files/figure-html/trigonom-1.png" alt="Reported vs trigonometric regression fit." width="672" />
<p class="caption">
Figure 11.4: Reported vs trigonometric regression fit.
</p>
</div>
<p><strong>Smoothing splines</strong></p>
<p>For the <span class="math inline">\(i\)</span>th year and <span class="math inline">\(j\)</span>th reported time point <span class="math inline">\(t_{ij}\)</span>, we have
<span class="math display">\[
Y_{ij} = m(t_{ij}) + \varepsilon_{ij}, 
\]</span>
where <span class="math inline">\(t_{ij} \in [0,1]\)</span>, <span class="math inline">\(i=1,2,\ldots,n\)</span>. In the following, we use the smoothing splines to estimate <span class="math inline">\(m\)</span> function.</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="regression.html#cb332-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span>
<span id="cb332-2"><a href="regression.html#cb332-2" aria-hidden="true" tabindex="-1"></a>ss_fit <span class="ot">&lt;-</span> <span class="fu">gam</span>(weighted_ili <span class="sc">~</span> <span class="fu">s</span>(time_in_year, <span class="at">bs =</span> <span class="st">&quot;cc&quot;</span>), </span>
<span id="cb332-3"><a href="regression.html#cb332-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> usflu)</span>
<span id="cb332-4"><a href="regression.html#cb332-4" aria-hidden="true" tabindex="-1"></a>usflu<span class="sc">$</span>ss_preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(ss_fit)</span></code></pre></div>
<p>Figure <a href="regression.html#fig:trigspline">11.5</a> displays the reported, the fitted <code>weighted_ili</code> from 2010 to 2019 based on the trigonometric regression method and spline smoothing method.</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="regression.html#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(usflu, <span class="fu">aes</span>(<span class="at">x =</span> week)) <span class="sc">+</span> </span>
<span id="cb333-2"><a href="regression.html#cb333-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> weighted_ili, <span class="at">color =</span> <span class="st">&quot;Reported&quot;</span>)) <span class="sc">+</span></span>
<span id="cb333-3"><a href="regression.html#cb333-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> trig_preds, <span class="at">color =</span> <span class="st">&quot;Trigonometric&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb333-4"><a href="regression.html#cb333-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> ss_preds, <span class="at">color =</span> <span class="st">&quot;Spline&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb333-5"><a href="regression.html#cb333-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb333-6"><a href="regression.html#cb333-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="at">Reported =</span> <span class="st">&quot;black&quot;</span>, <span class="at">Trigonometric =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb333-7"><a href="regression.html#cb333-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">Spline =</span> <span class="st">&quot;blue&quot;</span>)) <span class="sc">+</span></span>
<span id="cb333-8"><a href="regression.html#cb333-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;week&quot;</span>, </span>
<span id="cb333-9"><a href="regression.html#cb333-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Spline smoothing vs trigonometric regression fit&quot;</span>) <span class="sc">+</span></span>
<span id="cb333-10"><a href="regression.html#cb333-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">&quot;Series&quot;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:trigspline"></span>
<img src="SLID_book_files/figure-html/trigspline-1.png" alt="Spline smoothing vs trigonometric regression fit." width="672" />
<p class="caption">
Figure 11.5: Spline smoothing vs trigonometric regression fit.
</p>
</div>
</div>
<div id="poisson-regression" class="section level2" number="11.4">
<h2><span class="header-section-number">11.4</span> Poisson regression</h2>
<p>When the outcome of interest is a count of the number of events occurring in a population of a given size, or a count of the number of events in relation to the number of person- or animal-years at risk, a reasonable assumption is that these counts follow a Poisson distribution (especially for diseases that are either non-contagious or rare).</p>
<p>To illustrate the regression technique appropriate for Poisson-distributed data, the county-level COVID-19 infected count is considered. We assume that county-level infected counts (<span class="math inline">\(Y_i\)</span>) follow a Poisson distribution.</p>
<!-- Furthermore, the observed coounty-level count is an estimate of the true number of infected cases in each county ($\mu_i$), which is the product of exposure time in each county ($n_i$) and the incidence rate of disease ($\lambda_i$): -->
<!-- \[  -->
<!-- \mu_i=n_i\lambda_i. -->
<!-- \] -->
<!-- The incidence rate of COVID can be parameterized as a function of a series of $p$ explanatory variables, -->
<!-- \[ -->
<!-- \log(\lambda_i) = \beta_0+\beta_1X_{1i} +\cdots +\beta_pX_{pi} -->
<!-- \] -->
<p>We assume that the conditional mean value of daily new positive cases (<span class="math inline">\(\mu_i\)</span>) for county <span class="math inline">\(i\)</span> can be modeled via a <span class="math inline">\(\log(\cdot)\)</span> function as follows</p>
<p><span class="math display" id="eq:log">\[\begin{equation} 
\log(\mu_i) = \beta_0+\beta_1X_{1i} +\cdots +\beta_pX_{pi}. 
\tag{11.1}
\end{equation}\]</span></p>
<!-- In \@ref(eq:log) the term $\log(n_i)$ is an adjustment known as an offset which accounts for counties with different times at risk. If all areas had the same number of holdings and were observed for the same amount of time, the offset would not be required.  -->
<p>In <a href="regression.html#eq:log">(11.1)</a>, the terms (<span class="math inline">\(\beta_0+\beta_1X_{1i} +\cdots +\beta_pX_{pi}\)</span>) represent an adjustment to account for disease counts that are either above or below that expected, based on time at risk.</p>
</div>
<div id="logistic-regression" class="section level2" number="11.5">
<h2><span class="header-section-number">11.5</span> Logistic regression</h2>
<p>As the level of resolution of our analyses becomes greater, the spatial unit of interest typically shifts from areas to points. Instead of describing and explaining disease counts summarized by area, the objective here is to identify factors that influence the risk of disease being present or absent at specific locations (e.g., farm or household) using the binary labels “positive” (disease present) or “negative” (disease absent).</p>
<p>When modeling binary data, explanatory variables are used to predict the probability of a study subject being disease present (a “case”). We can use the dummy variable to code the response
<span class="math display">\[
Y=\left\{
    \begin{array}{ll}
      0, &amp; \mathrm{if~disease~present;} \\
      1, &amp; \mathrm{if~disease~absent.}
    \end{array}
  \right.
\]</span></p>
<p>Rather than modeling the response <span class="math inline">\(Y\)</span> directly, logistic regression models the probability that <span class="math inline">\(Y\)</span> belongs to a particular category. The logistic model solves the following problems:
<span class="math display">\[
\log\left\{\frac{P(Y=1|X=x)}{P(Y=0|X=x)}\right\}=\beta_0+\beta_1x,
\]</span>
for some unknown <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>, which we will estimate directly. Note that <span class="math inline">\(P(Y=0|X=x)=1-P(Y=1|X=x)\)</span>, so we have
<span class="math display">\[
\log\left(\frac{p}{1-p}\right)=\beta_0+\beta_1x,
\]</span>
where <span class="math inline">\(p\)</span> is the probability that event <span class="math inline">\(Y\)</span> occurs,
<span class="math inline">\(p/(1-p)\)</span> is the <strong>odds ratio</strong>, and <span class="math inline">\(\log\left\{p/(1-p)\right\}\)</span> is <strong>log odds ratio</strong> or <strong>logit</strong>.</p>
<p><strong>Odds and Odds Ratios</strong></p>
<ul>
<li>The definitions of an <strong>odds</strong>: <span class="math inline">\(odds=\frac{p}{1-p}\)</span>.</li>
</ul>
<p>The odds has a range from 0 to <span class="math inline">\(\infty\)</span> with values greater than 1 associated with an event being more likely to occur than not occur and values less than 1 associated with an event that is less likely to occur than not occur.</p>
<ul>
<li>The <strong>logit</strong> is defined as the log of the odds:</li>
</ul>
<p><span class="math display">\[
\log (\mathrm{odds})=\log\left(\frac{p}{1-p}\right)=\log{(p)}-\log{(1-p)}.
\]</span></p>
<ul>
<li><p>This transformation is useful because it creates a variable with a range from <span class="math inline">\(-\infty\)</span> to <span class="math inline">\(\infty\)</span>. Hence, this transformation solves the problem we encountered in fitting a linear model to probabilities. Because probabilities only range from 0 to 1, we can get linear predictions that are outside of this range.</p></li>
<li><p>The interpretation of logits is simple – take the exponential of the logit and you have the odds for the two groups in question.</p></li>
</ul>
<p><strong>Interpretation</strong></p>
<ul>
<li><p>The logit distribution constrains the estimated probabilities to lie between 0 and 1.</p></li>
<li><p>The estimated probability is</p></li>
</ul>
<p><span class="math display">\[
p=P(Y=1|X=x)=\frac{\exp(\beta_0+\beta_1x)}{1+\exp(\beta_0+\beta_1x)}.
\]</span></p>
<ul>
<li>If <span class="math inline">\(\beta_0+\beta_1x=0\)</span>, then <span class="math inline">\(p=0.5\)</span>.</li>
<li>As <span class="math inline">\(\beta_0+\beta_1x\)</span> gets really big, <span class="math inline">\(p\)</span> approaches 1.</li>
<li>As <span class="math inline">\(\beta_0+\beta_1x\)</span> gets really small, <span class="math inline">\(p\)</span> approaches 0.</li>
</ul>
<p><strong>Estimating Logistic Regression Coefficients</strong></p>
<ul>
<li><p>Suppose that we are given a sample <span class="math inline">\((x_{i},y_{i})\)</span>, <span class="math inline">\(i=1,\ldots,n\)</span>. Here <span class="math inline">\(y_{i}\)</span> denotes the class <span class="math inline">\(\in\{0,1\}\)</span> of the <span class="math inline">\(i\)</span>th observation.</p></li>
<li><p>Assume that the classes are conditionally independent given <span class="math inline">\(x_{1},\ldots,x_{n}\)</span>, then
<span class="math display">\[
\mathbb{L}(\beta_0,\beta_1)=\prod_{i=1}^{n}P(Y=y_{i}|X=x_{i}),
\]</span>
the likelihood of these <span class="math inline">\(n\)</span> observations, so the log likelihood is
<span class="math display">\[
l(\beta_0,\beta_1)=\sum_{i=1}^{n}\log{P(Y=y_{i}|X=x_{i})}.
\]</span></p></li>
<li><p>For convenience, we define the indicator <span class="math inline">\(u_{i}=\left\{\begin{array}{cc}  1 &amp;\mathrm{if}~y_{i}=1\\  0 &amp;\mathrm{if}~y_{i}=0  \end{array}\right.\)</span></p></li>
</ul>
<p><strong>Estimating Logistic Regression Coefficients</strong></p>
<ul>
<li>The log-likelihood can be written as</li>
</ul>
<p><span class="math display">\[\begin{eqnarray*}
l(\beta_0,\beta_1)&amp;=&amp;\sum_{i=1}^{n}\log{P(Y=y_{i}|x=x_{i})}\\
&amp;=&amp;\sum_{i=1}^{n}[u_{i}(\beta_0+ \beta_1 x_{i})-\log{\{1+\exp(\beta_0+ \beta_1 x_{i})\}}]
\end{eqnarray*}\]</span></p>
<ul>
<li>The coefficients are estimated by maximizing the likelihood,
<span class="math display">\[
\sum_{i=1}^{n}[u_{i}(\beta_0+ \beta_1 x_{i})-\log{\{1+\exp(\beta_0+ \beta_1 x_{i})\}}]
\]</span></li>
</ul>
</div>
<div id="exercises-6" class="section level2" number="11.6">
<h2><span class="header-section-number">11.6</span> Exercises</h2>
<ol style="list-style-type: decimal">
<li>From <code>state.long</code> in the R package <code>slid</code>, choose a state. Hold out the last seven days as test data and use all the data except the last seven days as your training data. Fit the following models based on your training data.</li>
</ol>
<ol style="list-style-type: lower-alpha">
<li><p>Piecewise constant spline regression model with 15 interior knots.</p></li>
<li><p>Truncated linear spline regression model with 10 interior knots.</p></li>
<li><p>Natural spline regression model with 8 interior knots.</p></li>
<li><p>Smoothing spline regression model with knots automatically selected by the ‘mgcv’ package.</p></li>
</ol>
<ol start="2" style="list-style-type: decimal">
<li><p>Demonstrate different model fits in Problem 1 in one time series plot. In addition, for each model fitted, make some residual plots, such as the ACF and the histogram. Provide some comments about the model fit and model comparison.</p></li>
<li><p>Use the fitted natural spline regression model in Problem 1 to make a 7-day ahead prediction, and show the 95% prediction intervals.</p></li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="timeseries.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="NN.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["SLID_book.pdf", "SLID_book.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
